KIDS Distribution saved on Mar 09, 2016@15:56:09
first selection of ICE forecasting VistA routines
**KIDS**:C0I*1.0*1^

**INSTALL NAME**
C0I*1.0*1
"BLD",7931,0)
C0I*1.0*1^IMMUNIZATION FORCASTING^0^3160309^n
"BLD",7931,4,0)
^9.64PA^^
"BLD",7931,6.3)
1
"BLD",7931,"KRN",0)
^9.67PA^779.2^20
"BLD",7931,"KRN",.4,0)
.4
"BLD",7931,"KRN",.401,0)
.401
"BLD",7931,"KRN",.402,0)
.402
"BLD",7931,"KRN",.403,0)
.403
"BLD",7931,"KRN",.5,0)
.5
"BLD",7931,"KRN",.84,0)
.84
"BLD",7931,"KRN",3.6,0)
3.6
"BLD",7931,"KRN",3.8,0)
3.8
"BLD",7931,"KRN",9.2,0)
9.2
"BLD",7931,"KRN",9.8,0)
9.8
"BLD",7931,"KRN",9.8,"NM",0)
^9.68A^10^10
"BLD",7931,"KRN",9.8,"NM",1,0)
C0IICE^^0^B88171030
"BLD",7931,"KRN",9.8,"NM",2,0)
C0IDDMAP^^0^B7075621
"BLD",7931,"KRN",9.8,"NM",3,0)
C0ISOAP4^^0^B15279793
"BLD",7931,"KRN",9.8,"NM",4,0)
C0IUTIL^^0^B149111605
"BLD",7931,"KRN",9.8,"NM",5,0)
C0ITEST^^0^B240245143
"BLD",7931,"KRN",9.8,"NM",6,0)
C0IMAP^^0^B601607457
"BLD",7931,"KRN",9.8,"NM",7,0)
C0IEXTR^^0^B49490895
"BLD",7931,"KRN",9.8,"NM",8,0)
C0IVMR^^0^B266088944
"BLD",7931,"KRN",9.8,"NM",9,0)
C0IPXRM^^0^B33766994
"BLD",7931,"KRN",9.8,"NM",10,0)
C0IORMAP^^0^B7763780
"BLD",7931,"KRN",9.8,"NM","B","C0IDDMAP",2)

"BLD",7931,"KRN",9.8,"NM","B","C0IEXTR",7)

"BLD",7931,"KRN",9.8,"NM","B","C0IICE",1)

"BLD",7931,"KRN",9.8,"NM","B","C0IMAP",6)

"BLD",7931,"KRN",9.8,"NM","B","C0IORMAP",10)

"BLD",7931,"KRN",9.8,"NM","B","C0IPXRM",9)

"BLD",7931,"KRN",9.8,"NM","B","C0ISOAP4",3)

"BLD",7931,"KRN",9.8,"NM","B","C0ITEST",5)

"BLD",7931,"KRN",9.8,"NM","B","C0IUTIL",4)

"BLD",7931,"KRN",9.8,"NM","B","C0IVMR",8)

"BLD",7931,"KRN",19,0)
19
"BLD",7931,"KRN",19.1,0)
19.1
"BLD",7931,"KRN",101,0)
101
"BLD",7931,"KRN",409.61,0)
409.61
"BLD",7931,"KRN",771,0)
771
"BLD",7931,"KRN",779.2,0)
779.2
"BLD",7931,"KRN",870,0)
870
"BLD",7931,"KRN",8989.51,0)
8989.51
"BLD",7931,"KRN",8989.52,0)
8989.52
"BLD",7931,"KRN",8994,0)
8994
"BLD",7931,"KRN","B",.4,.4)

"BLD",7931,"KRN","B",.401,.401)

"BLD",7931,"KRN","B",.402,.402)

"BLD",7931,"KRN","B",.403,.403)

"BLD",7931,"KRN","B",.5,.5)

"BLD",7931,"KRN","B",.84,.84)

"BLD",7931,"KRN","B",3.6,3.6)

"BLD",7931,"KRN","B",3.8,3.8)

"BLD",7931,"KRN","B",9.2,9.2)

"BLD",7931,"KRN","B",9.8,9.8)

"BLD",7931,"KRN","B",19,19)

"BLD",7931,"KRN","B",19.1,19.1)

"BLD",7931,"KRN","B",101,101)

"BLD",7931,"KRN","B",409.61,409.61)

"BLD",7931,"KRN","B",771,771)

"BLD",7931,"KRN","B",779.2,779.2)

"BLD",7931,"KRN","B",870,870)

"BLD",7931,"KRN","B",8989.51,8989.51)

"BLD",7931,"KRN","B",8989.52,8989.52)

"BLD",7931,"KRN","B",8994,8994)

"MBREQ")
0
"PKG",212,-1)
1^1
"PKG",212,0)
IMMUNIZATION FORCASTING^C0I^Interface to ICE Immunization forcasting cds package
"PKG",212,22,0)
^9.49I^1^1
"PKG",212,22,1,0)
1.0
"PKG",212,22,1,"PAH",1,0)
1^3160309
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
10
"RTN","C0IDDMAP")
0^2^B7075621
"RTN","C0IDDMAP",1,0)
C0IDDMAP  ;
"RTN","C0IDDMAP",2,0)
; Pull information re CPT and CVX codes from dEWDrop;;;;;Build 1
"RTN","C0IDDMAP",3,0)
 D CPTMAP^C0ITEST
"RTN","C0IDDMAP",4,0)
 D CVXMAP^C0ITEST
"RTN","C0IDDMAP",5,0)
 D CPTIMAP^C0ITEST
"RTN","C0IDDMAP",6,0)
 N IMMCPT,IMMCVX,CVXTXT,X,IMMIEN,I
"RTN","C0IDDMAP",7,0)
 S (IMMCPT,IMMCVX,CVXTXT,X,IMMIEN,I)=""
"RTN","C0IDDMAP",8,0)
 F I=1:1:141 D
"RTN","C0IDDMAP",9,0)
 .;if there is an entry in the CPT Mapping file that is for an Immunization
"RTN","C0IDDMAP",10,0)
 .I $P(^PXD(811.1,I,0),U,2)["AUTTIMM" D
"RTN","C0IDDMAP",11,0)
 ..;Pick the CPT code out of the file
"RTN","C0IDDMAP",12,0)
 ..S IMMCPT=$P($P(^PXD(811.1,I,0),U,1),";",1)
"RTN","C0IDDMAP",13,0)
 ..W I," CPT Code is ",IMMCPT,! 
"RTN","C0IDDMAP",14,0)
 ..;If there is a match to an immunization
"RTN","C0IDDMAP",15,0)
 ..I $D(CPTMAP(IMMCPT)) D
"RTN","C0IDDMAP",16,0)
 ...S IMMCVX=CPTMAP(IMMCPT)
"RTN","C0IDDMAP",17,0)
 ...W I," CVX Code is ",IMMCVX,!
"RTN","C0IDDMAP",18,0)
 ...I $D(CVXMAP(IMMCVX)) D
"RTN","C0IDDMAP",19,0)
 ...S CVXTXT=CVXMAP(IMMCVX)
"RTN","C0IDDMAP",20,0)
 ...W I," CVX Text is ",CVXTXT,!
"RTN","C0IDDMAP",21,0)
 ...S X=$P(^PXD(811.1,I,0),U,2)
"RTN","C0IDDMAP",22,0)
 ...I $D(X) D
"RTN","C0IDDMAP",23,0)
 ....S IMMIEN=$P($P(^PXD(811.1,I,0),U,2),";",1)
"RTN","C0IDDMAP",24,0)
 ....W I," IEN of the Immunization is ",IMMIEN,! 
"RTN","C0IDDMAP",25,0)
 ....;VOID-IEN of CPT Mapping File;CPT Code;Immunization file Name for the immunization; Short name from Immunization file;CVX Code;proper CVX code short description
"RTN","C0IDDMAP",26,0)
 ....;S NANCY(I)=I_";"_$P($P(^PXD(811.1,I,0),U,1),";",1)_";"_$P(^AUTTIMM(IMMIEN,0),U,1)_";"_$P(^AUTTIMM(IMMIEN,0),U,2)_";"_IMMCVX_";"_CVXTXT_";"
"RTN","C0IDDMAP",27,0)
 ....;IEN of CPT Mapping File;Immunization File IEN;Immunization file Name for the immunization; Short name from Immunization file;CPT Code;CVX Code;proper CVX code sho 
"RTN","C0IDDMAP",28,0)
 ....S NANCY(I)=I_";"_IMMIEN_";"_$P(^AUTTIMM(IMMIEN,0),U,1)_";"_$P(^AUTTIMM(IMMIEN,0),U,2)_";"_$P($P(^PXD(811.1,I,0),U,1),";",1)_";"_IMMCVX_";"_CVXTXT
"RTN","C0IDDMAP",29,0)
 ....W NANCY(I),!
"RTN","C0IDDMAP",30,0)
 ....S NANCY1(I)=IMMIEN
"RTN","C0IDDMAP",31,0)
 ....W NANCY1(I),!
"RTN","C0IDDMAP",32,0)
 ; F I=1:1:131 D
"RTN","C0IDDMAP",33,0)
 ;.; if there is an entry in the CPT mapping file corrensponding to this imminization, QUIT
"RTN","C0IDDMAP",34,0)
 Q
"RTN","C0IDDMAP",35,0)
 
"RTN","C0IEXTR")
0^7^B49490895
"RTN","C0IEXTR",1,0)
C0IEXTR ; GPL - Patient extract and  DOM PROCESSING ROUTINES ;8/29/13  17:05
"RTN","C0IEXTR",2,0)
 ;;0.1;Immunizations Forcasting;nopatch;noreleasedate;Build 1
"RTN","C0IEXTR",3,0)
 ;
"RTN","C0IEXTR",4,0)
 ; License Apache 2
"RTN","C0IEXTR",5,0)
 ; 
"RTN","C0IEXTR",6,0)
 ; This software was funded in part by Oroville Hospital, and was
"RTN","C0IEXTR",7,0)
 ; created with help from Oroville's doctors and staff.
"RTN","C0IEXTR",8,0)
 ;
"RTN","C0IEXTR",9,0)
 Q
"RTN","C0IEXTR",10,0)
 ;
"RTN","C0IEXTR",11,0)
 ; here are the types that are supported:
"RTN","C0IEXTR",12,0)
 ;demographics;reactions;problems;vitals;labs;meds;immunizations;observation;
"RTN","C0IEXTR",13,0)
 ;visits;appointments;documents;procedures;consults;flags;factors;skinTests;
"RTN","C0IEXTR",14,0)
 ;exams;education;insurance
"RTN","C0IEXTR",15,0)
 ;
"RTN","C0IEXTR",16,0)
GETPAT(RTN,ZPATID,ZTYP,START,STOP) ; get patient data
"RTN","C0IEXTR",17,0)
 N JJOHARY
"RTN","C0IEXTR",18,0)
 S START=$G(START) 
"RTN","C0IEXTR",19,0)
 S STOP=$G(STOP)
"RTN","C0IEXTR",20,0)
 D GET^VPRD(.JJOHARY,ZPATID,ZTYP,START,STOP)
"RTN","C0IEXTR",21,0)
 ;K ^TMP("MXMLDOM",$J,1)
"RTN","C0IEXTR",22,0)
 S JJOHDID=$$PARSE(JJOHARY,ZPATID_"-"_ZTYP)
"RTN","C0IEXTR",23,0)
 k RTN
"RTN","C0IEXTR",24,0)
 N ZDOM S ZDOM=$NA(^TMP("MXMLDOM",$J,JJOHDID))
"RTN","C0IEXTR",25,0)
 d domo3("RTN",,,ZDOM)
"RTN","C0IEXTR",26,0)
 ;D DOMO(1,"/","RTN","GIDX","GARY",,"/results/"_ZTYP_"/")
"RTN","C0IEXTR",27,0)
 K GIDX,GARY,@JJOHARY
"RTN","C0IEXTR",28,0)
 ;
"RTN","C0IEXTR",29,0)
 Q
"RTN","C0IEXTR",30,0)
 ;
"RTN","C0IEXTR",31,0)
GETNHIN(RTN,ZPATID,ZTYP) ; get patient data
"RTN","C0IEXTR",32,0)
 N JJOHARY
"RTN","C0IEXTR",33,0)
 D GET^JJOHPPCN(.JJOHARY,ZPATID,ZTYP)
"RTN","C0IEXTR",34,0)
 K ^TMP("MXMLDOM",$J,1)
"RTN","C0IEXTR",35,0)
 S JJOHDID=$$PARSE(JJOHARY,ZPATID_"-"_ZTYP)
"RTN","C0IEXTR",36,0)
 k RTN
"RTN","C0IEXTR",37,0)
 N ZDOM S ZDOM=$NA(^TMP("MXMLDOM",$J,JJOHDID))
"RTN","C0IEXTR",38,0)
 ;d domo2("RTN",ZDOM)
"RTN","C0IEXTR",39,0)
 d domo3("RTN",,,ZDOM)
"RTN","C0IEXTR",40,0)
 ;D DOMO(1,"/","RTN","GIDX","GARY",,"/results/")
"RTN","C0IEXTR",41,0)
 ;K GIDX,GARY,@JJOHARY
"RTN","C0IEXTR",42,0)
 ;
"RTN","C0IEXTR",43,0)
 Q
"RTN","C0IEXTR",44,0)
 ;
"RTN","C0IEXTR",45,0)
tree(where,prefix,docid,zout,zary) ; show a tree starting at a node in MXML. 
"RTN","C0IEXTR",46,0)
 ; node is passed by name
"RTN","C0IEXTR",47,0)
 ; 
"RTN","C0IEXTR",48,0)
 i '$d(zary) s zary="GARY"
"RTN","C0IEXTR",49,0)
 i '$d(@zary) s @zary=""
"RTN","C0IEXTR",50,0)
 i $g(prefix)="" s prefix="/" ; starting prefix
"RTN","C0IEXTR",51,0)
 i '$d(KBAIJOB) s KBAIJOB=$J
"RTN","C0IEXTR",52,0)
 n node s node=$na(^TMP("MXMLDOM",KBAIJOB,docid,where))
"RTN","C0IEXTR",53,0)
 n txt s txt=$$CLEAN($$ALLTXT(node))
"RTN","C0IEXTR",54,0)
 n g s g=prefix
"RTN","C0IEXTR",55,0)
 n gt s gt=prefix_"/"_@node
"RTN","C0IEXTR",56,0)
 n gt1 s gt1=1
"RTN","C0IEXTR",57,0)
 i $d(@zary@(gt)) d  ;
"RTN","C0IEXTR",58,0)
 . s gt1=$o(@zary@(gt,""),-1)+1
"RTN","C0IEXTR",59,0)
 ;i txt'="",txt'=" " d  ;
"RTN","C0IEXTR",60,0)
 s @zary@(gt1,gt)=txt
"RTN","C0IEXTR",61,0)
 s @zary@(gt,gt1)=txt
"RTN","C0IEXTR",62,0)
 w !,gt_" "_txt
"RTN","C0IEXTR",63,0)
 d oneout(zout,prefix_@node_" "_txt)
"RTN","C0IEXTR",64,0)
 n zi s zi=""
"RTN","C0IEXTR",65,0)
 f  s zi=$o(@node@("A",zi)) q:zi=""  d  ;
"RTN","C0IEXTR",66,0)
 . s @zary@(gt1,g,@node_"@"_zi)=$g(@node@("A",zi))
"RTN","C0IEXTR",67,0)
 . w !,prefix_"/"_@node_"@"_zi_"="_$g(@node@("A",zi))
"RTN","C0IEXTR",68,0)
 . d oneout(zout,prefix_"/"_@node_"@"_zi_"="_$g(@node@("A",zi)))
"RTN","C0IEXTR",69,0)
 f  s zi=$o(@node@("C",zi)) q:zi=""  d  ;
"RTN","C0IEXTR",70,0)
 . d tree(zi,prefix_"/"_@node,docid,zout)
"RTN","C0IEXTR",71,0)
 q
"RTN","C0IEXTR",72,0)
 ;
"RTN","C0IEXTR",73,0)
domo3(zary,what,where,zdom,lvl) ; simplified domo
"RTN","C0IEXTR",74,0)
 ; zary is the return array
"RTN","C0IEXTR",75,0)
 ; what is the tag to begin with starting at where, a node in the zdom
"RTN","C0IEXTR",76,0)
 ; multiple is the index to be used for a muliple entry 0 is a singleton
"RTN","C0IEXTR",77,0)
 ; 
"RTN","C0IEXTR",78,0)
 i '$d(zdom) s zdom=$na(^TMP("MXMLDOM",$J,$o(^TMP("MXMLDOM",$J,"AAAAA"),-1)))
"RTN","C0IEXTR",79,0)
 i '$d(where) s where=1
"RTN","C0IEXTR",80,0)
 i $g(what)="" s what=@zdom@(where)
"RTN","C0IEXTR",81,0)
 i '$d(lvl) s lvl=0 n znum s znum=0 ; first time
"RTN","C0IEXTR",82,0)
 ;
"RTN","C0IEXTR",83,0)
 n txt s txt=$$CLEAN($$ALLTXT($NA(@zdom@(where))))
"RTN","C0IEXTR",84,0)
 i txt'="" i txt'=" " d  ;
"RTN","C0IEXTR",85,0)
 . s @zary@(@zdom@(where))=txt
"RTN","C0IEXTR",86,0)
 ;
"RTN","C0IEXTR",87,0)
 n zi s zi=""
"RTN","C0IEXTR",88,0)
 f  s zi=$o(@zdom@(where,"A",zi)) q:zi=""  d  ;
"RTN","C0IEXTR",89,0)
 . s @zary@(what_"@"_zi)=@zdom@(where,"A",zi)
"RTN","C0IEXTR",90,0)
 f  s zi=$o(@zdom@(where,"C",zi)) q:zi=""  d  ;
"RTN","C0IEXTR",91,0)
 . n mult s mult=$$ismult(where,zdom)
"RTN","C0IEXTR",92,0)
 . ;i '$d(znum) n znum s znum(where)=0
"RTN","C0IEXTR",93,0)
 . i mult>0 s znum(where)=$g(znum(where))+1
"RTN","C0IEXTR",94,0)
 . i $g(C0DEBUG) i mult>0 D  ;
"RTN","C0IEXTR",95,0)
 . . w !,"where ",where," what ",what," zi ",zi," lvl ",lvl,!
"RTN","C0IEXTR",96,0)
 . . zwr znum
"RTN","C0IEXTR",97,0)
 . i mult=0 d domo3($na(@zary@(what)),@zdom@(where,"C",zi),zi,zdom,lvl+1)
"RTN","C0IEXTR",98,0)
 . i mult>0 d domo3($na(@zary@(what,znum(where))),@zdom@(where,"C",zi),zi,zdom,lvl+1)
"RTN","C0IEXTR",99,0)
 q
"RTN","C0IEXTR",100,0)
 ;
"RTN","C0IEXTR",101,0)
ismult(zidx,zdom) ; extrinsic which returns one if the node contains multiple
"RTN","C0IEXTR",102,0)
 ; children with the same tag
"RTN","C0IEXTR",103,0)
 n ztags,zzi,zj,rtn s zzi="" s rtn=0
"RTN","C0IEXTR",104,0)
 f  s zzi=$o(@zdom@(zidx,"C",zzi)) q:rtn=1  q:zzi=""  d  ;
"RTN","C0IEXTR",105,0)
 . s zj=@zdom@(zidx,"C",zzi)
"RTN","C0IEXTR",106,0)
 . i $d(ztags(zj)) s rtn=1
"RTN","C0IEXTR",107,0)
 . s ztags(zj)=""
"RTN","C0IEXTR",108,0)
 q rtn
"RTN","C0IEXTR",109,0)
 ;
"RTN","C0IEXTR",110,0)
testmult ;
"RTN","C0IEXTR",111,0)
 n zdom
"RTN","C0IEXTR",112,0)
 s zdom=$na(^TMP("MXMLDOM",$J,1))
"RTN","C0IEXTR",113,0)
 n gi,gj s gi=""
"RTN","C0IEXTR",114,0)
 f  s gi=$o(@zdom@(gi)) q:gi=""  d  ;
"RTN","C0IEXTR",115,0)
 . i $$ismult(gi,zdom) b  ;
"RTN","C0IEXTR",116,0)
 q
"RTN","C0IEXTR",117,0)
 ;
"RTN","C0IEXTR",118,0)
findnxt(tag,znd) ; private extrinsic which returns a node id of tag
"RTN","C0IEXTR",119,0)
 i '$d(zdom) s zdom=$na(^TMP("MXMLDOM",$J,$o(^TMP("MXMLDOM",$J,"AAAAA"),-1)))
"RTN","C0IEXTR",120,0)
 ;i @zdom@(znd)=tag q znd ; easy case
"RTN","C0IEXTR",121,0)
 n gi,done,rslt s gi="" s done=0
"RTN","C0IEXTR",122,0)
 f  s gi=$o(@zdom@(znd,"C",gi)) q:done  q:gi=""  d  ;
"RTN","C0IEXTR",123,0)
 . i @zdom@(znd,"C",gi)=tag s done=1 s rslt=gi
"RTN","C0IEXTR",124,0)
 q:done rslt
"RTN","C0IEXTR",125,0)
 f  s gi=$o(@zdom@(znd,"C",gi)) q:done  q:gi=""  d  ;
"RTN","C0IEXTR",126,0)
 . s rslt=$$findnxt(tag,gi)
"RTN","C0IEXTR",127,0)
 . i rslt'="" s done=1
"RTN","C0IEXTR",128,0)
 q:done rslt
"RTN","C0IEXTR",129,0)
 ;i $d(@zdom@(znd,"P")) d  ;
"RTN","C0IEXTR",130,0)
 ;. s rslt=$$findnxt(tag,@zdom@(znd,"P")) ; check the parent if any
"RTN","C0IEXTR",131,0)
 q rslt
"RTN","C0IEXTR",132,0)
 ;
"RTN","C0IEXTR",133,0)
oneout(zbuf,ztxt) ; adds a line to zbuf
"RTN","C0IEXTR",134,0)
 n zi s zi=$o(@zbuf@(""),-1)+1
"RTN","C0IEXTR",135,0)
 s @zbuf@(zi)=ztxt
"RTN","C0IEXTR",136,0)
 q
"RTN","C0IEXTR",137,0)
 ;
"RTN","C0IEXTR",138,0)
ALLTXT(where) ; extrinsic which returns all text lines from the node .. concatinated 
"RTN","C0IEXTR",139,0)
 ; together
"RTN","C0IEXTR",140,0)
 n zti s zti=""
"RTN","C0IEXTR",141,0)
 n ztr s ztr=""
"RTN","C0IEXTR",142,0)
 f  s zti=$o(@where@("T",zti)) q:zti=""  d  ;
"RTN","C0IEXTR",143,0)
 . s ztr=ztr_$g(@where@("T",zti))
"RTN","C0IEXTR",144,0)
 q ztr
"RTN","C0IEXTR",145,0)
 ;
"RTN","C0IEXTR",146,0)
CLEAN(STR) ; extrinsic function; returns string - gpl borrowed from the CCR package
"RTN","C0IEXTR",147,0)
 ;; Removes all non printable characters from a string.
"RTN","C0IEXTR",148,0)
 ;; STR by Value
"RTN","C0IEXTR",149,0)
 N TR,I
"RTN","C0IEXTR",150,0)
 F I=0:1:31 S TR=$G(TR)_$C(I)
"RTN","C0IEXTR",151,0)
 S TR=TR_$C(127)
"RTN","C0IEXTR",152,0)
 N ZR S ZR=$TR(STR,TR)
"RTN","C0IEXTR",153,0)
 S ZR=$$LDBLNKS(ZR) ; get rid of leading blanks
"RTN","C0IEXTR",154,0)
 QUIT ZR
"RTN","C0IEXTR",155,0)
 ;
"RTN","C0IEXTR",156,0)
LDBLNKS(st) ; extrinsic which removes leading blanks from a string
"RTN","C0IEXTR",157,0)
 n pos f pos=1:1:$l(st)  q:$e(st,pos)'=" "
"RTN","C0IEXTR",158,0)
 q $e(st,pos,$l(st))
"RTN","C0IEXTR",159,0)
 ;
"RTN","C0IEXTR",160,0)
TEST ;
"RTN","C0IEXTR",161,0)
 S GDOM=$NA(^KBAI("TOOBIG","DOM"))
"RTN","C0IEXTR",162,0)
 K ^TMP("MXMLDOM",$J)
"RTN","C0IEXTR",163,0)
 M ^TMP("MXMLDOM",$J,1)=@GDOM
"RTN","C0IEXTR",164,0)
 K GARY,GIDX,GNARY
"RTN","C0IEXTR",165,0)
 S JJOHDID=1
"RTN","C0IEXTR",166,0)
 ;D DOMO(1,"/","GNARY","GIDX","GARY",,"/results/")
"RTN","C0IEXTR",167,0)
 K G,GARY
"RTN","C0IEXTR",168,0)
 ;d domo2("GARY",,"..results.")
"RTN","C0IEXTR",169,0)
 d domo3("GARY")
"RTN","C0IEXTR",170,0)
 Q
"RTN","C0IEXTR",171,0)
 ;
"RTN","C0IEXTR",172,0)
ADDNARY(ZXP,ZVALUE) ; ADD AN NHIN ARRAY VALUE TO ZNARY
"RTN","C0IEXTR",173,0)
 ;
"RTN","C0IEXTR",174,0)
 ; IF ZATT=1 THE ARRAY IS ADDED AS ATTRIBUTES
"RTN","C0IEXTR",175,0)
 ;
"RTN","C0IEXTR",176,0)
 N ZZI,ZZJ,ZZN
"RTN","C0IEXTR",177,0)
 S ZZI=$P(ZXP,"/",1) ; FIRST PIECE OF XPATH ARRAY
"RTN","C0IEXTR",178,0)
 I ZZI="" Q  ; DON'T ADD THIS ONE .. PROBABLY THE //results NODE
"RTN","C0IEXTR",179,0)
 S ZZJ=$P(ZXP,ZZI_"/",2) ; REST OF XPATH ARRAY
"RTN","C0IEXTR",180,0)
 S ZZJ=$TR(ZZJ,"/",".") ; REPLACE / WITH .
"RTN","C0IEXTR",181,0)
 I ZZI'["]" D  ; A SINGLETON
"RTN","C0IEXTR",182,0)
 . S ZZN=1
"RTN","C0IEXTR",183,0)
 E  D  ; THERE IS AN [x] OCCURANCE
"RTN","C0IEXTR",184,0)
 . S ZZN=$P($P(ZZI,"[",2),"]",1) ; PULL OUT THE OCCURANCE
"RTN","C0IEXTR",185,0)
 . S ZZI=$P(ZZI,"[",1) ; TAKE OUT THE [X]
"RTN","C0IEXTR",186,0)
 I ZZJ'="" D  ; TIME TO ADD THE VALUE
"RTN","C0IEXTR",187,0)
 . S @ZNARY@(ZZI,ZZN,ZZJ)=ZVALUE
"RTN","C0IEXTR",188,0)
 Q
"RTN","C0IEXTR",189,0)
 ;
"RTN","C0IEXTR",190,0)
PARSE(INXML,INDOC) ;CALL THE MXML PARSER ON INXML, PASSED BY NAME
"RTN","C0IEXTR",191,0)
 ; INDOC IS PASSED AS THE DOCUMENT NAME - DON'T KNOW WHERE TO STORE THIS NOW
"RTN","C0IEXTR",192,0)
 ; EXTRINSIC WHICH RETURNS THE DOCID ASSIGNED BY MXML
"RTN","C0IEXTR",193,0)
 ;Q $$EN^MXMLDOM(INXML)
"RTN","C0IEXTR",194,0)
 Q $$EN^MXMLDOM(INXML,"W")
"RTN","C0IEXTR",195,0)
 ;
"RTN","C0IEXTR",196,0)
ISMULT(ZOID) ; RETURN TRUE IF ZOID IS ONE OF A MULTIPLE
"RTN","C0IEXTR",197,0)
 N ZN
"RTN","C0IEXTR",198,0)
 ;I $$TAG(ZOID)["entry" B
"RTN","C0IEXTR",199,0)
 S ZN=$$NXTSIB(ZOID)
"RTN","C0IEXTR",200,0)
 I ZN'="" Q $$TAG(ZOID)=$$TAG(ZN) ; IF TAG IS THE SAME AS NEXT SIB TAG
"RTN","C0IEXTR",201,0)
 Q 0
"RTN","C0IEXTR",202,0)
 ;
"RTN","C0IEXTR",203,0)
FIRST(ZOID) ;RETURNS THE OID OF THE FIRST CHILD OF ZOID
"RTN","C0IEXTR",204,0)
 Q $$CHILD^MXMLDOM(JJOHDID,ZOID)
"RTN","C0IEXTR",205,0)
 ;
"RTN","C0IEXTR",206,0)
PARENT(ZOID) ;RETURNS THE OID OF THE PARENT OF ZOID
"RTN","C0IEXTR",207,0)
 Q $$PARENT^MXMLDOM(JJOHDID,ZOID)
"RTN","C0IEXTR",208,0)
 ;
"RTN","C0IEXTR",209,0)
ATT(RTN,NODE) ;GET ATTRIBUTES FOR ZOID
"RTN","C0IEXTR",210,0)
 S HANDLE=JJOHDID
"RTN","C0IEXTR",211,0)
 K @RTN
"RTN","C0IEXTR",212,0)
 D GETTXT^MXMLDOM("A")
"RTN","C0IEXTR",213,0)
 Q
"RTN","C0IEXTR",214,0)
 ;
"RTN","C0IEXTR",215,0)
TAG(ZOID) ; RETURNS THE XML TAG FOR THE NODE
"RTN","C0IEXTR",216,0)
 ;
"RTN","C0IEXTR",217,0)
 N X,Y
"RTN","C0IEXTR",218,0)
 S Y=""
"RTN","C0IEXTR",219,0)
 S X=$G(JJOHCBK("TAG")) ;IS THERE A CALLBACK FOR THIS ROUTINE
"RTN","C0IEXTR",220,0)
 I X'="" X X ; EXECUTE THE CALLBACK, SHOULD SET Y
"RTN","C0IEXTR",221,0)
 I Y="" S Y=$$NAME^MXMLDOM(JJOHDID,ZOID)
"RTN","C0IEXTR",222,0)
 Q Y
"RTN","C0IEXTR",223,0)
 ;
"RTN","C0IEXTR",224,0)
NXTSIB(ZOID) ; RETURNS THE NEXT SIBLING
"RTN","C0IEXTR",225,0)
 Q $$SIBLING^MXMLDOM(JJOHDID,ZOID)
"RTN","C0IEXTR",226,0)
 ;
"RTN","C0IEXTR",227,0)
DATA(ZT,ZOID) ; RETURNS DATA FOR THE NODE
"RTN","C0IEXTR",228,0)
 ;N ZT,ZN S ZT=""
"RTN","C0IEXTR",229,0)
 ;S C0SDOM=$NA(^TMP("MXMLDOM",$J,JJOHDID))
"RTN","C0IEXTR",230,0)
 ;Q $G(@C0SDOM@(ZOID,"T",1))
"RTN","C0IEXTR",231,0)
 S ZN=$$TEXT^MXMLDOM(JJOHDID,ZOID,ZT)
"RTN","C0IEXTR",232,0)
 Q
"RTN","C0IEXTR",233,0)
 ;
"RTN","C0IEXTR",234,0)
DEMUX2(OARY,IARY,DEPTH) ;CONVERT AN XPATH ARRAY PASSED AS IARY TO
"RTN","C0IEXTR",235,0)
 ; FORMAT @OARY@(x,variablename) where x is the first multiple
"RTN","C0IEXTR",236,0)
 ; IF DEPTH=2, THE LAST 2 PARTS OF THE XPATH WILL BE USED
"RTN","C0IEXTR",237,0)
 N ZI,ZJ,ZK,ZL,ZM S ZI=""
"RTN","C0IEXTR",238,0)
 F  S ZI=$O(@IARY@(ZI)) Q:ZI=""  D  ;
"RTN","C0IEXTR",239,0)
 . D DEMUX^C0CMXP("ZJ",ZI)
"RTN","C0IEXTR",240,0)
 . S ZK=$P(ZJ,"^",3)
"RTN","C0IEXTR",241,0)
 . S ZM=$RE($P($RE(ZK),"/",1))
"RTN","C0IEXTR",242,0)
 . I $G(DEPTH)=2 D  ;LAST TWO PARTS OF XPATH USED FOR THE VARIABLE NAME
"RTN","C0IEXTR",243,0)
 . . S ZM=$RE($P($RE(ZK),"/",2))_"."_ZM
"RTN","C0IEXTR",244,0)
 . S ZL=$P(ZJ,"^",1)
"RTN","C0IEXTR",245,0)
 . I ZL="" S ZL=1
"RTN","C0IEXTR",246,0)
 . I $D(@OARY@(ZL,ZM)) D  ;IT'S A DUP
"RTN","C0IEXTR",247,0)
 . . S @OARY@(ZL,ZM_"[2]")=@IARY@(ZI)
"RTN","C0IEXTR",248,0)
 . E  S @OARY@(ZL,ZM)=@IARY@(ZI)
"RTN","C0IEXTR",249,0)
 Q
"RTN","C0IEXTR",250,0)
 ;
"RTN","C0IICE")
0^1^B88171030
"RTN","C0IICE",1,0)
C0IICE ; GPL/NEA - ICE main routines ; 4/24/14 6:03pm
"RTN","C0IICE",2,0)
 ;;0.1;C0I IMMUNIZATION FORECASTINE;nopatch;noreleasedate;Build 1
"RTN","C0IICE",3,0)
 ;Copyright 2013 George Lilly.  Licensed Apache 2
"RTN","C0IICE",4,0)
 ;
"RTN","C0IICE",5,0)
 Q
"RTN","C0IICE",6,0)
 ;
"RTN","C0IICE",7,0)
 ;EN(RTN,DFN,PARMS) ;
"RTN","C0IICE",8,0)
 ;K WRK
"RTN","C0IICE",9,0)
 ;D CPTMAP^C0ITEST
"RTN","C0IICE",10,0)
 ;D CVXMAP^C0ITEST
"RTN","C0IICE",11,0)
 ;D CPTIMAP^C0ITEST
"RTN","C0IICE",12,0)
 ;D CVXIMAP^C0ITEST
"RTN","C0IICE",13,0)
 ;D PAYOUTAV^C0ITEST
"RTN","C0IICE",14,0)
 ;D PAYOUTBV^C0ITEST
"RTN","C0IICE",15,0)
 ;D GET^C0IUTIL("WRK","TPAYOUTC^C0ITEST")
"RTN","C0IICE",16,0)
 ;D PAYOUTDV^C0ITEST
"RTN","C0IICE",17,0)
 ;D GET^C0IUTIL("WRK","TPAYOUTE^C0ITEST")
"RTN","C0IICE",18,0)
 ;K WRK(0)
"RTN","C0IICE",19,0)
EN(RETURN,DFN,PARMS,C0IEVAL) ;
"RTN","C0IICE",20,0)
 N WRK
"RTN","C0IICE",21,0)
 D EN^C0IVMR(.WRK,DFN,.PARMS,.C0IEVAL)
"RTN","C0IICE",22,0)
 N ICEIN
"RTN","C0IICE",23,0)
 S ICEIN=$NA(^TMP("C0IWRK",$J))
"RTN","C0IICE",24,0)
 K @ICEIN
"RTN","C0IICE",25,0)
 M @ICEIN=WRK
"RTN","C0IICE",26,0)
 N OK
"RTN","C0IICE",27,0)
 S OK=$$GTF^%ZISH($NA(^TMP("C0IWRK",$J,1)),3,"/home/vista/immu-log/",$$FMDTOUTC^JJOHPPCU($$NOW^XLFDT)_"ice-test.xml")
"RTN","C0IICE",28,0)
 ;N PARMS
"RTN","C0IICE",29,0)
 S PARMS("payload")=ICEIN
"RTN","C0IICE",30,0)
 ;D SOAP^C0ISOAP3(.RETURN,.PARMS)
"RTN","C0IICE",31,0)
 D SOAP^C0ISOAP4(.RETURN,.PARMS) ; user for kernel ws call
"RTN","C0IICE",32,0)
 Q
"RTN","C0IICE",33,0)
 ;
"RTN","C0IICE",34,0)
ICE  ;
"RTN","C0IICE",35,0)
 N DFN
"RTN","C0IICE",36,0)
 S DFN=$$PAT()
"RTN","C0IICE",37,0)
 N PARMS
"RTN","C0IICE",38,0)
 S PARMS("format")="outline"
"RTN","C0IICE",39,0)
 D EN("RETURN",DFN,.PARMS)
"RTN","C0IICE",40,0)
 N GN S GN=$NA(^TMP("ICE",$J,"RETURN"))
"RTN","C0IICE",41,0)
 ;d listm^C0IUTIL(GN,"RETURN")
"RTN","C0IICE",42,0)
 M @GN=RETURN
"RTN","C0IICE",43,0)
 I $G(USEBROWSER) D BROWSE^DDBR(GN,"N","PATIENT "_DFN_" Immunization Forecast")
"RTN","C0IICE",44,0)
 Q
"RTN","C0IICE",45,0)
 ; 
"RTN","C0IICE",46,0)
PAT() ; extrinsic which returns a dfn from the patient selected
"RTN","C0IICE",47,0)
 S DIC=2,DIC(0)="AEMQ" D ^DIC
"RTN","C0IICE",48,0)
 I Y<1 Q  ; EXIT
"RTN","C0IICE",49,0)
 S DFN=$P(Y,U,1) ; SET THE PATIENT
"RTN","C0IICE",50,0)
 Q +Y
"RTN","C0IICE",51,0)
 ;
"RTN","C0IICE",52,0)
wsICE(OUT,FILTER) ; get from web service call
"RTN","C0IICE",53,0)
 I '$D(DT) N DIQUIET S DIQUIET=1 D DT^DICRW
"RTN","C0IICE",54,0)
 N DFN
"RTN","C0IICE",55,0)
 S DFN=$G(FILTER("patientId"))
"RTN","C0IICE",56,0)
 I DFN="" Q  ; 
"RTN","C0IICE",57,0)
 I $G(FILTER("format"))="" S FILTER("format")="report"
"RTN","C0IICE",58,0)
 S OUT=$NA(^TMP("ICEOUT",$J,"RETURN"))
"RTN","C0IICE",59,0)
 I $G(FILTER("format"))="xml" S HTTPRSP("mime")="text/xml"
"RTN","C0IICE",60,0)
 E   S HTTPRSP("mime")="text/html"
"RTN","C0IICE",61,0)
 ;W !,"<!DOCTYPE HTML><html><head></head><body><pre>"
"RTN","C0IICE",62,0)
 N C0IVMR ; reminder results brought forward to interpret ICE return
"RTN","C0IICE",63,0)
 D EN^C0IICE("GPL",DFN,.FILTER,.C0IVMR)
"RTN","C0IICE",64,0)
 I $G(FILTER("format"))="global" d listm^C0IUTIL(OUT,"GPL")
"RTN","C0IICE",65,0)
 I $G(FILTER("format"))="simple" d  ;
"RTN","C0IICE",66,0)
 . n RETURN
"RTN","C0IICE",67,0)
 . d peel^C0IUTIL("RETURN","GPL")
"RTN","C0IICE",68,0)
 . d listm^C0IUTIL(OUT,"RETURN")
"RTN","C0IICE",69,0)
 I $G(FILTER("format"))="report" D  ;
"RTN","C0IICE",70,0)
 . k HTTPRSP("header")
"RTN","C0IICE",71,0)
 . n RETURN
"RTN","C0IICE",72,0)
 . M RETURN=C0IVMR
"RTN","C0IICE",73,0)
 . d peel^C0IUTIL("RETURN","GPL")
"RTN","C0IICE",74,0)
 . D DEMHTML(OUT,"RETURN")
"RTN","C0IICE",75,0)
 . D ADDTO^C0IUTIL(OUT,"<hr>")
"RTN","C0IICE",76,0)
 . I $D(RETURN("observationResults"))!$D(RETURN("observationResult")) D  ;
"RTN","C0IICE",77,0)
 . . I '$D(RETURN("observationResults",1)) D  ;
"RTN","C0IICE",78,0)
 . . . M RETURN("observationResults",1)=RETURN("observationResult")
"RTN","C0IICE",79,0)
 . . D DISHTML(OUT,"RETURN")
"RTN","C0IICE",80,0)
 . . D ADDTO^C0IUTIL(OUT,"<hr>")
"RTN","C0IICE",81,0)
 . D HISHTML(OUT,"RETURN")
"RTN","C0IICE",82,0)
 . D ADDTO^C0IUTIL(OUT,"<hr>")
"RTN","C0IICE",83,0)
 . D PROHTML(OUT,"RETURN")
"RTN","C0IICE",84,0)
 . I $G(FILTER("debug"))=1 d  ;
"RTN","C0IICE",85,0)
 . . D ADDTO^C0IUTIL(OUT,"<pre>")
"RTN","C0IICE",86,0)
 . . d listm^C0IUTIL(OUT,"RETURN")
"RTN","C0IICE",87,0)
 . . D ADDTO^C0IUTIL(OUT,"</pre>")
"RTN","C0IICE",88,0)
 . K @OUT@(0)
"RTN","C0IICE",89,0)
 ;E  M @OUT=GPL
"RTN","C0IICE",90,0)
 I $G(FILTER("format"))="outline" M @OUT=GPL
"RTN","C0IICE",91,0)
 I $G(FILTER("format"))="xml" M @OUT=GPL
"RTN","C0IICE",92,0)
 I $G(FILTER("format"))'="xml" D  ;
"RTN","C0IICE",93,0)
 . N GTOP,GBOT
"RTN","C0IICE",94,0)
 . S GTOP="<!DOCTYPE HTML><html><head></head><body>"
"RTN","C0IICE",95,0)
 . I $G(FILTER("format"))="outline" S GTOP=GTOP_"<pre>"
"RTN","C0IICE",96,0)
 . I $G(FILTER("format"))="global" S GTOP=GTOP_"<pre>"
"RTN","C0IICE",97,0)
 . I $G(FILTER("format"))="simple" S GTOP=GTOP_"<pre>"
"RTN","C0IICE",98,0)
 . S @OUT=GTOP
"RTN","C0IICE",99,0)
 . S GBOT="</body></html>"
"RTN","C0IICE",100,0)
 . I $G(FILTER("format"))="outline" S GBOT="</pre>"_GBOT
"RTN","C0IICE",101,0)
 . I $G(FILTER("format"))="global" S GBOT="</pre>"_GBOT
"RTN","C0IICE",102,0)
 . I $G(FILTER("format"))="simple" S GBOT="</pre>"_GBOT
"RTN","C0IICE",103,0)
 . S @OUT@($O(@OUT@(""),-1)+1)=GBOT
"RTN","C0IICE",104,0)
 . D ADDCRLF^VPRJRUT(.OUT)
"RTN","C0IICE",105,0)
 ;W "</pre></body></html>"
"RTN","C0IICE",106,0)
 q
"RTN","C0IICE",107,0)
 ;
"RTN","C0IICE",108,0)
TEST ;
"RTN","C0IICE",109,0)
 S PARM("format")="xml"
"RTN","C0IICE",110,0)
 S PARM("patientId")=11
"RTN","C0IICE",111,0)
 d wsICE^C0IICE(.GG,.PARM)
"RTN","C0IICE",112,0)
 ZWR GG
"RTN","C0IICE",113,0)
 Q
"RTN","C0IICE",114,0)
 ;
"RTN","C0IICE",115,0)
DISHTML(RTN,ARY) ; generate an html file with tables from the return array. 
"RTN","C0IICE",116,0)
 ; both passed by name - disease documentation
"RTN","C0IICE",117,0)
 N GARY
"RTN","C0IICE",118,0)
 S GARY("TITLE")="ICE Return - Disease Documentation"
"RTN","C0IICE",119,0)
 S GARY("HEADER",1)="Date"
"RTN","C0IICE",120,0)
 S GARY("HEADER",2)="ICE Return Disease"
"RTN","C0IICE",121,0)
 S GARY("HEADER",3)="Interpretation"
"RTN","C0IICE",122,0)
 S GARY("HEADER",4)="VistA Recorded Disease"
"RTN","C0IICE",123,0)
 S GARY("HEADER",5)="VistA Recorded Date Of Onset"
"RTN","C0IICE",124,0)
 S GARY("HEADER",6)="Date of Entry"
"RTN","C0IICE",125,0)
 S GARY("HEADER",7)="Source"
"RTN","C0IICE",126,0)
 S GARY("HEADER",8)="Number"
"RTN","C0IICE",127,0)
 N GN S GN=$NA(@ARY@("observationResults"))
"RTN","C0IICE",128,0)
 N GF S GF=$NA(@ARY@("findings"))
"RTN","C0IICE",129,0)
 N ZI S ZI=""
"RTN","C0IICE",130,0)
 F  S ZI=$O(@GN@(ZI)) Q:ZI=""  D  ;
"RTN","C0IICE",131,0)
 . N RCODE S RCODE=$G(@GN@(ZI,"observationFocus@code"))
"RTN","C0IICE",132,0)
 . N FREF
"RTN","C0IICE",133,0)
 . S FREF=$O(@GF@("rubric",RCODE,""))
"RTN","C0IICE",134,0)
 . I +FREF>0 D  ;
"RTN","C0IICE",135,0)
 . . S GARY(ZI,4)=$G(@GF@(FREF,"ICD9Name"))_" ("_$G(@GF@(FREF,"ICD9Code"))_")"
"RTN","C0IICE",136,0)
 . . S GARY(ZI,5)=$$HTMLDT2^C0IUTIL($G(@GF@(FREF,"dateOfOnset")))
"RTN","C0IICE",137,0)
 . . S GARY(ZI,6)=$$HTMLDT2^C0IUTIL($G(@GF@(FREF,"date")))
"RTN","C0IICE",138,0)
 . . S GARY(ZI,7)=$G(@GF@(FREF,"primaryProviderName"))
"RTN","C0IICE",139,0)
 . . I GARY(ZI,7)="" I $G(@GF@(FREF,"FILE NUMBER"))=9000011 S GARY(ZI,7)="Problem List"
"RTN","C0IICE",140,0)
 . N C0IDATE S C0IDATE=$G(@GN@(ZI,"observationEventTime@high"))
"RTN","C0IICE",141,0)
 . I C0IDATE="" S C0IDATE=$G(@GN@(ZI,"observationEventTime@low"))
"RTN","C0IICE",142,0)
 . ;S GARY(ZI,1)=$$HTMLDT2^C0IUTIL(C0IDATE)
"RTN","C0IICE",143,0)
 . S GARY(ZI,1)=$E(C0IDATE,5,6)_"/"_$E(C0IDATE,7,8)_"/"_$E(C0IDATE,1,4)
"RTN","C0IICE",144,0)
 . ;S GARY(ZI,2)=$G(@GN@(ZI,"observationFocus@displayName"))
"RTN","C0IICE",145,0)
 . I $L(RCODE)=1 S RCODE="0"_CODE
"RTN","C0IICE",146,0)
 . S GARY(ZI,2)=$G(@GN@(ZI,"observationFocus@displayName"))_" ("_RCODE_")"
"RTN","C0IICE",147,0)
 . S GARY(ZI,3)=$G(@GN@(ZI,"interpretation@displayName"))
"RTN","C0IICE",148,0)
 . S GARY(ZI,8)=ZI
"RTN","C0IICE",149,0)
 D GENHTML^C0IUTIL(RTN,"GARY")
"RTN","C0IICE",150,0)
 K @RTN@(0)
"RTN","C0IICE",151,0)
 Q
"RTN","C0IICE",152,0)
 ;
"RTN","C0IICE",153,0)
HISHTML(RTN,ARY) ; generate an html file with tables from the return array. 
"RTN","C0IICE",154,0)
 ; both passed by name
"RTN","C0IICE",155,0)
 N GARY
"RTN","C0IICE",156,0)
 S GARY("TITLE")="ICE Return - Vaccination History"
"RTN","C0IICE",157,0)
 S GARY("HEADER",1)="Date"
"RTN","C0IICE",158,0)
 S GARY("HEADER",2)="VistA Vaccine Name"
"RTN","C0IICE",159,0)
 S GARY("HEADER",3)="Vaccine (CVX)"
"RTN","C0IICE",160,0)
 S GARY("HEADER",4)="Vaccine Group (Group Code)"
"RTN","C0IICE",161,0)
 S GARY("HEADER",5)="Dose Number"
"RTN","C0IICE",162,0)
 S GARY("HEADER",6)="Validity (isValid)"
"RTN","C0IICE",163,0)
 S GARY("HEADER",7)="Interpretation"
"RTN","C0IICE",164,0)
 S GARY("HEADER",8)="Number"
"RTN","C0IICE",165,0)
 N GN S GN=$NA(@ARY@("Events"))
"RTN","C0IICE",166,0)
 N ZI S ZI=""
"RTN","C0IICE",167,0)
 F  S ZI=$O(@GN@(ZI)) Q:ZI=""  D  ;
"RTN","C0IICE",168,0)
 . N C0IDATE S C0IDATE=$G(@GN@(ZI,"administrationTimeInterval@high"))
"RTN","C0IICE",169,0)
 . I C0IDATE="" S C0IDATE=$G(@GN@(ZI,"administrationTimeInterval@low"))
"RTN","C0IICE",170,0)
 . ;S GARY(ZI,1)=$$HTMLDT^C0IUTIL(C0IDATE)
"RTN","C0IICE",171,0)
 . S GARY(ZI,1)=$E(C0IDATE,5,6)_"/"_$E(C0IDATE,7,8)_"/"_$E(C0IDATE,1,4)
"RTN","C0IICE",172,0)
 . S GARY(ZI,2)=$G(@GN@(ZI,"substanceCode@originalText"))
"RTN","C0IICE",173,0)
 . N CODE S CODE=$G(@GN@(ZI,"substanceCode@code"))
"RTN","C0IICE",174,0)
 . I $L(CODE)=1 S CODE="0"_CODE
"RTN","C0IICE",175,0)
 . S CODE="<a href=""https://raw.githubusercontent.com/glilly/ice-testing/master/trunk/ice-config/Vaccines/"_CODE_".xml"" target=""_blank"">"_CODE_"</a>"
"RTN","C0IICE",176,0)
 . S GARY(ZI,3)=$G(@GN@(ZI,"substanceCode@displayName"))_" ("_CODE_")"
"RTN","C0IICE",177,0)
 . N GCODE S GCODE=$G(@GN@(ZI,"observationFocus@code"))
"RTN","C0IICE",178,0)
 . S GCODE="<a href=""https://raw.githubusercontent.com/glilly/ice-testing/master/trunk/ice-config/VaccineGroups/"_GCODE_".xml"" target=""_blank"">"_GCODE_"</a>"
"RTN","C0IICE",179,0)
 . N GGRP S GGRP=$G(@GN@(ZI,"observationFocus@displayName"))
"RTN","C0IICE",180,0)
 . S GGRP=$P($P(GGRP,"(",2),")",1)
"RTN","C0IICE",181,0)
 . S GARY(ZI,4)=GGRP_" ("_GCODE_")"
"RTN","C0IICE",182,0)
 . S GARY(ZI,5)=$G(@GN@(ZI,"doseNumber@value"))
"RTN","C0IICE",183,0)
 . N ISVALID S ISVALID=$G(@GN@(ZI,"isValid@value"))
"RTN","C0IICE",184,0)
 . S GARY(ZI,6)=$G(@GN@(ZI,"concept@displayName"))_" ("_ISVALID_")"
"RTN","C0IICE",185,0)
 . S GARY(ZI,7)=$G(@GN@(ZI,"interpretation@displayName"))
"RTN","C0IICE",186,0)
 . S GARY(ZI,8)=ZI
"RTN","C0IICE",187,0)
 D GENHTML^C0IUTIL(RTN,"GARY")
"RTN","C0IICE",188,0)
 K @RTN@(0)
"RTN","C0IICE",189,0)
 Q
"RTN","C0IICE",190,0)
 ;
"RTN","C0IICE",191,0)
PROHTML(RTN,ARY) ; generate a proposed vaccination html table from the return array. 
"RTN","C0IICE",192,0)
 ; both passed by name
"RTN","C0IICE",193,0)
 N GARY
"RTN","C0IICE",194,0)
 S GARY("TITLE")="ICE Return - Proposed Vaccinations"
"RTN","C0IICE",195,0)
 S GARY("HEADER",1)="Proposed Date"
"RTN","C0IICE",196,0)
 S GARY("HEADER",2)="Vaccine Group (Group Code)"
"RTN","C0IICE",197,0)
 S GARY("HEADER",3)="Recommendation"
"RTN","C0IICE",198,0)
 S GARY("HEADER",4)="Interpretation"
"RTN","C0IICE",199,0)
 S GARY("HEADER",5)="Number"
"RTN","C0IICE",200,0)
 N GN S GN=$NA(@ARY@("Proposals"))
"RTN","C0IICE",201,0)
 N ZI S ZI=""
"RTN","C0IICE",202,0)
 F  S ZI=$O(@GN@(ZI)) Q:ZI=""  D  ;
"RTN","C0IICE",203,0)
 . N C0IDATE S C0IDATE=$G(@GN@(ZI,"proposedAdministrationTimeInterval@high"))
"RTN","C0IICE",204,0)
 . I C0IDATE="" S C0IDATE=$G(@GN@(ZI,"proposedAdministrationTimeInterval@low"))
"RTN","C0IICE",205,0)
 . ;S GARY(ZI,1)=$$HTMLDT^C0IUTIL(C0IDATE)
"RTN","C0IICE",206,0)
 . S GARY(ZI,1)=$E(C0IDATE,5,6)_"/"_$E(C0IDATE,7,8)_"/"_$E(C0IDATE,1,4)
"RTN","C0IICE",207,0)
 . N CODE S CODE=$G(@GN@(ZI,"substanceCode@code"))
"RTN","C0IICE",208,0)
 . I $L(CODE)=1 S CODE="0"_CODE
"RTN","C0IICE",209,0)
 . N GGRP S GGRP=$G(@GN@(ZI,"substanceCode@displayName"))
"RTN","C0IICE",210,0)
 . S GGRP=$P($P(GGRP,"(",2),")",1)
"RTN","C0IICE",211,0)
 . S CODE="<a href=""https://raw.githubusercontent.com/glilly/ice-testing/master/trunk/ice-config/VaccineGroups/"_CODE_".xml"" target=""_blank"">"_CODE_"</a>"
"RTN","C0IICE",212,0)
 . S GARY(ZI,2)=GGRP_" ("_CODE_")"
"RTN","C0IICE",213,0)
 . S GARY(ZI,3)=$G(@GN@(ZI,"concept@displayName"))
"RTN","C0IICE",214,0)
 . N TERP S TERP=$G(@GN@(ZI,"interpretation@code"))
"RTN","C0IICE",215,0)
 . S GARY(ZI,4)=$G(@GN@(ZI,"interpretation@displayName"))_" ("_TERP_")"
"RTN","C0IICE",216,0)
 . S GARY(ZI,5)=ZI
"RTN","C0IICE",217,0)
 D GENHTML^C0IUTIL(RTN,"GARY")
"RTN","C0IICE",218,0)
 K @RTN@(0)
"RTN","C0IICE",219,0)
 Q
"RTN","C0IICE",220,0)
 ;
"RTN","C0IICE",221,0)
DEMHTML(RTN,ARY) ; generate an html demographics table from the return array. 
"RTN","C0IICE",222,0)
 ; both passed by name
"RTN","C0IICE",223,0)
 N GARY
"RTN","C0IICE",224,0)
 S GARY("TITLE")="ICE Return - Demographics"
"RTN","C0IICE",225,0)
 S GARY("HEADER",1)="Date of Birth"
"RTN","C0IICE",226,0)
 S GARY("HEADER",2)="Gender"
"RTN","C0IICE",227,0)
 S GARY("HEADER",3)="Patient ID"
"RTN","C0IICE",228,0)
 N C0IDATE S C0IDATE=$G(@ARY@("demographics","birthTime@value"))
"RTN","C0IICE",229,0)
 S GARY(1,1)=$E(C0IDATE,5,6)_"/"_$E(C0IDATE,7,8)_"/"_$E(C0IDATE,1,4)
"RTN","C0IICE",230,0)
 S GARY(2,1)=$G(@ARY@("demographics","gender@displayName"))
"RTN","C0IICE",231,0)
 S GARY(3,1)=$G(FILTER("patientId"))
"RTN","C0IICE",232,0)
 D GENVHTML^C0IUTIL(RTN,"GARY")
"RTN","C0IICE",233,0)
 K @RTN@(0)
"RTN","C0IICE",234,0)
 Q
"RTN","C0IICE",235,0)
 ;
"RTN","C0IMAP")
0^6^B601607457
"RTN","C0IMAP",1,0)
C0IMAP ; GPL&NEA - Immunizations Forecasting Routine ;05/03/14  17:05
"RTN","C0IMAP",2,0)
 ;;0.1;Immunizations Forecasting;nopatch;noreleasedate;Build 1
"RTN","C0IMAP",3,0)
 ;
"RTN","C0IMAP",4,0)
 ; License Apache 2
"RTN","C0IMAP",5,0)
 ; 
"RTN","C0IMAP",6,0)
 Q
"RTN","C0IMAP",7,0)
 ;
"RTN","C0IMAP",8,0)
SETMAP ;
"RTN","C0IMAP",9,0)
 N G S G=$NA(^C0CodeMap("immunizations"))
"RTN","C0IMAP",10,0)
 S @G@(1,"CPT")=90701
"RTN","C0IMAP",11,0)
 S @G@(1,"CVXcode")=1
"RTN","C0IMAP",12,0)
 S @G@(1,"altName",1)="DIP,PERT,TET (DPT)"
"RTN","C0IMAP",13,0)
 S @G@(1,"altName",2)="DIP.,PERT.,TET. (DPT)"
"RTN","C0IMAP",14,0)
 S @G@(1,"preferredName")="DTP"
"RTN","C0IMAP",15,0)
 S @G@(2,"CPT")=90712
"RTN","C0IMAP",16,0)
 S @G@(2,"CVXcode")=2
"RTN","C0IMAP",17,0)
 S @G@(2,"altName",1)="ORAL POLIOVIRUS"
"RTN","C0IMAP",18,0)
 S @G@(2,"preferredName")="OPV"
"RTN","C0IMAP",19,0)
 S @G@(3,"CPT")=90707
"RTN","C0IMAP",20,0)
 S @G@(3,"CVXcode")=3
"RTN","C0IMAP",21,0)
 S @G@(3,"altName",1)="MMR1"
"RTN","C0IMAP",22,0)
 S @G@(3,"altName",2)="MEASLES,MUMPS,RUBELLA (MMR)"
"RTN","C0IMAP",23,0)
 S @G@(3,"altName",3)="MEASLES,MUMPS,RUBELLA PED #1"
"RTN","C0IMAP",24,0)
 S @G@(3,"altName",4)="MEASLES,MUMPS,RUBELLA PED #2"
"RTN","C0IMAP",25,0)
 S @G@(3,"preferredName")="MMR"
"RTN","C0IMAP",26,0)
 S @G@(4,"CPT")=90708
"RTN","C0IMAP",27,0)
 S @G@(4,"CVXcode")=4
"RTN","C0IMAP",28,0)
 S @G@(4,"altName",1)="MEASLES,RUBELLA (MR)"
"RTN","C0IMAP",29,0)
 S @G@(4,"preferredName")="M/R"
"RTN","C0IMAP",30,0)
 S @G@(5,"CPT")=90705
"RTN","C0IMAP",31,0)
 S @G@(5,"CVXcode")=5
"RTN","C0IMAP",32,0)
 S @G@(5,"altName",1)="MEASLES"
"RTN","C0IMAP",33,0)
 S @G@(5,"preferredName")="measles"
"RTN","C0IMAP",34,0)
 S @G@(6,"CPT")=90706
"RTN","C0IMAP",35,0)
 S @G@(6,"CVXcode")=6
"RTN","C0IMAP",36,0)
 S @G@(6,"altName",1)="RUBELLA"
"RTN","C0IMAP",37,0)
 S @G@(6,"preferredName")="rubella"
"RTN","C0IMAP",38,0)
 S @G@(7,"CPT")=90704
"RTN","C0IMAP",39,0)
 S @G@(7,"CVXcode")=7
"RTN","C0IMAP",40,0)
 S @G@(7,"altName",1)="MUMPS"
"RTN","C0IMAP",41,0)
 S @G@(7,"preferredName")="mumps"
"RTN","C0IMAP",42,0)
 S @G@(8,"CPT")=90744
"RTN","C0IMAP",43,0)
 S @G@(8,"CVXcode")=8
"RTN","C0IMAP",44,0)
 S @G@(8,"altName",1)="HEP B PED/ADOL 3 DOSE"
"RTN","C0IMAP",45,0)
 S @G@(8,"altName",2)="HEPB PED/ADOL-2"
"RTN","C0IMAP",46,0)
 S @G@(8,"altName",3)="HEPB PED/ADOL-3"
"RTN","C0IMAP",47,0)
 S @G@(8,"altName",4)="HEPB PED/ADOL-4"
"RTN","C0IMAP",48,0)
 S @G@(8,"altName",5)="HEPB, PED/ADOL-1"
"RTN","C0IMAP",49,0)
 S @G@(8,"preferredName")="Hep B, adolescent or pediatric"
"RTN","C0IMAP",50,0)
 S @G@(9,"CPT")=90718
"RTN","C0IMAP",51,0)
 S @G@(9,"CVXcode")=9
"RTN","C0IMAP",52,0)
 S @G@(9,"altName",1)="TETANUS DIPTHERIA (TD-ADULT)"
"RTN","C0IMAP",53,0)
 S @G@(9,"preferredName")="Td (adult), adsorbed"
"RTN","C0IMAP",54,0)
 S @G@(10,"CPT")=90713
"RTN","C0IMAP",55,0)
 S @G@(10,"CVXcode")=10
"RTN","C0IMAP",56,0)
 S @G@(10,"altName",1)="IPV4"
"RTN","C0IMAP",57,0)
 S @G@(10,"altName",2)="IPV1"
"RTN","C0IMAP",58,0)
 S @G@(10,"altName",3)="IPV2"
"RTN","C0IMAP",59,0)
 S @G@(10,"altName",4)="IPV3"
"RTN","C0IMAP",60,0)
 S @G@(10,"altName",5)="POLIOVIRUS PED #1"
"RTN","C0IMAP",61,0)
 S @G@(10,"altName",6)="POLIOVIRUS PED #2"
"RTN","C0IMAP",62,0)
 S @G@(10,"altName",7)="POLIOVIRUS PED #3"
"RTN","C0IMAP",63,0)
 S @G@(10,"altName",8)="POLIOVIRUS PED #4"
"RTN","C0IMAP",64,0)
 S @G@(10,"preferredName")="IPV"
"RTN","C0IMAP",65,0)
 S @G@(12,"CPT")=90296
"RTN","C0IMAP",66,0)
 S @G@(12,"CVXcode")=12
"RTN","C0IMAP",67,0)
 S @G@(12,"preferredName")="diphtheria antitoxin"
"RTN","C0IMAP",68,0)
 S @G@(13,"CPT")=90389
"RTN","C0IMAP",69,0)
 S @G@(13,"CVXcode")=13
"RTN","C0IMAP",70,0)
 S @G@(13,"preferredName")="TIG"
"RTN","C0IMAP",71,0)
 S @G@(14,"CPT")=90741
"RTN","C0IMAP",72,0)
 S @G@(14,"CVXcode")=14
"RTN","C0IMAP",73,0)
 S @G@(14,"altName",1)="GAMMA GLOBULIN"
"RTN","C0IMAP",74,0)
 S @G@(14,"preferredName")="IG, unspecified formulation"
"RTN","C0IMAP",75,0)
 S @G@(16,"CPT")=90659
"RTN","C0IMAP",76,0)
 S @G@(16,"CVXcode")=16
"RTN","C0IMAP",77,0)
 S @G@(16,"altName",1)="FLU,WHOLE"
"RTN","C0IMAP",78,0)
 S @G@(16,"preferredName")="influenza, whole"
"RTN","C0IMAP",79,0)
 S @G@(17,"CPT")=90737
"RTN","C0IMAP",80,0)
 S @G@(17,"CVXcode")=17
"RTN","C0IMAP",81,0)
 S @G@(17,"altName",1)="INFLUENZA B"
"RTN","C0IMAP",82,0)
 S @G@(17,"preferredName")="Hib, unspecified formulation"
"RTN","C0IMAP",83,0)
 S @G@(18,"CPT")=90675
"RTN","C0IMAP",84,0)
 S @G@(18,"CVXcode")=18
"RTN","C0IMAP",85,0)
 S @G@(18,"altName",1)="RABIES,IM"
"RTN","C0IMAP",86,0)
 S @G@(18,"preferredName")="rabies, intramuscular injection"
"RTN","C0IMAP",87,0)
 S @G@(19,"CPT")=90728
"RTN","C0IMAP",88,0)
 S @G@(19,"CVXcode")=19
"RTN","C0IMAP",89,0)
 S @G@(19,"altName",1)="BCG,PERCUT"
"RTN","C0IMAP",90,0)
 S @G@(19,"preferredName")="BCG"
"RTN","C0IMAP",91,0)
 S @G@(20,"CVXcode")=20
"RTN","C0IMAP",92,0)
 S @G@(20,"altName",1)="DIP.,PERT.,TET. (DPT) PED 5"
"RTN","C0IMAP",93,0)
 S @G@(20,"altName",2)="DIP.,PERT.,TET. (DPT) PED 1"
"RTN","C0IMAP",94,0)
 S @G@(20,"altName",3)="DIP.,PERT.,TET. (DPT) PED 2"
"RTN","C0IMAP",95,0)
 S @G@(20,"altName",4)="DIP.,PERT.,TET. (DPT) PED 3"
"RTN","C0IMAP",96,0)
 S @G@(20,"altName",5)="DIP.,PERT.,TET. (DPT) PED 4"
"RTN","C0IMAP",97,0)
 S @G@(20,"preferredName")="DTaP"
"RTN","C0IMAP",98,0)
 S @G@(21,"CPT")=90716
"RTN","C0IMAP",99,0)
 S @G@(21,"CVXcode")=21
"RTN","C0IMAP",100,0)
 S @G@(21,"altName",1)="VZV2 INFANT"
"RTN","C0IMAP",101,0)
 S @G@(21,"altName",2)="CHICKENPOX"
"RTN","C0IMAP",102,0)
 S @G@(21,"altName",3)="VZV1 INFANT"
"RTN","C0IMAP",103,0)
 S @G@(21,"preferredName")="varicella"
"RTN","C0IMAP",104,0)
 S @G@(22,"CPT")=90720
"RTN","C0IMAP",105,0)
 S @G@(22,"CVXcode")=22
"RTN","C0IMAP",106,0)
 S @G@(22,"altName",1)="DTB/HIB"
"RTN","C0IMAP",107,0)
 S @G@(22,"preferredName")="DTP-Hib"
"RTN","C0IMAP",108,0)
 S @G@(23,"CPT")=90727
"RTN","C0IMAP",109,0)
 S @G@(23,"CVXcode")=23
"RTN","C0IMAP",110,0)
 S @G@(23,"altName",1)="PLAGUE"
"RTN","C0IMAP",111,0)
 S @G@(23,"preferredName")="plague"
"RTN","C0IMAP",112,0)
 S @G@(24,"CPT")=90581
"RTN","C0IMAP",113,0)
 S @G@(24,"CVXcode")=24
"RTN","C0IMAP",114,0)
 S @G@(24,"altName",1)="ANTHRAX,SC"
"RTN","C0IMAP",115,0)
 S @G@(24,"preferredName")="anthrax"
"RTN","C0IMAP",116,0)
 S @G@(25,"CPT")=90690
"RTN","C0IMAP",117,0)
 S @G@(25,"CVXcode")=25
"RTN","C0IMAP",118,0)
 S @G@(25,"altName",1)="TYPHOID,ORAL"
"RTN","C0IMAP",119,0)
 S @G@(25,"preferredName")="typhoid, oral"
"RTN","C0IMAP",120,0)
 S @G@(26,"CPT")=90725
"RTN","C0IMAP",121,0)
 S @G@(26,"CVXcode")=26
"RTN","C0IMAP",122,0)
 S @G@(26,"altName",1)="CHOLERA, ORAL"
"RTN","C0IMAP",123,0)
 S @G@(26,"altName",2)="CHOLERA"
"RTN","C0IMAP",124,0)
 S @G@(26,"preferredName")="cholera"
"RTN","C0IMAP",125,0)
 S @G@(27,"CPT")=90287
"RTN","C0IMAP",126,0)
 S @G@(27,"CVXcode")=27
"RTN","C0IMAP",127,0)
 S @G@(27,"preferredName")="botulinum antitoxin"
"RTN","C0IMAP",128,0)
 S @G@(28,"CPT")=90702
"RTN","C0IMAP",129,0)
 S @G@(28,"CVXcode")=28
"RTN","C0IMAP",130,0)
 S @G@(28,"altName",1)="DIPTHERIA-TETANUS (DT-PEDS)"
"RTN","C0IMAP",131,0)
 S @G@(28,"preferredName")="DT (pediatric)"
"RTN","C0IMAP",132,0)
 S @G@(29,"CPT")=90291
"RTN","C0IMAP",133,0)
 S @G@(29,"CVXcode")=29
"RTN","C0IMAP",134,0)
 S @G@(29,"preferredName")="CMVIG"
"RTN","C0IMAP",135,0)
 S @G@(30,"CPT")=90371
"RTN","C0IMAP",136,0)
 S @G@(30,"CVXcode")=30
"RTN","C0IMAP",137,0)
 S @G@(30,"preferredName")="HBIG"
"RTN","C0IMAP",138,0)
 S @G@(32,"CPT")=90733
"RTN","C0IMAP",139,0)
 S @G@(32,"CVXcode")=32
"RTN","C0IMAP",140,0)
 S @G@(32,"altName",1)="MENINGOCOCCAL"
"RTN","C0IMAP",141,0)
 S @G@(32,"preferredName")="meningococcal MPSV4"
"RTN","C0IMAP",142,0)
 S @G@(33,"CPT")=90732
"RTN","C0IMAP",143,0)
 S @G@(33,"CVXcode")=33
"RTN","C0IMAP",144,0)
 S @G@(33,"altName",1)="PNEUMOVAX"
"RTN","C0IMAP",145,0)
 S @G@(33,"altName",2)="PNEUMOCOCCAL"
"RTN","C0IMAP",146,0)
 S @G@(33,"preferredName")="pneumococcal polysaccharide PPV23"
"RTN","C0IMAP",147,0)
 S @G@(34,"CPT")=90376
"RTN","C0IMAP",148,0)
 S @G@(34,"CVXcode")=34
"RTN","C0IMAP",149,0)
 S @G@(34,"preferredName")="RIG"
"RTN","C0IMAP",150,0)
 S @G@(35,"CPT")=90703
"RTN","C0IMAP",151,0)
 S @G@(35,"CVXcode")=35
"RTN","C0IMAP",152,0)
 S @G@(35,"altName",1)="TETANUS TOXOID"
"RTN","C0IMAP",153,0)
 S @G@(35,"preferredName")="tetanus toxoid, adsorbed"
"RTN","C0IMAP",154,0)
 S @G@(36,"CPT")=90396
"RTN","C0IMAP",155,0)
 S @G@(36,"CVXcode")=36
"RTN","C0IMAP",156,0)
 S @G@(36,"preferredName")="VZIG"
"RTN","C0IMAP",157,0)
 S @G@(37,"CPT")=90717
"RTN","C0IMAP",158,0)
 S @G@(37,"CVXcode")=37
"RTN","C0IMAP",159,0)
 S @G@(37,"altName",1)="YELLOW FEVER"
"RTN","C0IMAP",160,0)
 S @G@(37,"preferredName")="yellow fever"
"RTN","C0IMAP",161,0)
 S @G@(38,"altName",1)="RUBELLA, MUMPS"
"RTN","C0IMAP",162,0)
 S @G@(39,"CPT")=90735
"RTN","C0IMAP",163,0)
 S @G@(39,"CVXcode")=39
"RTN","C0IMAP",164,0)
 S @G@(39,"altName",1)="ENCEPHALITIS"
"RTN","C0IMAP",165,0)
 S @G@(39,"preferredName")="Japanese encephalitis SC"
"RTN","C0IMAP",166,0)
 S @G@(40,"CPT")=90676
"RTN","C0IMAP",167,0)
 S @G@(40,"CVXcode")=40
"RTN","C0IMAP",168,0)
 S @G@(40,"altName",1)="RABIES,ID"
"RTN","C0IMAP",169,0)
 S @G@(40,"preferredName")="rabies, intradermal injection"
"RTN","C0IMAP",170,0)
 S @G@(41,"CPT")=90692
"RTN","C0IMAP",171,0)
 S @G@(41,"CVXcode")=41
"RTN","C0IMAP",172,0)
 S @G@(41,"altName",1)="TYPHOID,H-P,SC/ID"
"RTN","C0IMAP",173,0)
 S @G@(41,"preferredName")="typhoid, parenteral"
"RTN","C0IMAP",174,0)
 S @G@(42,"CPT")=90745
"RTN","C0IMAP",175,0)
 S @G@(42,"CVXcode")=42
"RTN","C0IMAP",176,0)
 S @G@(42,"altName",1)="HEP B4 INFANT"
"RTN","C0IMAP",177,0)
 S @G@(42,"altName",2)="HEP B1 INFANT"
"RTN","C0IMAP",178,0)
 S @G@(42,"altName",3)="HEP B2 INFANT"
"RTN","C0IMAP",179,0)
 S @G@(42,"altName",4)="HEP B3 INFANT"
"RTN","C0IMAP",180,0)
 S @G@(42,"preferredName")="Hep B, adolescent/high risk infant"
"RTN","C0IMAP",181,0)
 S @G@(43,"CPT")=90746
"RTN","C0IMAP",182,0)
 S @G@(43,"CVXcode")=43
"RTN","C0IMAP",183,0)
 S @G@(43,"altName",1)="SWINE FLU BIVAL"
"RTN","C0IMAP",184,0)
 S @G@(43,"preferredName")="Hep B, adult"
"RTN","C0IMAP",185,0)
 S @G@(44,"CPT")=90747
"RTN","C0IMAP",186,0)
 S @G@(44,"CVXcode")=44
"RTN","C0IMAP",187,0)
 S @G@(44,"altName",1)="HEPB, ILL PAT"
"RTN","C0IMAP",188,0)
 S @G@(44,"preferredName")="Hep B, dialysis"
"RTN","C0IMAP",189,0)
 S @G@(45,"CPT")=90731
"RTN","C0IMAP",190,0)
 S @G@(45,"CVXcode")=45
"RTN","C0IMAP",191,0)
 S @G@(45,"altName",1)="HEPATITIS B"
"RTN","C0IMAP",192,0)
 S @G@(45,"preferredName")="Hep B, unspecified formulation"
"RTN","C0IMAP",193,0)
 S @G@(46,"CPT")=90646
"RTN","C0IMAP",194,0)
 S @G@(46,"CVXcode")=46
"RTN","C0IMAP",195,0)
 S @G@(46,"altName",1)="HIB,PRP-D"
"RTN","C0IMAP",196,0)
 S @G@(46,"preferredName")="Hib (PRP-D)"
"RTN","C0IMAP",197,0)
 S @G@(47,"CPT")=90645
"RTN","C0IMAP",198,0)
 S @G@(47,"CVXcode")=47
"RTN","C0IMAP",199,0)
 S @G@(47,"altName",1)="HIB PED 4"
"RTN","C0IMAP",200,0)
 S @G@(47,"altName",2)="HIB PED 1"
"RTN","C0IMAP",201,0)
 S @G@(47,"altName",3)="HIB PED 2"
"RTN","C0IMAP",202,0)
 S @G@(47,"altName",4)="HIB PED 3"
"RTN","C0IMAP",203,0)
 S @G@(47,"altName",5)="HIB,HBOC"
"RTN","C0IMAP",204,0)
 S @G@(47,"preferredName")="Hib (HbOC)"
"RTN","C0IMAP",205,0)
 S @G@(48,"CPT")=90648
"RTN","C0IMAP",206,0)
 S @G@(48,"CVXcode")=48
"RTN","C0IMAP",207,0)
 S @G@(48,"altName",1)="HIB,PRP-T"
"RTN","C0IMAP",208,0)
 S @G@(48,"preferredName")="Hib (PRP-T)"
"RTN","C0IMAP",209,0)
 S @G@(49,"CPT")=90647
"RTN","C0IMAP",210,0)
 S @G@(49,"CVXcode")=49
"RTN","C0IMAP",211,0)
 S @G@(49,"altName",1)="HiB3"
"RTN","C0IMAP",212,0)
 S @G@(49,"altName",2)="HIB,PRP-OMP"
"RTN","C0IMAP",213,0)
 S @G@(49,"altName",3)="HiB1"
"RTN","C0IMAP",214,0)
 S @G@(49,"altName",4)="HiB2"
"RTN","C0IMAP",215,0)
 S @G@(49,"preferredName")="Hib (PRP-OMP)"
"RTN","C0IMAP",216,0)
 S @G@(50,"CPT")=90721
"RTN","C0IMAP",217,0)
 S @G@(50,"CVXcode")=50
"RTN","C0IMAP",218,0)
 S @G@(50,"preferredName")="DTaP-Hib"
"RTN","C0IMAP",219,0)
 S @G@(51,"CPT")=90748
"RTN","C0IMAP",220,0)
 S @G@(51,"CVXcode")=51
"RTN","C0IMAP",221,0)
 S @G@(51,"altName",1)="HEPB/HIB"
"RTN","C0IMAP",222,0)
 S @G@(51,"preferredName")="Hib-Hep B"
"RTN","C0IMAP",223,0)
 S @G@(52,"CPT")=90632
"RTN","C0IMAP",224,0)
 S @G@(52,"CVXcode")=52
"RTN","C0IMAP",225,0)
 S @G@(52,"altName",1)="HEPA ADULT"
"RTN","C0IMAP",226,0)
 S @G@(52,"preferredName")="Hep A, adult"
"RTN","C0IMAP",227,0)
 S @G@(53,"CPT")=90693
"RTN","C0IMAP",228,0)
 S @G@(53,"CVXcode")=53
"RTN","C0IMAP",229,0)
 S @G@(53,"altName",1)="TYPHOID,AKD,SC"
"RTN","C0IMAP",230,0)
 S @G@(53,"preferredName")="typhoid, parenteral, AKD (U.S. military)"
"RTN","C0IMAP",231,0)
 S @G@(54,"CPT")=90476
"RTN","C0IMAP",232,0)
 S @G@(54,"CVXcode")=54
"RTN","C0IMAP",233,0)
 S @G@(54,"altName",1)="ADENOVIRUS,TYPE 4"
"RTN","C0IMAP",234,0)
 S @G@(54,"preferredName")="adenovirus, type 4"
"RTN","C0IMAP",235,0)
 S @G@(55,"CPT")=90477
"RTN","C0IMAP",236,0)
 S @G@(55,"CVXcode")=55
"RTN","C0IMAP",237,0)
 S @G@(55,"altName",1)="ADENOVIRUS,TYPE 7"
"RTN","C0IMAP",238,0)
 S @G@(55,"preferredName")="adenovirus, type 7"
"RTN","C0IMAP",239,0)
 S @G@(62,"CPT")=90649
"RTN","C0IMAP",240,0)
 S @G@(62,"CVXcode")=62
"RTN","C0IMAP",241,0)
 S @G@(62,"preferredName")="HPV, quadrivalent"
"RTN","C0IMAP",242,0)
 S @G@(66,"CPT")=90665
"RTN","C0IMAP",243,0)
 S @G@(66,"CVXcode")=66
"RTN","C0IMAP",244,0)
 S @G@(66,"altName",1)="LYME DISEASE"
"RTN","C0IMAP",245,0)
 S @G@(66,"preferredName")="Lyme disease"
"RTN","C0IMAP",246,0)
 S @G@(71,"CPT")=90379
"RTN","C0IMAP",247,0)
 S @G@(71,"CVXcode")=71
"RTN","C0IMAP",248,0)
 S @G@(71,"preferredName")="RSV-IGIV"
"RTN","C0IMAP",249,0)
 S @G@(75,"altName",1)="SMALLPOX"
"RTN","C0IMAP",250,0)
 S @G@(79,"CPT")=90393
"RTN","C0IMAP",251,0)
 S @G@(79,"CVXcode")=79
"RTN","C0IMAP",252,0)
 S @G@(79,"preferredName")="vaccinia immune globulin"
"RTN","C0IMAP",253,0)
 S @G@(83,"CPT")=90633
"RTN","C0IMAP",254,0)
 S @G@(83,"CVXcode")=83
"RTN","C0IMAP",255,0)
 S @G@(83,"altName",1)="HEP A2 PEDS"
"RTN","C0IMAP",256,0)
 S @G@(83,"altName",2)="HEP A1 PEDS"
"RTN","C0IMAP",257,0)
 S @G@(83,"altName",3)="HEPA,PED/ADOL-2"
"RTN","C0IMAP",258,0)
 S @G@(83,"preferredName")="Hep A, ped/adol, 2 dose"
"RTN","C0IMAP",259,0)
 S @G@(84,"CPT")=90634
"RTN","C0IMAP",260,0)
 S @G@(84,"CVXcode")=84
"RTN","C0IMAP",261,0)
 S @G@(84,"altName",1)="HEP A3 PEDS"
"RTN","C0IMAP",262,0)
 S @G@(84,"altName",2)="HEPA,PED/ADOL-3 DOSE"
"RTN","C0IMAP",263,0)
 S @G@(84,"preferredName")="Hep A, ped/adol, 3 dose"
"RTN","C0IMAP",264,0)
 S @G@(85,"CPT")=90730
"RTN","C0IMAP",265,0)
 S @G@(85,"CVXcode")=85
"RTN","C0IMAP",266,0)
 S @G@(85,"altName",1)="HEPATITIS A"
"RTN","C0IMAP",267,0)
 S @G@(85,"preferredName")="Hep A, unspecified formulation"
"RTN","C0IMAP",268,0)
 S @G@(86,"CPT")=90281
"RTN","C0IMAP",269,0)
 S @G@(86,"CVXcode")=86
"RTN","C0IMAP",270,0)
 S @G@(86,"preferredName")="IG"
"RTN","C0IMAP",271,0)
 S @G@(87,"CPT")=90283
"RTN","C0IMAP",272,0)
 S @G@(87,"CVXcode")=87
"RTN","C0IMAP",273,0)
 S @G@(87,"preferredName")="IGIV"
"RTN","C0IMAP",274,0)
 S @G@(88,"CPT")=90724
"RTN","C0IMAP",275,0)
 S @G@(88,"CVXcode")=88
"RTN","C0IMAP",276,0)
 S @G@(88,"altName",1)="INFLUENZA"
"RTN","C0IMAP",277,0)
 S @G@(88,"preferredName")="influenza, unspecified formulation"
"RTN","C0IMAP",278,0)
 S @G@(90,"CPT")=90726
"RTN","C0IMAP",279,0)
 S @G@(90,"CVXcode")=90
"RTN","C0IMAP",280,0)
 S @G@(90,"altName",1)="RABIES"
"RTN","C0IMAP",281,0)
 S @G@(90,"preferredName")="rabies, unspecified formulation"
"RTN","C0IMAP",282,0)
 S @G@(91,"CPT")=90714
"RTN","C0IMAP",283,0)
 S @G@(91,"CVXcode")=91
"RTN","C0IMAP",284,0)
 S @G@(91,"altName",1)="TYPHOID"
"RTN","C0IMAP",285,0)
 S @G@(91,"preferredName")="typhoid, unspecified formulation"
"RTN","C0IMAP",286,0)
 S @G@(93,"CPT")=90378
"RTN","C0IMAP",287,0)
 S @G@(93,"CVXcode")=93
"RTN","C0IMAP",288,0)
 S @G@(93,"preferredName")="RSV-MAb"
"RTN","C0IMAP",289,0)
 S @G@(94,"CPT")=90710
"RTN","C0IMAP",290,0)
 S @G@(94,"CVXcode")=94
"RTN","C0IMAP",291,0)
 S @G@(94,"altName",1)="MEA-MUMPS-RUB-VARCELLA"
"RTN","C0IMAP",292,0)
 S @G@(94,"preferredName")="MMRV"
"RTN","C0IMAP",293,0)
 S @G@(100,"CPT")=90669
"RTN","C0IMAP",294,0)
 S @G@(100,"CVXcode")=100
"RTN","C0IMAP",295,0)
 S @G@(100,"altName",1)="PNEUMOCOCCAL PED 4"
"RTN","C0IMAP",296,0)
 S @G@(100,"altName",2)="PNEUMOCOCCAL PED 1"
"RTN","C0IMAP",297,0)
 S @G@(100,"altName",3)="PNEUMOCOCCAL PED 2"
"RTN","C0IMAP",298,0)
 S @G@(100,"altName",4)="PNEUMOCOCCAL PED 3"
"RTN","C0IMAP",299,0)
 S @G@(100,"altName",5)="PNEUMOCOCCAL,PED"
"RTN","C0IMAP",300,0)
 S @G@(100,"preferredName")="pneumococcal conjugate PCV 7"
"RTN","C0IMAP",301,0)
 S @G@(101,"CPT")=90691
"RTN","C0IMAP",302,0)
 S @G@(101,"CVXcode")=101
"RTN","C0IMAP",303,0)
 S @G@(101,"altName",1)="TYPHOID"
"RTN","C0IMAP",304,0)
 S @G@(101,"preferredName")="typhoid, ViCPs"
"RTN","C0IMAP",305,0)
 S @G@(104,"CPT")=90636
"RTN","C0IMAP",306,0)
 S @G@(104,"CVXcode")=104
"RTN","C0IMAP",307,0)
 S @G@(104,"altName",1)="HEPA/HEPB ADULT"
"RTN","C0IMAP",308,0)
 S @G@(104,"preferredName")="Hep A-Hep B"
"RTN","C0IMAP",309,0)
 S @G@(106,"CPT")=90700
"RTN","C0IMAP",310,0)
 S @G@(106,"CVXcode")=106
"RTN","C0IMAP",311,0)
 S @G@(106,"altName",1)="DTaP5"
"RTN","C0IMAP",312,0)
 S @G@(106,"altName",2)="DIP,PERT,TET (DPT) PED 1"
"RTN","C0IMAP",313,0)
 S @G@(106,"altName",3)="DIP,PERT,TET (DPT) PED 2"
"RTN","C0IMAP",314,0)
 S @G@(106,"altName",4)="DIP,PERT,TET (DPT) PED 3"
"RTN","C0IMAP",315,0)
 S @G@(106,"altName",5)="DIP,PERT,TET (DPT) PED 4"
"RTN","C0IMAP",316,0)
 S @G@(106,"altName",6)="DIP,PERT,TET (DPT) PED 5"
"RTN","C0IMAP",317,0)
 S @G@(106,"altName",7)="DIP-TET-a/PERT"
"RTN","C0IMAP",318,0)
 S @G@(106,"altName",8)="DTaP1"
"RTN","C0IMAP",319,0)
 S @G@(106,"altName",9)="DTaP2"
"RTN","C0IMAP",320,0)
 S @G@(106,"altName",10)="DTaP3"
"RTN","C0IMAP",321,0)
 S @G@(106,"altName",11)="DTaP4"
"RTN","C0IMAP",322,0)
 S @G@(106,"preferredName")="DTaP, 5 pertussis antigens"
"RTN","C0IMAP",323,0)
 S @G@(110,"CPT")=90723
"RTN","C0IMAP",324,0)
 S @G@(110,"CVXcode")=110
"RTN","C0IMAP",325,0)
 S @G@(110,"preferredName")="DTaP-Hep B-IPV"
"RTN","C0IMAP",326,0)
 S @G@(111,"CPT")=90660
"RTN","C0IMAP",327,0)
 S @G@(111,"CVXcode")=111
"RTN","C0IMAP",328,0)
 S @G@(111,"altName",1)="FLU,NASAL"
"RTN","C0IMAP",329,0)
 S @G@(111,"preferredName")="influenza, live, intranasal"
"RTN","C0IMAP",330,0)
 S @G@(113,"CVXcode")=113
"RTN","C0IMAP",331,0)
 S @G@(113,"preferredName")="Td (adult) preservative free"
"RTN","C0IMAP",332,0)
 S @G@(114,"CPT")=90734
"RTN","C0IMAP",333,0)
 S @G@(114,"CVXcode")=114
"RTN","C0IMAP",334,0)
 S @G@(114,"preferredName")="meningococcal MCV4P"
"RTN","C0IMAP",335,0)
 S @G@(115,"CPT")=90715
"RTN","C0IMAP",336,0)
 S @G@(115,"CVXcode")=115
"RTN","C0IMAP",337,0)
 S @G@(115,"altName",1)="TETANUS, DIPTHERIA AND PERTUSSIS"
"RTN","C0IMAP",338,0)
 S @G@(115,"preferredName")="Tdap"
"RTN","C0IMAP",339,0)
 S @G@(116,"CPT")=90680
"RTN","C0IMAP",340,0)
 S @G@(116,"CVXcode")=116
"RTN","C0IMAP",341,0)
 S @G@(116,"altName",1)="RV 4 PEDS"
"RTN","C0IMAP",342,0)
 S @G@(116,"altName",2)="ROTOVIRUS,ORAL"
"RTN","C0IMAP",343,0)
 S @G@(116,"altName",3)="RV 1 PEDS"
"RTN","C0IMAP",344,0)
 S @G@(116,"altName",4)="RV 2 PEDS"
"RTN","C0IMAP",345,0)
 S @G@(116,"altName",5)="RV 3 PEDS"
"RTN","C0IMAP",346,0)
 S @G@(116,"preferredName")="rotavirus, pentavalent"
"RTN","C0IMAP",347,0)
 S @G@(118,"CPT")=90650
"RTN","C0IMAP",348,0)
 S @G@(118,"CVXcode")=118
"RTN","C0IMAP",349,0)
 S @G@(118,"preferredName")="HPV, bivalent"
"RTN","C0IMAP",350,0)
 S @G@(119,"CPT")=90681
"RTN","C0IMAP",351,0)
 S @G@(119,"CVXcode")=119
"RTN","C0IMAP",352,0)
 S @G@(119,"preferredName")="rotavirus, monovalent"
"RTN","C0IMAP",353,0)
 S @G@(120,"CPT")=90698
"RTN","C0IMAP",354,0)
 S @G@(120,"CVXcode")=120
"RTN","C0IMAP",355,0)
 S @G@(120,"preferredName")="DTaP-Hib-IPV"
"RTN","C0IMAP",356,0)
 S @G@(121,"CPT")=90736
"RTN","C0IMAP",357,0)
 S @G@(121,"CVXcode")=121
"RTN","C0IMAP",358,0)
 S @G@(121,"preferredName")="zoster"
"RTN","C0IMAP",359,0)
 S @G@(125,"CPT")=90664
"RTN","C0IMAP",360,0)
 S @G@(125,"CVXcode")=125
"RTN","C0IMAP",361,0)
 S @G@(125,"preferredName")="Novel Influenza-H1N1-09, nasal"
"RTN","C0IMAP",362,0)
 S @G@(126,"CPT")=90666
"RTN","C0IMAP",363,0)
 S @G@(126,"CVXcode")=126
"RTN","C0IMAP",364,0)
 S @G@(126,"preferredName")="Novel influenza-H1N1-09, preservative-free"
"RTN","C0IMAP",365,0)
 S @G@(127,"CPT")=90668
"RTN","C0IMAP",366,0)
 S @G@(127,"CVXcode")=127
"RTN","C0IMAP",367,0)
 S @G@(127,"preferredName")="Novel influenza-H1N1-09"
"RTN","C0IMAP",368,0)
 S @G@(128,"CPT")=90663
"RTN","C0IMAP",369,0)
 S @G@(128,"CVXcode")=128
"RTN","C0IMAP",370,0)
 S @G@(128,"preferredName")="Novel Influenza-H1N1-09, all formulations"
"RTN","C0IMAP",371,0)
 S @G@(130,"CPT")=90696
"RTN","C0IMAP",372,0)
 S @G@(130,"CVXcode")=130
"RTN","C0IMAP",373,0)
 S @G@(130,"preferredName")="DTaP-IPV"
"RTN","C0IMAP",374,0)
 S @G@(131,"altName",1)="TYPHUS"
"RTN","C0IMAP",375,0)
 S @G@(133,"CPT")=90670
"RTN","C0IMAP",376,0)
 S @G@(133,"CVXcode")=133
"RTN","C0IMAP",377,0)
 S @G@(133,"altName",1)="PCV5 PEDS"
"RTN","C0IMAP",378,0)
 S @G@(133,"altName",2)="PCV1 PEDS"
"RTN","C0IMAP",379,0)
 S @G@(133,"altName",3)="PCV2 PEDS"
"RTN","C0IMAP",380,0)
 S @G@(133,"altName",4)="PCV3 PEDS"
"RTN","C0IMAP",381,0)
 S @G@(133,"altName",5)="PCV4 PEDS"
"RTN","C0IMAP",382,0)
 S @G@(133,"preferredName")="Pneumococcal conjugate PCV 13"
"RTN","C0IMAP",383,0)
 S @G@(134,"CPT")=90738
"RTN","C0IMAP",384,0)
 S @G@(134,"CVXcode")=134
"RTN","C0IMAP",385,0)
 S @G@(134,"preferredName")="Japanese Encephalitis IM"
"RTN","C0IMAP",386,0)
 S @G@(135,"CPT")=90662
"RTN","C0IMAP",387,0)
 S @G@(135,"CVXcode")=135
"RTN","C0IMAP",388,0)
 S @G@(135,"preferredName")="Influenza, high dose seasonal"
"RTN","C0IMAP",389,0)
 S @G@(136,"CVXcode")=136
"RTN","C0IMAP",390,0)
 S @G@(136,"preferredName")="Meningococcal MCV4O"
"RTN","C0IMAP",391,0)
 S @G@(140,"CPT")=90656
"RTN","C0IMAP",392,0)
 S @G@(140,"CVXcode")=140
"RTN","C0IMAP",393,0)
 S @G@(140,"preferredName")="Influenza, seasonal, injectable, preservative free"
"RTN","C0IMAP",394,0)
 S @G@(141,"CPT")=90658
"RTN","C0IMAP",395,0)
 S @G@(141,"CVXcode")=141
"RTN","C0IMAP",396,0)
 S @G@(141,"altName",1)="FLU,3 YRS"
"RTN","C0IMAP",397,0)
 S @G@(141,"preferredName")="Influenza, seasonal, injectable"
"RTN","C0IMAP",398,0)
 S @G@(144,"CPT")=90654
"RTN","C0IMAP",399,0)
 S @G@(144,"CVXcode")=144
"RTN","C0IMAP",400,0)
 S @G@(144,"preferredName")="influenza, seasonal, intradermal, preservative free"
"RTN","C0IMAP",401,0)
 S @G@(148,"CPT")=90644
"RTN","C0IMAP",402,0)
 S @G@(148,"CVXcode")=148
"RTN","C0IMAP",403,0)
 S @G@(148,"preferredName")="Meningococcal C/Y-HIB PRP"
"RTN","C0IMAP",404,0)
 S @G@(149,"CPT")=90672
"RTN","C0IMAP",405,0)
 S @G@(149,"CVXcode")=149
"RTN","C0IMAP",406,0)
 S @G@(149,"preferredName")="influenza, live, intranasal, quadrivalent"
"RTN","C0IMAP",407,0)
 S @G@(150,"CPT")=90686
"RTN","C0IMAP",408,0)
 S @G@(150,"CVXcode")=150
"RTN","C0IMAP",409,0)
 S @G@(150,"preferredName")="influenza, injectable, quadrivalent, preservative free"
"RTN","C0IMAP",410,0)
 S @G@(153,"CPT")=90661
"RTN","C0IMAP",411,0)
 S @G@(153,"CVXcode")=153
"RTN","C0IMAP",412,0)
 S @G@(153,"preferredName")="Influenza, injectable, MDCK, preservative free"
"RTN","C0IMAP",413,0)
 S @G@(155,"CPT")=90673
"RTN","C0IMAP",414,0)
 S @G@(155,"CVXcode")=155
"RTN","C0IMAP",415,0)
 S @G@(155,"preferredName")="influenza, recombinant, injectable, preservative free"
"RTN","C0IMAP",416,0)
 S @G@(158,"CPT")=90688
"RTN","C0IMAP",417,0)
 S @G@(158,"CVXcode")=158
"RTN","C0IMAP",418,0)
 S @G@(158,"preferredName")="influenza, injectable, quadrivalent"
"RTN","C0IMAP",419,0)
 S @G@(999,"CPT")=90749
"RTN","C0IMAP",420,0)
 S @G@(999,"CVXcode")=999
"RTN","C0IMAP",421,0)
 S @G@(999,"preferredName")="unknown"
"RTN","C0IMAP",422,0)
 S @G@("B","ADENOVIRUS,TYPE 4",54)=""
"RTN","C0IMAP",423,0)
 S @G@("B","ADENOVIRUS,TYPE 7",55)=""
"RTN","C0IMAP",424,0)
 S @G@("B","ANTHRAX,SC",24)=""
"RTN","C0IMAP",425,0)
 S @G@("B","BCG",19)=""
"RTN","C0IMAP",426,0)
 S @G@("B","BCG,PERCUT",19)=""
"RTN","C0IMAP",427,0)
 S @G@("B","CHICKENPOX",21)=""
"RTN","C0IMAP",428,0)
 S @G@("B","CHOLERA",26)=""
"RTN","C0IMAP",429,0)
 S @G@("B","CHOLERA, ORAL",26)=""
"RTN","C0IMAP",430,0)
 S @G@("B","CMVIG",29)=""
"RTN","C0IMAP",431,0)
 S @G@("B","DIP,PERT,TET (DPT)",1)=""
"RTN","C0IMAP",432,0)
 S @G@("B","DIP,PERT,TET (DPT) PED 1",106)=""
"RTN","C0IMAP",433,0)
 S @G@("B","DIP,PERT,TET (DPT) PED 2",106)=""
"RTN","C0IMAP",434,0)
 S @G@("B","DIP,PERT,TET (DPT) PED 3",106)=""
"RTN","C0IMAP",435,0)
 S @G@("B","DIP,PERT,TET (DPT) PED 4",106)=""
"RTN","C0IMAP",436,0)
 S @G@("B","DIP,PERT,TET (DPT) PED 5",106)=""
"RTN","C0IMAP",437,0)
 S @G@("B","DIP-TET-a/PERT",106)=""
"RTN","C0IMAP",438,0)
 S @G@("B","DIP.,PERT.,TET. (DPT)",1)=""
"RTN","C0IMAP",439,0)
 S @G@("B","DIP.,PERT.,TET. (DPT) PED 1",20)=""
"RTN","C0IMAP",440,0)
 S @G@("B","DIP.,PERT.,TET. (DPT) PED 2",20)=""
"RTN","C0IMAP",441,0)
 S @G@("B","DIP.,PERT.,TET. (DPT) PED 3",20)=""
"RTN","C0IMAP",442,0)
 S @G@("B","DIP.,PERT.,TET. (DPT) PED 4",20)=""
"RTN","C0IMAP",443,0)
 S @G@("B","DIP.,PERT.,TET. (DPT) PED 5",20)=""
"RTN","C0IMAP",444,0)
 S @G@("B","DIPTHERIA-TETANUS (DT-PEDS)",28)=""
"RTN","C0IMAP",445,0)
 S @G@("B","DT (pediatric)",28)=""
"RTN","C0IMAP",446,0)
 S @G@("B","DTB/HIB",22)=""
"RTN","C0IMAP",447,0)
 S @G@("B","DTP",1)=""
"RTN","C0IMAP",448,0)
 S @G@("B","DTP-Hib",22)=""
"RTN","C0IMAP",449,0)
 S @G@("B","DTaP",20)=""
"RTN","C0IMAP",450,0)
 S @G@("B","DTaP, 5 pertussis antigens",106)=""
"RTN","C0IMAP",451,0)
 S @G@("B","DTaP-Hep B-IPV",110)=""
"RTN","C0IMAP",452,0)
 S @G@("B","DTaP-Hib",50)=""
"RTN","C0IMAP",453,0)
 S @G@("B","DTaP-Hib-IPV",120)=""
"RTN","C0IMAP",454,0)
 S @G@("B","DTaP-IPV",130)=""
"RTN","C0IMAP",455,0)
 S @G@("B","DTaP1",106)=""
"RTN","C0IMAP",456,0)
 S @G@("B","DTaP2",106)=""
"RTN","C0IMAP",457,0)
 S @G@("B","DTaP3",106)=""
"RTN","C0IMAP",458,0)
 S @G@("B","DTaP4",106)=""
"RTN","C0IMAP",459,0)
 S @G@("B","DTaP5",106)=""
"RTN","C0IMAP",460,0)
 S @G@("B","ENCEPHALITIS",39)=""
"RTN","C0IMAP",461,0)
 S @G@("B","FLU,3 YRS",141)=""
"RTN","C0IMAP",462,0)
 S @G@("B","FLU,NASAL",111)=""
"RTN","C0IMAP",463,0)
 S @G@("B","FLU,WHOLE",16)=""
"RTN","C0IMAP",464,0)
 S @G@("B","GAMMA GLOBULIN",14)=""
"RTN","C0IMAP",465,0)
 S @G@("B","HBIG",30)=""
"RTN","C0IMAP",466,0)
 S @G@("B","HEP A1 PEDS",83)=""
"RTN","C0IMAP",467,0)
 S @G@("B","HEP A2 PEDS",83)=""
"RTN","C0IMAP",468,0)
 S @G@("B","HEP A3 PEDS",84)=""
"RTN","C0IMAP",469,0)
 S @G@("B","HEP B PED/ADOL 3 DOSE",8)=""
"RTN","C0IMAP",470,0)
 S @G@("B","HEP B1 INFANT",42)=""
"RTN","C0IMAP",471,0)
 S @G@("B","HEP B2 INFANT",42)=""
"RTN","C0IMAP",472,0)
 S @G@("B","HEP B3 INFANT",42)=""
"RTN","C0IMAP",473,0)
 S @G@("B","HEP B4 INFANT",42)=""
"RTN","C0IMAP",474,0)
 S @G@("B","HEPA ADULT",52)=""
"RTN","C0IMAP",475,0)
 S @G@("B","HEPA,PED/ADOL-2",83)=""
"RTN","C0IMAP",476,0)
 S @G@("B","HEPA,PED/ADOL-3 DOSE",84)=""
"RTN","C0IMAP",477,0)
 S @G@("B","HEPA/HEPB ADULT",104)=""
"RTN","C0IMAP",478,0)
 S @G@("B","HEPATITIS A",85)=""
"RTN","C0IMAP",479,0)
 S @G@("B","HEPATITIS B",45)=""
"RTN","C0IMAP",480,0)
 S @G@("B","HEPB PED/ADOL-2",8)=""
"RTN","C0IMAP",481,0)
 S @G@("B","HEPB PED/ADOL-3",8)=""
"RTN","C0IMAP",482,0)
 S @G@("B","HEPB PED/ADOL-4",8)=""
"RTN","C0IMAP",483,0)
 S @G@("B","HEPB, ILL PAT",44)=""
"RTN","C0IMAP",484,0)
 S @G@("B","HEPB, PED/ADOL-1",8)=""
"RTN","C0IMAP",485,0)
 S @G@("B","HEPB/HIB",51)=""
"RTN","C0IMAP",486,0)
 S @G@("B","HIB PED 1",47)=""
"RTN","C0IMAP",487,0)
 S @G@("B","HIB PED 2",47)=""
"RTN","C0IMAP",488,0)
 S @G@("B","HIB PED 3",47)=""
"RTN","C0IMAP",489,0)
 S @G@("B","HIB PED 4",47)=""
"RTN","C0IMAP",490,0)
 S @G@("B","HIB,HBOC",47)=""
"RTN","C0IMAP",491,0)
 S @G@("B","HIB,PRP-D",46)=""
"RTN","C0IMAP",492,0)
 S @G@("B","HIB,PRP-OMP",49)=""
"RTN","C0IMAP",493,0)
 S @G@("B","HIB,PRP-T",48)=""
"RTN","C0IMAP",494,0)
 S @G@("B","HPV, bivalent",118)=""
"RTN","C0IMAP",495,0)
 S @G@("B","HPV, quadrivalent",62)=""
"RTN","C0IMAP",496,0)
 S @G@("B","Hep A, adult",52)=""
"RTN","C0IMAP",497,0)
 S @G@("B","Hep A, ped/adol, 2 dose",83)=""
"RTN","C0IMAP",498,0)
 S @G@("B","Hep A, ped/adol, 3 dose",84)=""
"RTN","C0IMAP",499,0)
 S @G@("B","Hep A, unspecified formulation",85)=""
"RTN","C0IMAP",500,0)
 S @G@("B","Hep A-Hep B",104)=""
"RTN","C0IMAP",501,0)
 S @G@("B","Hep B, adolescent or pediatric",8)=""
"RTN","C0IMAP",502,0)
 S @G@("B","Hep B, adolescent/high risk infant",42)=""
"RTN","C0IMAP",503,0)
 S @G@("B","Hep B, adult",43)=""
"RTN","C0IMAP",504,0)
 S @G@("B","Hep B, dialysis",44)=""
"RTN","C0IMAP",505,0)
 S @G@("B","Hep B, unspecified formulation",45)=""
"RTN","C0IMAP",506,0)
 S @G@("B","HiB1",49)=""
"RTN","C0IMAP",507,0)
 S @G@("B","HiB2",49)=""
"RTN","C0IMAP",508,0)
 S @G@("B","HiB3",49)=""
"RTN","C0IMAP",509,0)
 S @G@("B","Hib (HbOC)",47)=""
"RTN","C0IMAP",510,0)
 S @G@("B","Hib (PRP-D)",46)=""
"RTN","C0IMAP",511,0)
 S @G@("B","Hib (PRP-OMP)",49)=""
"RTN","C0IMAP",512,0)
 S @G@("B","Hib (PRP-T)",48)=""
"RTN","C0IMAP",513,0)
 S @G@("B","Hib, unspecified formulation",17)=""
"RTN","C0IMAP",514,0)
 S @G@("B","Hib-Hep B",51)=""
"RTN","C0IMAP",515,0)
 S @G@("B","IG",86)=""
"RTN","C0IMAP",516,0)
 S @G@("B","IG, unspecified formulation",14)=""
"RTN","C0IMAP",517,0)
 S @G@("B","IGIV",87)=""
"RTN","C0IMAP",518,0)
 S @G@("B","INFLUENZA",88)=""
"RTN","C0IMAP",519,0)
 S @G@("B","INFLUENZA B",17)=""
"RTN","C0IMAP",520,0)
 S @G@("B","IPV",10)=""
"RTN","C0IMAP",521,0)
 S @G@("B","IPV1",10)=""
"RTN","C0IMAP",522,0)
 S @G@("B","IPV2",10)=""
"RTN","C0IMAP",523,0)
 S @G@("B","IPV3",10)=""
"RTN","C0IMAP",524,0)
 S @G@("B","IPV4",10)=""
"RTN","C0IMAP",525,0)
 S @G@("B","Influenza, high dose seasonal",135)=""
"RTN","C0IMAP",526,0)
 S @G@("B","Influenza, injectable, MDCK, preservative free",153)=""
"RTN","C0IMAP",527,0)
 S @G@("B","Influenza, seasonal, injectable",141)=""
"RTN","C0IMAP",528,0)
 S @G@("B","Influenza, seasonal, injectable, preservative free",140)=""
"RTN","C0IMAP",529,0)
 S @G@("B","Japanese Encephalitis IM",134)=""
"RTN","C0IMAP",530,0)
 S @G@("B","Japanese encephalitis SC",39)=""
"RTN","C0IMAP",531,0)
 S @G@("B","LYME DISEASE",66)=""
"RTN","C0IMAP",532,0)
 S @G@("B","Lyme disease",66)=""
"RTN","C0IMAP",533,0)
 S @G@("B","M/R",4)=""
"RTN","C0IMAP",534,0)
 S @G@("B","MEA-MUMPS-RUB-VARCELLA",94)=""
"RTN","C0IMAP",535,0)
 S @G@("B","MEASLES",5)=""
"RTN","C0IMAP",536,0)
 S @G@("B","MEASLES,MUMPS,RUBELLA (MMR)",3)=""
"RTN","C0IMAP",537,0)
 S @G@("B","MEASLES,MUMPS,RUBELLA PED #1",3)=""
"RTN","C0IMAP",538,0)
 S @G@("B","MEASLES,MUMPS,RUBELLA PED #2",3)=""
"RTN","C0IMAP",539,0)
 S @G@("B","MEASLES,RUBELLA (MR)",4)=""
"RTN","C0IMAP",540,0)
 S @G@("B","MENINGOCOCCAL",32)=""
"RTN","C0IMAP",541,0)
 S @G@("B","MMR",3)=""
"RTN","C0IMAP",542,0)
 S @G@("B","MMR1",3)=""
"RTN","C0IMAP",543,0)
 S @G@("B","MMRV",94)=""
"RTN","C0IMAP",544,0)
 S @G@("B","MUMPS",7)=""
"RTN","C0IMAP",545,0)
 S @G@("B","Meningococcal C/Y-HIB PRP",148)=""
"RTN","C0IMAP",546,0)
 S @G@("B","Meningococcal MCV4O",136)=""
"RTN","C0IMAP",547,0)
 S @G@("B","Novel Influenza-H1N1-09, all formulations",128)=""
"RTN","C0IMAP",548,0)
 S @G@("B","Novel Influenza-H1N1-09, nasal",125)=""
"RTN","C0IMAP",549,0)
 S @G@("B","Novel influenza-H1N1-09",127)=""
"RTN","C0IMAP",550,0)
 S @G@("B","Novel influenza-H1N1-09, preservative-free",126)=""
"RTN","C0IMAP",551,0)
 S @G@("B","OPV",2)=""
"RTN","C0IMAP",552,0)
 S @G@("B","ORAL POLIOVIRUS",2)=""
"RTN","C0IMAP",553,0)
 S @G@("B","PCV1 PEDS",133)=""
"RTN","C0IMAP",554,0)
 S @G@("B","PCV2 PEDS",133)=""
"RTN","C0IMAP",555,0)
 S @G@("B","PCV3 PEDS",133)=""
"RTN","C0IMAP",556,0)
 S @G@("B","PCV4 PEDS",133)=""
"RTN","C0IMAP",557,0)
 S @G@("B","PCV5 PEDS",133)=""
"RTN","C0IMAP",558,0)
 S @G@("B","PLAGUE",23)=""
"RTN","C0IMAP",559,0)
 S @G@("B","PNEUMOCOCCAL",33)=""
"RTN","C0IMAP",560,0)
 S @G@("B","PNEUMOCOCCAL PED 1",100)=""
"RTN","C0IMAP",561,0)
 S @G@("B","PNEUMOCOCCAL PED 2",100)=""
"RTN","C0IMAP",562,0)
 S @G@("B","PNEUMOCOCCAL PED 3",100)=""
"RTN","C0IMAP",563,0)
 S @G@("B","PNEUMOCOCCAL PED 4",100)=""
"RTN","C0IMAP",564,0)
 S @G@("B","PNEUMOCOCCAL,PED",100)=""
"RTN","C0IMAP",565,0)
 S @G@("B","PNEUMOVAX",33)=""
"RTN","C0IMAP",566,0)
 S @G@("B","POLIOVIRUS PED #1",10)=""
"RTN","C0IMAP",567,0)
 S @G@("B","POLIOVIRUS PED #2",10)=""
"RTN","C0IMAP",568,0)
 S @G@("B","POLIOVIRUS PED #3",10)=""
"RTN","C0IMAP",569,0)
 S @G@("B","POLIOVIRUS PED #4",10)=""
"RTN","C0IMAP",570,0)
 S @G@("B","Pneumococcal conjugate PCV 13",133)=""
"RTN","C0IMAP",571,0)
 S @G@("B","RABIES",90)=""
"RTN","C0IMAP",572,0)
 S @G@("B","RABIES,ID",40)=""
"RTN","C0IMAP",573,0)
 S @G@("B","RABIES,IM",18)=""
"RTN","C0IMAP",574,0)
 S @G@("B","RIG",34)=""
"RTN","C0IMAP",575,0)
 S @G@("B","ROTOVIRUS,ORAL",116)=""
"RTN","C0IMAP",576,0)
 S @G@("B","RSV-IGIV",71)=""
"RTN","C0IMAP",577,0)
 S @G@("B","RSV-MAb",93)=""
"RTN","C0IMAP",578,0)
 S @G@("B","RUBELLA",6)=""
"RTN","C0IMAP",579,0)
 S @G@("B","RUBELLA, MUMPS",38)=""
"RTN","C0IMAP",580,0)
 S @G@("B","RV 1 PEDS",116)=""
"RTN","C0IMAP",581,0)
 S @G@("B","RV 2 PEDS",116)=""
"RTN","C0IMAP",582,0)
 S @G@("B","RV 3 PEDS",116)=""
"RTN","C0IMAP",583,0)
 S @G@("B","RV 4 PEDS",116)=""
"RTN","C0IMAP",584,0)
 S @G@("B","SMALLPOX",75)=""
"RTN","C0IMAP",585,0)
 S @G@("B","SWINE FLU BIVAL",43)=""
"RTN","C0IMAP",586,0)
 S @G@("B","TETANUS DIPTHERIA (TD-ADULT)",9)=""
"RTN","C0IMAP",587,0)
 S @G@("B","TETANUS TOXOID",35)=""
"RTN","C0IMAP",588,0)
 S @G@("B","TETANUS, DIPTHERIA AND PERTUSSIS",115)=""
"RTN","C0IMAP",589,0)
 S @G@("B","TIG",13)=""
"RTN","C0IMAP",590,0)
 S @G@("B","TYPHOID",91)=""
"RTN","C0IMAP",591,0)
 S @G@("B","TYPHOID",101)=""
"RTN","C0IMAP",592,0)
 S @G@("B","TYPHOID,AKD,SC",53)=""
"RTN","C0IMAP",593,0)
 S @G@("B","TYPHOID,H-P,SC/ID",41)=""
"RTN","C0IMAP",594,0)
 S @G@("B","TYPHOID,ORAL",25)=""
"RTN","C0IMAP",595,0)
 S @G@("B","TYPHUS",131)=""
"RTN","C0IMAP",596,0)
 S @G@("B","Td (adult) preservative free",113)=""
"RTN","C0IMAP",597,0)
 S @G@("B","Td (adult), adsorbed",9)=""
"RTN","C0IMAP",598,0)
 S @G@("B","Tdap",115)=""
"RTN","C0IMAP",599,0)
 S @G@("B","VZIG",36)=""
"RTN","C0IMAP",600,0)
 S @G@("B","VZV1 INFANT",21)=""
"RTN","C0IMAP",601,0)
 S @G@("B","VZV2 INFANT",21)=""
"RTN","C0IMAP",602,0)
 S @G@("B","YELLOW FEVER",37)=""
"RTN","C0IMAP",603,0)
 S @G@("B","adenovirus, type 4",54)=""
"RTN","C0IMAP",604,0)
 S @G@("B","adenovirus, type 7",55)=""
"RTN","C0IMAP",605,0)
 S @G@("B","anthrax",24)=""
"RTN","C0IMAP",606,0)
 S @G@("B","botulinum antitoxin",27)=""
"RTN","C0IMAP",607,0)
 S @G@("B","cholera",26)=""
"RTN","C0IMAP",608,0)
 S @G@("B","diphtheria antitoxin",12)=""
"RTN","C0IMAP",609,0)
 S @G@("B","influenza, injectable, quadrivalent",158)=""
"RTN","C0IMAP",610,0)
 S @G@("B","influenza, injectable, quadrivalent, preservative free",150)=""
"RTN","C0IMAP",611,0)
 S @G@("B","influenza, live, intranasal",111)=""
"RTN","C0IMAP",612,0)
 S @G@("B","influenza, live, intranasal, quadrivalent",149)=""
"RTN","C0IMAP",613,0)
 S @G@("B","influenza, recombinant, injectable, preservative free",155)=""
"RTN","C0IMAP",614,0)
 S @G@("B","influenza, seasonal, intradermal, preservative free",144)=""
"RTN","C0IMAP",615,0)
 S @G@("B","influenza, unspecified formulation",88)=""
"RTN","C0IMAP",616,0)
 S @G@("B","influenza, whole",16)=""
"RTN","C0IMAP",617,0)
 S @G@("B","measles",5)=""
"RTN","C0IMAP",618,0)
 S @G@("B","meningococcal MCV4P",114)=""
"RTN","C0IMAP",619,0)
 S @G@("B","meningococcal MPSV4",32)=""
"RTN","C0IMAP",620,0)
 S @G@("B","mumps",7)=""
"RTN","C0IMAP",621,0)
 S @G@("B","plague",23)=""
"RTN","C0IMAP",622,0)
 S @G@("B","pneumococcal conjugate PCV 7",100)=""
"RTN","C0IMAP",623,0)
 S @G@("B","pneumococcal polysaccharide PPV23",33)=""
"RTN","C0IMAP",624,0)
 S @G@("B","rabies, intradermal injection",40)=""
"RTN","C0IMAP",625,0)
 S @G@("B","rabies, intramuscular injection",18)=""
"RTN","C0IMAP",626,0)
 S @G@("B","rabies, unspecified formulation",90)=""
"RTN","C0IMAP",627,0)
 S @G@("B","rotavirus, monovalent",119)=""
"RTN","C0IMAP",628,0)
 S @G@("B","rotavirus, pentavalent",116)=""
"RTN","C0IMAP",629,0)
 S @G@("B","rubella",6)=""
"RTN","C0IMAP",630,0)
 S @G@("B","tetanus toxoid, adsorbed",35)=""
"RTN","C0IMAP",631,0)
 S @G@("B","typhoid, ViCPs",101)=""
"RTN","C0IMAP",632,0)
 S @G@("B","typhoid, oral",25)=""
"RTN","C0IMAP",633,0)
 S @G@("B","typhoid, parenteral",41)=""
"RTN","C0IMAP",634,0)
 S @G@("B","typhoid, parenteral, AKD (U.S. military)",53)=""
"RTN","C0IMAP",635,0)
 S @G@("B","typhoid, unspecified formulation",91)=""
"RTN","C0IMAP",636,0)
 S @G@("B","unknown",999)=""
"RTN","C0IMAP",637,0)
 S @G@("B","vaccinia immune globulin",79)=""
"RTN","C0IMAP",638,0)
 S @G@("B","varicella",21)=""
"RTN","C0IMAP",639,0)
 S @G@("B","yellow fever",37)=""
"RTN","C0IMAP",640,0)
 S @G@("B","zoster",121)=""
"RTN","C0IMAP",641,0)
 S @G@("CPT",90281,86)=""
"RTN","C0IMAP",642,0)
 S @G@("CPT",90283,87)=""
"RTN","C0IMAP",643,0)
 S @G@("CPT",90287,27)=""
"RTN","C0IMAP",644,0)
 S @G@("CPT",90291,29)=""
"RTN","C0IMAP",645,0)
 S @G@("CPT",90296,12)=""
"RTN","C0IMAP",646,0)
 S @G@("CPT",90371,30)=""
"RTN","C0IMAP",647,0)
 S @G@("CPT",90375,34)=""
"RTN","C0IMAP",648,0)
 S @G@("CPT",90376,34)=""
"RTN","C0IMAP",649,0)
 S @G@("CPT",90378,93)=""
"RTN","C0IMAP",650,0)
 S @G@("CPT",90379,71)=""
"RTN","C0IMAP",651,0)
 S @G@("CPT",90389,13)=""
"RTN","C0IMAP",652,0)
 S @G@("CPT",90393,79)=""
"RTN","C0IMAP",653,0)
 S @G@("CPT",90396,36)=""
"RTN","C0IMAP",654,0)
 S @G@("CPT",90470,128)=""
"RTN","C0IMAP",655,0)
 S @G@("CPT",90476,54)=""
"RTN","C0IMAP",656,0)
 S @G@("CPT",90477,55)=""
"RTN","C0IMAP",657,0)
 S @G@("CPT",90581,24)=""
"RTN","C0IMAP",658,0)
 S @G@("CPT",90585,19)=""
"RTN","C0IMAP",659,0)
 S @G@("CPT",90632,52)=""
"RTN","C0IMAP",660,0)
 S @G@("CPT",90633,83)=""
"RTN","C0IMAP",661,0)
 S @G@("CPT",90634,84)=""
"RTN","C0IMAP",662,0)
 S @G@("CPT",90636,104)=""
"RTN","C0IMAP",663,0)
 S @G@("CPT",90644,148)=""
"RTN","C0IMAP",664,0)
 S @G@("CPT",90645,47)=""
"RTN","C0IMAP",665,0)
 S @G@("CPT",90646,46)=""
"RTN","C0IMAP",666,0)
 S @G@("CPT",90647,49)=""
"RTN","C0IMAP",667,0)
 S @G@("CPT",90648,48)=""
"RTN","C0IMAP",668,0)
 S @G@("CPT",90649,62)=""
"RTN","C0IMAP",669,0)
 S @G@("CPT",90650,118)=""
"RTN","C0IMAP",670,0)
 S @G@("CPT",90654,144)=""
"RTN","C0IMAP",671,0)
 S @G@("CPT",90655,140)=""
"RTN","C0IMAP",672,0)
 S @G@("CPT",90656,140)=""
"RTN","C0IMAP",673,0)
 S @G@("CPT",90657,141)=""
"RTN","C0IMAP",674,0)
 S @G@("CPT",90658,141)=""
"RTN","C0IMAP",675,0)
 S @G@("CPT",90659,16)=""
"RTN","C0IMAP",676,0)
 S @G@("CPT",90660,111)=""
"RTN","C0IMAP",677,0)
 S @G@("CPT",90661,153)=""
"RTN","C0IMAP",678,0)
 S @G@("CPT",90662,135)=""
"RTN","C0IMAP",679,0)
 S @G@("CPT",90663,128)=""
"RTN","C0IMAP",680,0)
 S @G@("CPT",90664,125)=""
"RTN","C0IMAP",681,0)
 S @G@("CPT",90665,66)=""
"RTN","C0IMAP",682,0)
 S @G@("CPT",90666,126)=""
"RTN","C0IMAP",683,0)
 S @G@("CPT",90668,127)=""
"RTN","C0IMAP",684,0)
 S @G@("CPT",90669,100)=""
"RTN","C0IMAP",685,0)
 S @G@("CPT",90670,133)=""
"RTN","C0IMAP",686,0)
 S @G@("CPT",90672,149)=""
"RTN","C0IMAP",687,0)
 S @G@("CPT",90673,155)=""
"RTN","C0IMAP",688,0)
 S @G@("CPT",90675,18)=""
"RTN","C0IMAP",689,0)
 S @G@("CPT",90676,40)=""
"RTN","C0IMAP",690,0)
 S @G@("CPT",90680,116)=""
"RTN","C0IMAP",691,0)
 S @G@("CPT",90681,119)=""
"RTN","C0IMAP",692,0)
 S @G@("CPT",90685,150)=""
"RTN","C0IMAP",693,0)
 S @G@("CPT",90686,150)=""
"RTN","C0IMAP",694,0)
 S @G@("CPT",90688,158)=""
"RTN","C0IMAP",695,0)
 S @G@("CPT",90690,25)=""
"RTN","C0IMAP",696,0)
 S @G@("CPT",90691,101)=""
"RTN","C0IMAP",697,0)
 S @G@("CPT",90692,41)=""
"RTN","C0IMAP",698,0)
 S @G@("CPT",90693,53)=""
"RTN","C0IMAP",699,0)
 S @G@("CPT",90696,130)=""
"RTN","C0IMAP",700,0)
 S @G@("CPT",90698,120)=""
"RTN","C0IMAP",701,0)
 S @G@("CPT",90700,106)=""
"RTN","C0IMAP",702,0)
 S @G@("CPT",90701,1)=""
"RTN","C0IMAP",703,0)
 S @G@("CPT",90702,28)=""
"RTN","C0IMAP",704,0)
 S @G@("CPT",90703,35)=""
"RTN","C0IMAP",705,0)
 S @G@("CPT",90704,7)=""
"RTN","C0IMAP",706,0)
 S @G@("CPT",90705,5)=""
"RTN","C0IMAP",707,0)
 S @G@("CPT",90706,6)=""
"RTN","C0IMAP",708,0)
 S @G@("CPT",90707,3)=""
"RTN","C0IMAP",709,0)
 S @G@("CPT",90708,4)=""
"RTN","C0IMAP",710,0)
 S @G@("CPT",90710,94)=""
"RTN","C0IMAP",711,0)
 S @G@("CPT",90712,2)=""
"RTN","C0IMAP",712,0)
 S @G@("CPT",90713,10)=""
"RTN","C0IMAP",713,0)
 S @G@("CPT",90714,91)=""
"RTN","C0IMAP",714,0)
 S @G@("CPT",90715,115)=""
"RTN","C0IMAP",715,0)
 S @G@("CPT",90716,21)=""
"RTN","C0IMAP",716,0)
 S @G@("CPT",90717,37)=""
"RTN","C0IMAP",717,0)
 S @G@("CPT",90718,9)=""
"RTN","C0IMAP",718,0)
 S @G@("CPT",90720,22)=""
"RTN","C0IMAP",719,0)
 S @G@("CPT",90721,50)=""
"RTN","C0IMAP",720,0)
 S @G@("CPT",90723,110)=""
"RTN","C0IMAP",721,0)
 S @G@("CPT",90724,88)=""
"RTN","C0IMAP",722,0)
 S @G@("CPT",90725,26)=""
"RTN","C0IMAP",723,0)
 S @G@("CPT",90726,90)=""
"RTN","C0IMAP",724,0)
 S @G@("CPT",90727,23)=""
"RTN","C0IMAP",725,0)
 S @G@("CPT",90728,19)=""
"RTN","C0IMAP",726,0)
 S @G@("CPT",90730,85)=""
"RTN","C0IMAP",727,0)
 S @G@("CPT",90731,45)=""
"RTN","C0IMAP",728,0)
 S @G@("CPT",90732,33)=""
"RTN","C0IMAP",729,0)
 S @G@("CPT",90733,32)=""
"RTN","C0IMAP",730,0)
 S @G@("CPT",90734,114)=""
"RTN","C0IMAP",731,0)
 S @G@("CPT",90735,39)=""
"RTN","C0IMAP",732,0)
 S @G@("CPT",90736,121)=""
"RTN","C0IMAP",733,0)
 S @G@("CPT",90737,17)=""
"RTN","C0IMAP",734,0)
 S @G@("CPT",90738,134)=""
"RTN","C0IMAP",735,0)
 S @G@("CPT",90740,44)=""
"RTN","C0IMAP",736,0)
 S @G@("CPT",90741,14)=""
"RTN","C0IMAP",737,0)
 S @G@("CPT",90743,43)=""
"RTN","C0IMAP",738,0)
 S @G@("CPT",90744,8)=""
"RTN","C0IMAP",739,0)
 S @G@("CPT",90745,42)=""
"RTN","C0IMAP",740,0)
 S @G@("CPT",90746,43)=""
"RTN","C0IMAP",741,0)
 S @G@("CPT",90747,44)=""
"RTN","C0IMAP",742,0)
 S @G@("CPT",90748,51)=""
"RTN","C0IMAP",743,0)
 S @G@("CPT",90749,999)=""
"RTN","C0IMAP",744,0)
 Q
"RTN","C0IMAP",745,0)
 ;
"RTN","C0IORMAP")
0^10^B7763780
"RTN","C0IORMAP",1,0)
C0IORMAP  ;
"RTN","C0IORMAP",2,0)
; Pull information re CPT and CVX codes from dEWDrop;;;;;Build 1
"RTN","C0IORMAP",3,0)
 D CPTMAP
"RTN","C0IORMAP",4,0)
 D CVXMAP
"RTN","C0IORMAP",5,0)
 ;D CPTIMAP^C0ITEST
"RTN","C0IORMAP",6,0)
 N IMMCPT,IMMCVX,CVXTXT,X,IMMIEN,I
"RTN","C0IORMAP",7,0)
 S (IMMCPT,IMMCVX,CVXTXT,X,IMMIEN,I)=""
"RTN","C0IORMAP",8,0)
 F I=1:1:141 D
"RTN","C0IORMAP",9,0)
 .;if there is an entry in the CPT Mapping file that is for an Immunization
"RTN","C0IORMAP",10,0)
 .I $P(^PXD(811.1,I,0),U,2)["AUTTIMM" D
"RTN","C0IORMAP",11,0)
 ..;Pick the CPT code out of the file  
"RTN","C0IORMAP",12,0)
 ..S IMMCPT=$P($P(^PXD(811.1,I,0),U,1),";",1)
"RTN","C0IORMAP",13,0)
 ..W I," CPT Code is ",IMMCPT,!  
"RTN","C0IORMAP",14,0)
 ..;If there is a match to an immunization
"RTN","C0IORMAP",15,0)
 ..I $D(CPTMAP(IMMCPT)) D
"RTN","C0IORMAP",16,0)
 ...S IMMCVX=CPTMAP(IMMCPT)
"RTN","C0IORMAP",17,0)
 ...W I," CVX Code is ",IMMCVX,!
"RTN","C0IORMAP",18,0)
 ...I $D(CVXMAP(IMMCVX)) D
"RTN","C0IORMAP",19,0)
 ...S CVXTXT=CVXMAP(IMMCVX)
"RTN","C0IORMAP",20,0)
 ...W I," CVX Text is ",CVXTXT,!
"RTN","C0IORMAP",21,0)
 ...S X=$P(^PXD(811.1,I,0),U,2) 
"RTN","C0IORMAP",22,0)
 ...I $D(X) D
"RTN","C0IORMAP",23,0)
 ....S IMMIEN=$P($P(^PXD(811.1,I,0),U,2),";",1)
"RTN","C0IORMAP",24,0)
 ....W I," IEN of the Immunization is ",IMMIEN,! 
"RTN","C0IORMAP",25,0)
 ....;VOID-IEN of CPT Mapping File;CPT Code;Immunization file Name for the immunization; Short name from Immunization file;CVX Code;proper CVX code sho$
"RTN","C0IORMAP",26,0)
 ....;S NANCY(I)=I_";"_$P($P(^PXD(811.1,I,0),U,1),";",1)_";"_$P(^AUTTIMM(IMMIEN,0),U,1)_";"_$P(^AUTTIMM(IMMIEN,0),U,2)_";"_IMMCVX_";"_CVXTXT_";"
"RTN","C0IORMAP",27,0)
 ....;IEN of CPT Mapping File;Immunization File IEN;Immunization file Name for the immunization; Short name from Immunization file;CPT Code;CVX Code;pr$
"RTN","C0IORMAP",28,0)
 ....S NANCY(I)=I_";"_IMMIEN_";"_$P(^AUTTIMM(IMMIEN,0),U,1)_";"_$P(^AUTTIMM(IMMIEN,0),U,2)_";"_$P($P(^PXD(811.1,I,0),U,1),";",1)_";"_IMMCVX_";"_CVXTXT
"RTN","C0IORMAP",29,0)
 ....W NANCY(I),!
"RTN","C0IORMAP",30,0)
 ....S NANCY1(I)=IMMIEN
"RTN","C0IORMAP",31,0)
 ....W NANCY1(I),!
"RTN","C0IORMAP",32,0)
 ; F I=1:1:131 D  
"RTN","C0IORMAP",33,0)
 ;.; if there is an entry in the CPT mapping file corrensponding to this imminization, QUIT
"RTN","C0IORMAP",34,0)
 Q
"RTN","C0IORMAP",35,0)
 ;
"RTN","C0IORMAP",36,0)
COUNT ; count usage of immunizations
"RTN","C0IORMAP",37,0)
 N ZI,ZJ
"RTN","C0IORMAP",38,0)
 S (ZI,ZJ)=""
"RTN","C0IORMAP",39,0)
 K C0ITBL
"RTN","C0IORMAP",40,0)
 F  S ZI=$O(^AUPNVIMM("B",ZI)) Q:ZI=""  D  ;
"RTN","C0IORMAP",41,0)
 . S ZJ=""
"RTN","C0IORMAP",42,0)
 . F  S ZJ=$O(^AUPNVIMM("B",ZI,ZJ)) Q:ZJ=""  D  ;
"RTN","C0IORMAP",43,0)
 . . N IMM
"RTN","C0IORMAP",44,0)
 . . S IMM=$P(^AUTTIMM(ZI,0),"^",1)
"RTN","C0IORMAP",45,0)
 . . S C0ITBL(ZI,IMM)=$G(C0ITBL(ZI,IMM))+1
"RTN","C0IORMAP",46,0)
 ZWR C0ITBL
"RTN","C0IORMAP",47,0)
 F  S ZI=$O(C0ITBL(ZI)) Q:ZI=""  D  ;
"RTN","C0IORMAP",48,0)
 . S ZJ=$O(C0ITBL(ZI,""))
"RTN","C0IORMAP",49,0)
 . S CNT=C0ITBL(ZI,ZJ)
"RTN","C0IORMAP",50,0)
 . S C0ICNT(CNT,ZI)=ZJ
"RTN","C0IORMAP",51,0)
 ZWR C0ICNT
"RTN","C0IORMAP",52,0)
 Q
"RTN","C0IORMAP",53,0)
 ;
"RTN","C0IORMAP",54,0)
CPTMAP
"RTN","C0IORMAP",55,0)
 S CPTMAP(90281)=86
"RTN","C0IORMAP",56,0)
 S CPTMAP(90283)=87
"RTN","C0IORMAP",57,0)
 S CPTMAP(90287)=27
"RTN","C0IORMAP",58,0)
 S CPTMAP(90291)=29
"RTN","C0IORMAP",59,0)
 S CPTMAP(90296)=12
"RTN","C0IORMAP",60,0)
 S CPTMAP(90371)=30
"RTN","C0IORMAP",61,0)
 S CPTMAP(90375)=34
"RTN","C0IORMAP",62,0)
 S CPTMAP(90376)=34
"RTN","C0IORMAP",63,0)
 S CPTMAP(90378)=93
"RTN","C0IORMAP",64,0)
 S CPTMAP(90379)=71
"RTN","C0IORMAP",65,0)
 S CPTMAP(90389)=13
"RTN","C0IORMAP",66,0)
 S CPTMAP(90393)=79
"RTN","C0IORMAP",67,0)
 S CPTMAP(90396)=36
"RTN","C0IORMAP",68,0)
 S CPTMAP(90470)=128
"RTN","C0IORMAP",69,0)
 S CPTMAP(90476)=54
"RTN","C0IORMAP",70,0)
 S CPTMAP(90477)=55
"RTN","C0IORMAP",71,0)
 S CPTMAP(90581)=24
"RTN","C0IORMAP",72,0)
 S CPTMAP(90585)=19
"RTN","C0IORMAP",73,0)
 S CPTMAP(90632)=52
"RTN","C0IORMAP",74,0)
 S CPTMAP(90633)=83
"RTN","C0IORMAP",75,0)
 S CPTMAP(90634)=84
"RTN","C0IORMAP",76,0)
 S CPTMAP(90636)=104
"RTN","C0IORMAP",77,0)
 S CPTMAP(90644)=148
"RTN","C0IORMAP",78,0)
 S CPTMAP(90645)=47
"RTN","C0IORMAP",79,0)
 S CPTMAP(90646)=46
"RTN","C0IORMAP",80,0)
 S CPTMAP(90647)=49
"RTN","C0IORMAP",81,0)
 S CPTMAP(90648)=48
"RTN","C0IORMAP",82,0)
 S CPTMAP(90649)=62
"RTN","C0IORMAP",83,0)
 S CPTMAP(90650)=118
"RTN","C0IORMAP",84,0)
 S CPTMAP(90654)=144
"RTN","C0IORMAP",85,0)
 S CPTMAP(90655)=140
"RTN","C0IORMAP",86,0)
 S CPTMAP(90656)=140
"RTN","C0IORMAP",87,0)
 S CPTMAP(90657)=141
"RTN","C0IORMAP",88,0)
 S CPTMAP(90658)=141
"RTN","C0IORMAP",89,0)
 S CPTMAP(90659)=16
"RTN","C0IORMAP",90,0)
 S CPTMAP(90660)=111
"RTN","C0IORMAP",91,0)
 S CPTMAP(90661)=153
"RTN","C0IORMAP",92,0)
 S CPTMAP(90662)=135
"RTN","C0IORMAP",93,0)
 S CPTMAP(90663)=128
"RTN","C0IORMAP",94,0)
 S CPTMAP(90664)=125
"RTN","C0IORMAP",95,0)
 S CPTMAP(90665)=66
"RTN","C0IORMAP",96,0)
 S CPTMAP(90666)=126
"RTN","C0IORMAP",97,0)
 S CPTMAP(90668)=127
"RTN","C0IORMAP",98,0)
 S CPTMAP(90669)=100
"RTN","C0IORMAP",99,0)
 S CPTMAP(90670)=133
"RTN","C0IORMAP",100,0)
 S CPTMAP(90672)=149
"RTN","C0IORMAP",101,0)
 S CPTMAP(90673)=155
"RTN","C0IORMAP",102,0)
 S CPTMAP(90675)=18
"RTN","C0IORMAP",103,0)
 S CPTMAP(90676)=40
"RTN","C0IORMAP",104,0)
 S CPTMAP(90680)=116
"RTN","C0IORMAP",105,0)
 S CPTMAP(90681)=119
"RTN","C0IORMAP",106,0)
 S CPTMAP(90685)=150
"RTN","C0IORMAP",107,0)
 S CPTMAP(90686)=150
"RTN","C0IORMAP",108,0)
 S CPTMAP(90688)=158
"RTN","C0IORMAP",109,0)
 S CPTMAP(90690)=25
"RTN","C0IORMAP",110,0)
 S CPTMAP(90691)=101
"RTN","C0IORMAP",111,0)
 S CPTMAP(90692)=41
"RTN","C0IORMAP",112,0)
 S CPTMAP(90693)=53
"RTN","C0IORMAP",113,0)
 S CPTMAP(90696)=130
"RTN","C0IORMAP",114,0)
 S CPTMAP(90698)=120
"RTN","C0IORMAP",115,0)
 S CPTMAP(90700)=20
"RTN","C0IORMAP",116,0)
 S CPTMAP(90700)=106
"RTN","C0IORMAP",117,0)
 S CPTMAP(90701)=01
"RTN","C0IORMAP",118,0)
 S CPTMAP(90702)=28
"RTN","C0IORMAP",119,0)
 S CPTMAP(90703)=35
"RTN","C0IORMAP",120,0)
 S CPTMAP(90704)=07
"RTN","C0IORMAP",121,0)
 S CPTMAP(90705)=05
"RTN","C0IORMAP",122,0)
 S CPTMAP(90706)=06
"RTN","C0IORMAP",123,0)
 S CPTMAP(90707)=03
"RTN","C0IORMAP",124,0)
 S CPTMAP(90708)=04
"RTN","C0IORMAP",125,0)
 S CPTMAP(90710)=94
"RTN","C0IORMAP",126,0)
 S CPTMAP(90712)=02
"RTN","C0IORMAP",127,0)
 S CPTMAP(90713)=10
"RTN","C0IORMAP",128,0)
 S CPTMAP(90714)=113
"RTN","C0IORMAP",129,0)
 S CPTMAP(90714)=91
"RTN","C0IORMAP",130,0)
 S CPTMAP(90715)=115
"RTN","C0IORMAP",131,0)
 S CPTMAP(90716)=21
"RTN","C0IORMAP",132,0)
 S CPTMAP(90717)=37
"RTN","C0IORMAP",133,0)
 S CPTMAP(90718)=09
"RTN","C0IORMAP",134,0)
 S CPTMAP(90720)=22
"RTN","C0IORMAP",135,0)
 S CPTMAP(90721)=50
"RTN","C0IORMAP",136,0)
 S CPTMAP(90723)=110
"RTN","C0IORMAP",137,0)
 S CPTMAP(90724)=88
"RTN","C0IORMAP",138,0)
 S CPTMAP(90725)=26
"RTN","C0IORMAP",139,0)
 S CPTMAP(90726)=90
"RTN","C0IORMAP",140,0)
 S CPTMAP(90727)=23
"RTN","C0IORMAP",141,0)
 S CPTMAP(90728)=19
"RTN","C0IORMAP",142,0)
 S CPTMAP(90730)=85
"RTN","C0IORMAP",143,0)
 S CPTMAP(90731)=45
"RTN","C0IORMAP",144,0)
 S CPTMAP(90732)=33
"RTN","C0IORMAP",145,0)
 S CPTMAP(90733)=32
"RTN","C0IORMAP",146,0)
 S CPTMAP(90734)=136
"RTN","C0IORMAP",147,0)
 S CPTMAP(90734)=114
"RTN","C0IORMAP",148,0)
 S CPTMAP(90735)=39
"RTN","C0IORMAP",149,0)
 S CPTMAP(90736)=121
"RTN","C0IORMAP",150,0)
 S CPTMAP(90737)=17
"RTN","C0IORMAP",151,0)
 S CPTMAP(90738)=134
"RTN","C0IORMAP",152,0)
 S CPTMAP(90740)=44
"RTN","C0IORMAP",153,0)
 S CPTMAP(90741)=14
"RTN","C0IORMAP",154,0)
 S CPTMAP(90743)=43
"RTN","C0IORMAP",155,0)
 S CPTMAP(90744)=08
"RTN","C0IORMAP",156,0)
 S CPTMAP(90745)=42
"RTN","C0IORMAP",157,0)
 S CPTMAP(90746)=43
"RTN","C0IORMAP",158,0)
 S CPTMAP(90747)=44
"RTN","C0IORMAP",159,0)
 S CPTMAP(90748)=51  
"RTN","C0IORMAP",160,0)
 Q
"RTN","C0IORMAP",161,0)
CVXMAP
"RTN","C0IORMAP",162,0)
 S CVXMAP(86)="IG"
"RTN","C0IORMAP",163,0)
 S CVXMAP(87)="IGIV"
"RTN","C0IORMAP",164,0)
 S CVXMAP(27)="botulinum antitoxin"
"RTN","C0IORMAP",165,0)
 S CVXMAP(29)="CMVIG"
"RTN","C0IORMAP",166,0)
 S CVXMAP(12)="diphtheria antitoxin"
"RTN","C0IORMAP",167,0)
 S CVXMAP(30)="HBIG"
"RTN","C0IORMAP",168,0)
 S CVXMAP(34)="RIG"
"RTN","C0IORMAP",169,0)
 S CVXMAP(34)="RIG"
"RTN","C0IORMAP",170,0)
 S CVXMAP(93)="RSV-MAb"
"RTN","C0IORMAP",171,0)
 S CVXMAP(71)="RSV-IGIV"
"RTN","C0IORMAP",172,0)
 S CVXMAP(13)="TIG"
"RTN","C0IORMAP",173,0)
 S CVXMAP(79)="vaccinia immune globulin"
"RTN","C0IORMAP",174,0)
 S CVXMAP(36)="VZIG"
"RTN","C0IORMAP",175,0)
 S CVXMAP(128)="Novel Influenza-H1N1-09, all formulations"
"RTN","C0IORMAP",176,0)
 S CVXMAP(54)="adenovirus, type 4"
"RTN","C0IORMAP",177,0)
 S CVXMAP(55)="adenovirus, type 7"
"RTN","C0IORMAP",178,0)
 S CVXMAP(24)="anthrax"
"RTN","C0IORMAP",179,0)
 S CVXMAP(19)="BCG"
"RTN","C0IORMAP",180,0)
 S CVXMAP(52)="Hep A, adult"
"RTN","C0IORMAP",181,0)
 S CVXMAP(83)="Hep A, ped/adol, 2 dose"
"RTN","C0IORMAP",182,0)
 S CVXMAP(84)="Hep A, ped/adol, 3 dose"
"RTN","C0IORMAP",183,0)
 S CVXMAP(104)="Hep A-Hep B"
"RTN","C0IORMAP",184,0)
 S CVXMAP(148)="Meningococcal C/Y-HIB PRP"
"RTN","C0IORMAP",185,0)
 S CVXMAP(47)="Hib (HbOC)"
"RTN","C0IORMAP",186,0)
 S CVXMAP(46)="Hib (PRP-D)"
"RTN","C0IORMAP",187,0)
 S CVXMAP(49)="Hib (PRP-OMP)"
"RTN","C0IORMAP",188,0)
 S CVXMAP(48)="Hib (PRP-T)"
"RTN","C0IORMAP",189,0)
 S CVXMAP(62)="HPV, quadrivalent"
"RTN","C0IORMAP",190,0)
 S CVXMAP(118)="HPV, bivalent"
"RTN","C0IORMAP",191,0)
 S CVXMAP(144)="influenza, seasonal, intradermal, preservative free"
"RTN","C0IORMAP",192,0)
 S CVXMAP(140)="Influenza, seasonal, injectable, preservative free"
"RTN","C0IORMAP",193,0)
 S CVXMAP(140)="Influenza, seasonal, injectable, preservative free"
"RTN","C0IORMAP",194,0)
 S CVXMAP(141)="Influenza, seasonal, injectable"
"RTN","C0IORMAP",195,0)
 S CVXMAP(141)="Influenza, seasonal, injectable"
"RTN","C0IORMAP",196,0)
 S CVXMAP(16)="influenza, whole"
"RTN","C0IORMAP",197,0)
 S CVXMAP(111)="influenza, live, intranasal"
"RTN","C0IORMAP",198,0)
 S CVXMAP(153)="Influenza, injectable, MDCK, preservative free"
"RTN","C0IORMAP",199,0)
 S CVXMAP(135)="Influenza, high dose seasonal"
"RTN","C0IORMAP",200,0)
 S CVXMAP(128)="Novel Influenza-H1N1-09, all formulations"
"RTN","C0IORMAP",201,0)
 S CVXMAP(125)="Novel Influenza-H1N1-09, nasal"
"RTN","C0IORMAP",202,0)
 S CVXMAP(66)="Lyme disease"
"RTN","C0IORMAP",203,0)
 S CVXMAP(126)="Novel influenza-H1N1-09, preservative-free"
"RTN","C0IORMAP",204,0)
 S CVXMAP(127)="Novel influenza-H1N1-09"
"RTN","C0IORMAP",205,0)
 S CVXMAP(100)="pneumococcal conjugate PCV 7"
"RTN","C0IORMAP",206,0)
 S CVXMAP(133)="Pneumococcal conjugate PCV 13"
"RTN","C0IORMAP",207,0)
 S CVXMAP(149)="influenza, live, intranasal, quadrivalent"
"RTN","C0IORMAP",208,0)
 S CVXMAP(155)="influenza, recombinant, injectable, preservative free"
"RTN","C0IORMAP",209,0)
 S CVXMAP(18)="rabies, intramuscular injection"
"RTN","C0IORMAP",210,0)
 S CVXMAP(40)="rabies, intradermal injection"
"RTN","C0IORMAP",211,0)
 S CVXMAP(116)="rotavirus, pentavalent"
"RTN","C0IORMAP",212,0)
 S CVXMAP(119)="rotavirus, monovalent"
"RTN","C0IORMAP",213,0)
 S CVXMAP(150)="influenza, injectable, quadrivalent, preservative free"
"RTN","C0IORMAP",214,0)
 S CVXMAP(150)="influenza, injectable, quadrivalent, preservative free"
"RTN","C0IORMAP",215,0)
 S CVXMAP(158)="influenza, injectable, quadrivalent"
"RTN","C0IORMAP",216,0)
 S CVXMAP(25)="typhoid, oral"
"RTN","C0IORMAP",217,0)
 S CVXMAP(101)="typhoid, ViCPs"
"RTN","C0IORMAP",218,0)
 S CVXMAP(41)="typhoid, parenteral"
"RTN","C0IORMAP",219,0)
 S CVXMAP(53)="typhoid, parenteral, AKD (U.S. military)"
"RTN","C0IORMAP",220,0)
 S CVXMAP(130)="DTaP-IPV"
"RTN","C0IORMAP",221,0)
 S CVXMAP(120)="DTaP-Hib-IPV"
"RTN","C0IORMAP",222,0)
 S CVXMAP(20)="DTaP"
"RTN","C0IORMAP",223,0)
 S CVXMAP(106)="DTaP, 5 pertussis antigens"
"RTN","C0IORMAP",224,0)
 S CVXMAP(01)="DTP"
"RTN","C0IORMAP",225,0)
 S CVXMAP(28)="DT (pediatric)"
"RTN","C0IORMAP",226,0)
 S CVXMAP(35)="tetanus toxoid, adsorbed"
"RTN","C0IORMAP",227,0)
 S CVXMAP(07)="mumps"
"RTN","C0IORMAP",228,0)
 S CVXMAP(05)="measles"
"RTN","C0IORMAP",229,0)
 S CVXMAP(06)="rubella"
"RTN","C0IORMAP",230,0)
 S CVXMAP(03)="MMR"
"RTN","C0IORMAP",231,0)
 S CVXMAP(04)="M/R"
"RTN","C0IORMAP",232,0)
 S CVXMAP(94)="MMRV"
"RTN","C0IORMAP",233,0)
 S CVXMAP(02)="OPV"
"RTN","C0IORMAP",234,0)
 S CVXMAP(10)="IPV"
"RTN","C0IORMAP",235,0)
 S CVXMAP(113)="Td (adult) preservative free"
"RTN","C0IORMAP",236,0)
 S CVXMAP(91)="typhoid, unspecified formulation"
"RTN","C0IORMAP",237,0)
 S CVXMAP(115)="Tdap"
"RTN","C0IORMAP",238,0)
 S CVXMAP(21)="varicella"
"RTN","C0IORMAP",239,0)
 S CVXMAP(37)="yellow fever"
"RTN","C0IORMAP",240,0)
 S CVXMAP(09)="Td (adult), adsorbed"
"RTN","C0IORMAP",241,0)
 S CVXMAP(22)="DTP-Hib"
"RTN","C0IORMAP",242,0)
 S CVXMAP(50)="DTaP-Hib"
"RTN","C0IORMAP",243,0)
 S CVXMAP(110)="DTaP-Hep B-IPV"
"RTN","C0IORMAP",244,0)
 S CVXMAP(88)="influenza, unspecified formulation"
"RTN","C0IORMAP",245,0)
 S CVXMAP(26)="cholera"
"RTN","C0IORMAP",246,0)
 S CVXMAP(90)="rabies, unspecified formulation"
"RTN","C0IORMAP",247,0)
 S CVXMAP(23)="plague"
"RTN","C0IORMAP",248,0)
 S CVXMAP(19)="BCG"
"RTN","C0IORMAP",249,0)
 S CVXMAP(85)="Hep A, unspecified formulation"
"RTN","C0IORMAP",250,0)
 S CVXMAP(45)="Hep B, unspecified formulation"
"RTN","C0IORMAP",251,0)
 S CVXMAP(33)="pneumococcal polysaccharide PPV23"
"RTN","C0IORMAP",252,0)
 S CVXMAP(32)="meningococcal MPSV4"
"RTN","C0IORMAP",253,0)
 S CVXMAP(136)="Meningococcal MCV4O"
"RTN","C0IORMAP",254,0)
 S CVXMAP(114)="meningococcal MCV4P"
"RTN","C0IORMAP",255,0)
 S CVXMAP(39)="Japanese encephalitis SC"
"RTN","C0IORMAP",256,0)
 S CVXMAP(121)="zoster"
"RTN","C0IORMAP",257,0)
 S CVXMAP(17)="Hib, unspecified formulation"
"RTN","C0IORMAP",258,0)
 S CVXMAP(134)="Japanese Encephalitis IM"
"RTN","C0IORMAP",259,0)
 S CVXMAP(44)="Hep B, dialysis"
"RTN","C0IORMAP",260,0)
 S CVXMAP(14)="IG, unspecified formulation"
"RTN","C0IORMAP",261,0)
 S CVXMAP(43)="Hep B, adult"
"RTN","C0IORMAP",262,0)
 S CVXMAP(08)="Hep B, adolescent or pediatric"
"RTN","C0IORMAP",263,0)
 S CVXMAP(42)="Hep B, adolescent/high risk infant"
"RTN","C0IORMAP",264,0)
 S CVXMAP(43)="Hep B, adult"
"RTN","C0IORMAP",265,0)
 S CVXMAP(44)="Hep B, dialysis"
"RTN","C0IORMAP",266,0)
 S CVXMAP(51)="Hib-Hep B"
"RTN","C0IORMAP",267,0)
 S CVXMAP("B","IG",86)=""
"RTN","C0IORMAP",268,0)
 S CVXMAP("B","IGIV",87)=""
"RTN","C0IORMAP",269,0)
 S CVXMAP("B","botulinum antitoxin",27)=""
"RTN","C0IORMAP",270,0)
 S CVXMAP("B","CMVIG",29)=""
"RTN","C0IORMAP",271,0)
 S CVXMAP("B","diphtheria antitoxin",12)=""
"RTN","C0IORMAP",272,0)
 S CVXMAP("B","HBIG",30)=""
"RTN","C0IORMAP",273,0)
 S CVXMAP("B","RIG",34)=""
"RTN","C0IORMAP",274,0)
 S CVXMAP("B","RIG",34)=""
"RTN","C0IORMAP",275,0)
 S CVXMAP("B","RSV-MAb",93)=""
"RTN","C0IORMAP",276,0)
 S CVXMAP("B","RSV-IGIV",71)=""
"RTN","C0IORMAP",277,0)
 S CVXMAP("B","TIG",13)=""
"RTN","C0IORMAP",278,0)
 S CVXMAP("B","vaccinia immune globulin",79)=""
"RTN","C0IORMAP",279,0)
 S CVXMAP("B","VZIG",36)=""
"RTN","C0IORMAP",280,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, all formulations",128)=""
"RTN","C0IORMAP",281,0)
 S CVXMAP("B","adenovirus, type 4",54)=""
"RTN","C0IORMAP",282,0)
 S CVXMAP("B","adenovirus, type 7",55)=""
"RTN","C0IORMAP",283,0)
 S CVXMAP("B","anthrax",24)=""
"RTN","C0IORMAP",284,0)
 S CVXMAP("B","BCG",19)=""
"RTN","C0IORMAP",285,0)
 S CVXMAP("B","Hep A, adult",52)=""
"RTN","C0IORMAP",286,0)
 S CVXMAP("B","Hep A, ped/adol, 2 dose",83)=""
"RTN","C0IORMAP",287,0)
 S CVXMAP("B","Hep A, ped/adol, 3 dose",84)=""
"RTN","C0IORMAP",288,0)
 S CVXMAP("B","Hep A-Hep B",104)=""
"RTN","C0IORMAP",289,0)
 S CVXMAP("B","Meningococcal C/Y-HIB PRP",148)=""
"RTN","C0IORMAP",290,0)
 S CVXMAP("B","Hib (HbOC)",47)=""
"RTN","C0IORMAP",291,0)
 S CVXMAP("B","Hib (PRP-D)",46)=""
"RTN","C0IORMAP",292,0)
 S CVXMAP("B","Hib (PRP-OMP)",49)=""
"RTN","C0IORMAP",293,0)
 S CVXMAP("B","Hib (PRP-T)",48)=""
"RTN","C0IORMAP",294,0)
 S CVXMAP("B","HPV, quadrivalent",62)=""
"RTN","C0IORMAP",295,0)
 S CVXMAP("B","HPV, bivalent",118)=""
"RTN","C0IORMAP",296,0)
 S CVXMAP("B","influenza, seasonal, intradermal, preservative free",144)=""
"RTN","C0IORMAP",297,0)
 S CVXMAP("B","Influenza, seasonal, injectable, preservative free",140)=""
"RTN","C0IORMAP",298,0)
 S CVXMAP("B","Influenza, seasonal, injectable, preservative free",140)=""
"RTN","C0IORMAP",299,0)
 S CVXMAP("B","Influenza, seasonal, injectable",141)=""
"RTN","C0IORMAP",300,0)
 S CVXMAP("B","Influenza, seasonal, injectable",141)=""
"RTN","C0IORMAP",301,0)
 S CVXMAP("B","influenza, whole",16)=""
"RTN","C0IORMAP",302,0)
 S CVXMAP("B","influenza, live, intranasal",111)=""
"RTN","C0IORMAP",303,0)
 S CVXMAP("B","Influenza, injectable, MDCK, preservative free",153)=""
"RTN","C0IORMAP",304,0)
 S CVXMAP("B","Influenza, high dose seasonal",135)=""
"RTN","C0IORMAP",305,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, all formulations",128)=""
"RTN","C0IORMAP",306,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, nasal",125)=""
"RTN","C0IORMAP",307,0)
 S CVXMAP("B","Lyme disease",66)=""
"RTN","C0IORMAP",308,0)
 S CVXMAP("B","Novel influenza-H1N1-09, preservative-free",126)=""
"RTN","C0IORMAP",309,0)
 S CVXMAP("B","Novel influenza-H1N1-09",127)=""
"RTN","C0IORMAP",310,0)
 S CVXMAP("B","pneumococcal conjugate PCV 7",100)=""
"RTN","C0IORMAP",311,0)
 S CVXMAP("B","Pneumococcal conjugate PCV 13",133)=""
"RTN","C0IORMAP",312,0)
 S CVXMAP("B","influenza, live, intranasal, quadrivalent",149)=""
"RTN","C0IORMAP",313,0)
 S CVXMAP("B","influenza, recombinant, injectable, preservative free",155)=""
"RTN","C0IORMAP",314,0)
 S CVXMAP("B","rabies, intramuscular injection",18)=""
"RTN","C0IORMAP",315,0)
 S CVXMAP("B","rabies, intradermal injection",40)=""
"RTN","C0IORMAP",316,0)
 S CVXMAP("B","rotavirus, pentavalent",116)=""
"RTN","C0IORMAP",317,0)
 S CVXMAP("B","rotavirus, monovalent",119)=""
"RTN","C0IORMAP",318,0)
 S CVXMAP("B","influenza, injectable, quadrivalent, preservative free",150)=""
"RTN","C0IORMAP",319,0)
 S CVXMAP("B","influenza, injectable, quadrivalent, preservative free",150)=""
"RTN","C0IORMAP",320,0)
 S CVXMAP("B","influenza, injectable, quadrivalent",158)=""
"RTN","C0IORMAP",321,0)
 S CVXMAP("B","typhoid, oral",25)=""
"RTN","C0IORMAP",322,0)
 S CVXMAP("B","typhoid, ViCPs",101)=""
"RTN","C0IORMAP",323,0)
 S CVXMAP("B","typhoid, parenteral",41)=""
"RTN","C0IORMAP",324,0)
 S CVXMAP("B","typhoid, parenteral, AKD (U.S. military)",53)=""
"RTN","C0IORMAP",325,0)
 S CVXMAP("B","DTaP-IPV",130)=""
"RTN","C0IORMAP",326,0)
 S CVXMAP("B","DTaP-Hib-IPV",120)=""
"RTN","C0IORMAP",327,0)
 S CVXMAP("B","DTaP",20)=""
"RTN","C0IORMAP",328,0)
 S CVXMAP("B","DTaP, 5 pertussis antigens",106)=""
"RTN","C0IORMAP",329,0)
 S CVXMAP("B","DTP",01)=""
"RTN","C0IORMAP",330,0)
 S CVXMAP("B","DT (pediatric)",28)=""
"RTN","C0IORMAP",331,0)
 S CVXMAP("B","tetanus toxoid, adsorbed",35)=""
"RTN","C0IORMAP",332,0)
 S CVXMAP("B","mumps",07)=""
"RTN","C0IORMAP",333,0)
 S CVXMAP("B","measles",05)=""
"RTN","C0IORMAP",334,0)
 S CVXMAP("B","rubella",06)=""
"RTN","C0IORMAP",335,0)
 S CVXMAP("B","MMR",03)=""
"RTN","C0IORMAP",336,0)
 S CVXMAP("B","M/R",04)=""
"RTN","C0IORMAP",337,0)
 S CVXMAP("B","MMRV",94)=""
"RTN","C0IORMAP",338,0)
 S CVXMAP("B","OPV",02)=""
"RTN","C0IORMAP",339,0)
 S CVXMAP("B","IPV",10)=""
"RTN","C0IORMAP",340,0)
 S CVXMAP("B","Td (adult) preservative free",113)=""
"RTN","C0IORMAP",341,0)
 S CVXMAP("B","typhoid, unspecified formulation",91)=""
"RTN","C0IORMAP",342,0)
 S CVXMAP("B","Tdap",115)=""
"RTN","C0IORMAP",343,0)
 S CVXMAP("B","varicella",21)=""
"RTN","C0IORMAP",344,0)
 S CVXMAP("B","yellow fever",37)=""
"RTN","C0IORMAP",345,0)
 S CVXMAP("B","Td (adult), adsorbed",09)=""
"RTN","C0IORMAP",346,0)
 S CVXMAP("B","DTP-Hib",22)=""
"RTN","C0IORMAP",347,0)
 S CVXMAP("B","DTaP-Hib",50)=""
"RTN","C0IORMAP",348,0)
 S CVXMAP("B","DTaP-Hep B-IPV",110)=""
"RTN","C0IORMAP",349,0)
 S CVXMAP("B","influenza, unspecified formulation",88)=""
"RTN","C0IORMAP",350,0)
 S CVXMAP("B","cholera",26)=""
"RTN","C0IORMAP",351,0)
 S CVXMAP("B","rabies, unspecified formulation",90)=""
"RTN","C0IORMAP",352,0)
 S CVXMAP("B","plague",23)=""
"RTN","C0IORMAP",353,0)
 S CVXMAP("B","BCG",19)=""
"RTN","C0IORMAP",354,0)
 S CVXMAP("B","Hep A, unspecified formulation",85)=""
"RTN","C0IORMAP",355,0)
 S CVXMAP("B","Hep B, unspecified formulation",45)=""
"RTN","C0IORMAP",356,0)
 S CVXMAP("B","pneumococcal polysaccharide PPV23",33)=""
"RTN","C0IORMAP",357,0)
 S CVXMAP("B","meningococcal MPSV4",32)=""
"RTN","C0IORMAP",358,0)
 S CVXMAP("B","Meningococcal MCV4O",136)=""
"RTN","C0IORMAP",359,0)
 S CVXMAP("B","meningococcal MCV4P",114)=""
"RTN","C0IORMAP",360,0)
 S CVXMAP("B","Japanese encephalitis SC",39)=""
"RTN","C0IORMAP",361,0)
 S CVXMAP("B","zoster",121)=""
"RTN","C0IORMAP",362,0)
 S CVXMAP("B","Hib, unspecified formulation",17)=""
"RTN","C0IORMAP",363,0)
 S CVXMAP("B","Japanese Encephalitis IM",134)=""
"RTN","C0IORMAP",364,0)
 S CVXMAP("B","Hep B, dialysis",44)=""
"RTN","C0IORMAP",365,0)
 S CVXMAP("B","IG, unspecified formulation",14)=""
"RTN","C0IORMAP",366,0)
 S CVXMAP("B","Hep B, adult",43)=""
"RTN","C0IORMAP",367,0)
 S CVXMAP("B","Hep B, adolescent or pediatric",08)=""
"RTN","C0IORMAP",368,0)
 S CVXMAP("B","Hep B, adolescent/high risk infant",42)=""
"RTN","C0IORMAP",369,0)
 S CVXMAP("B","Hep B, adult",43)=""
"RTN","C0IORMAP",370,0)
 S CVXMAP("B","Hep B, dialysis",44)=""
"RTN","C0IORMAP",371,0)
 S CVXMAP("B","Hib-Hep B",51)=""
"RTN","C0IORMAP",372,0)
 Q
"RTN","C0IORMAP",373,0)
 ;
"RTN","C0IPXRM")
0^9^B33766994
"RTN","C0IPXRM",1,0)
C0IPXRM ; GPL&NEA - Immunizations Forecasting Utilities ;05/03/14  17:05
"RTN","C0IPXRM",2,0)
 ;;0.1;Immunizations Forecasting;nopatch;noreleasedate;Build 1
"RTN","C0IPXRM",3,0)
 ;
"RTN","C0IPXRM",4,0)
 ; License Apache 2
"RTN","C0IPXRM",5,0)
 ; 
"RTN","C0IPXRM",6,0)
 Q
"RTN","C0IPXRM",7,0)
 ;
"RTN","C0IPXRM",8,0)
 ; Routines for calling Reminders to see if the patients has had any deseases 
"RTN","C0IPXRM",9,0)
 ;   that make them immune and therefore not requiring a vaccination
"RTN","C0IPXRM",10,0)
 ; 
"RTN","C0IPXRM",11,0)
 ; Since we are not on the latest Reminder's patch (24) we do not have access to
"RTN","C0IPXRM",12,0)
 ;   entry point MAINDF^PXRM. Therefore we import MAIN^PXRM and modify it to act
"RTN","C0IPXRM",13,0)
 ;   as a workaround. When patch 24 is available, this routine should be changed
"RTN","C0IPXRM",14,0)
 ;   to detect it and use it.  gpl
"RTN","C0IPXRM",15,0)
 ;
"RTN","C0IPXRM",16,0)
EN(DFN,REMNDR,ARY,ATTR,RCODE,RNAME) ; extrinsic returns true if the reminder evaluates true
"RTN","C0IPXRM",17,0)
 ; also returns supporting values as "findings" in the array indexed by the attribute ATTR
"RTN","C0IPXRM",18,0)
 ; 
"RTN","C0IPXRM",19,0)
 ; DFN is the patient ien passed by value
"RTN","C0IPXRM",20,0)
 ; REMNDR is the reminder ien passed by value
"RTN","C0IPXRM",21,0)
 ; ARY is the return array passed by reference - results will be added to the end
"RTN","C0IPXRM",22,0)
 ;  of the array ie ARY("findings",4,....) if there is already an ARY("findings",3)
"RTN","C0IPXRM",23,0)
 ; ATTR is the attribute to be associated with this call ie "hadMumps" passed by value
"RTN","C0IPXRM",24,0)
 ; RCODE and RNAME are the Rubrics that will be used for this finding when calling
"RTN","C0IPXRM",25,0)
 ;  clinical decision support. 
"RTN","C0IPXRM",26,0)
 ;
"RTN","C0IPXRM",27,0)
 ; This routine calls the reminders package with the patient and reminder ien passed in.
"RTN","C0IPXRM",28,0)
 ;  if the reminder evaluates true, it then locates and finds the patient entry that
"RTN","C0IPXRM",29,0)
 ;  caused the true evaluation, and collects the source, the date of onset if possible,
"RTN","C0IPXRM",30,0)
 ;  and the date of entry. It will also return the other things retained by the reminders
"RTN","C0IPXRM",31,0)
 ;  package in case they might also be useful. It puts them in the array and indexes the
"RTN","C0IPXRM",32,0)
 ;  entry by the attribute that is passed in.. 
"RTN","C0IPXRM",33,0)
 ;
"RTN","C0IPXRM",34,0)
 ;D MAIN(11,264,0)
"RTN","C0IPXRM",35,0)
 D MAIN(DFN,REMNDR,0)
"RTN","C0IPXRM",36,0)
 I $G(FIEVAL(1))=0 Q 0 ; no positive findings
"RTN","C0IPXRM",37,0)
 ;
"RTN","C0IPXRM",38,0)
 ; first see if there's a problem list entry and give it preference
"RTN","C0IPXRM",39,0)
 ;   (this preference is because with a problem list entry we can get date of onset)
"RTN","C0IPXRM",40,0)
 ;
"RTN","C0IPXRM",41,0)
 N C0IUSE S C0IUSE=0 ; eval entry to use
"RTN","C0IPXRM",42,0)
 N C0I S C0I=""
"RTN","C0IPXRM",43,0)
 F  S C0I=$O(FIEVAL(1,C0I)) Q:((C0I="")!(C0IUSE'=0))  D  ;
"RTN","C0IPXRM",44,0)
 . I $G(FIEVAL(1,C0I,"FILE NUMBER"))=9000011 S C0IUSE=C0I
"RTN","C0IPXRM",45,0)
 I C0IUSE=0 S C0IUSE=1 ; if no problem entry, use the first entry
"RTN","C0IPXRM",46,0)
 ;
"RTN","C0IPXRM",47,0)
 N C0FIND
"RTN","C0IPXRM",48,0)
 S C0FIND=$O(ARY("findings"," "),-1)+1 ; index of this finding
"RTN","C0IPXRM",49,0)
 M ARY("findings",C0FIND)=FIEVAL(1,C0IUSE)
"RTN","C0IPXRM",50,0)
 N FIEN,FFILE
"RTN","C0IPXRM",51,0)
 S FIEN=$G(FIEVAL(1,C0IUSE,"DAS")) ; ien of problem 
"RTN","C0IPXRM",52,0)
 S FFILE=$G(FIEVAL(1,C0IUSE,"FILE NUMBER"))
"RTN","C0IPXRM",53,0)
 ;
"RTN","C0IPXRM",54,0)
 S ARY("findings",C0FIND,"ICD9Code")=$$GET1^DIQ(FFILE,FIEN_",",.01)
"RTN","C0IPXRM",55,0)
 S ARY("findings",C0FIND,"ICD9Name")=$$GET1^DIQ(FFILE,FIEN_",",.05)
"RTN","C0IPXRM",56,0)
 S ARY("findings",C0FIND,"dateOfOnset")=$G(FIEVAL(1,C0IUSE,"DATE ENTERED"))
"RTN","C0IPXRM",57,0)
 S ARY("findings",C0FIND,"date")=$G(FIEVAL(1,C0IUSE,"DATE"))
"RTN","C0IPXRM",58,0)
 N C0IDUZ S C0IDUZ=$G(FIEVAL(1,C0IUSE,"PRIMARY PROVIDER"))
"RTN","C0IPXRM",59,0)
 I +C0IDUZ=0 S C0IDUZ=$G(FIEVAL(1,"PRIMARY PROVIDER"))
"RTN","C0IPXRM",60,0)
 S ARY("findings",C0FIND,"primaryProviderDUZ")=C0IDUZ
"RTN","C0IPXRM",61,0)
 S ARY("findings",C0FIND,"primaryProviderName")=$$GET1^DIQ(200,C0IDUZ_",",.01)
"RTN","C0IPXRM",62,0)
 S ARY("findings",C0FIND,ATTR)=""
"RTN","C0IPXRM",63,0)
 S ARY("findings","B",ATTR,C0FIND)=""
"RTN","C0IPXRM",64,0)
 S ARY("findings",C0FIND,"rubricCode")=$E(RCODE,1,$L(RCODE))
"RTN","C0IPXRM",65,0)
 S ARY("findings",C0FIND,"rubricName")=RNAME
"RTN","C0IPXRM",66,0)
 S ARY("findings","rubric",RCODE,C0FIND)=""
"RTN","C0IPXRM",67,0)
 M ARY("FIEVAL",C0FIND)=FIEVAL ; for debugging
"RTN","C0IPXRM",68,0)
 Q 1
"RTN","C0IPXRM",69,0)
 ;
"RTN","C0IPXRM",70,0)
MAIN(DFN,PXRMITEM,OUTTYPE,DISC) ;Main driver for clinical reminders.
"RTN","C0IPXRM",71,0)
 ;INPUT  DFN - Pointer to Patient File (#2)
"RTN","C0IPXRM",72,0)
 ;       PXRMITEM - IEN of reminder to evaluate.
"RTN","C0IPXRM",73,0)
 ;       OUTTYPE - Flag to indicate type of output information.
"RTN","C0IPXRM",74,0)
 ;         0 - Reminders DUE NOW only (CLINICAL REMINDERS DUE
"RTN","C0IPXRM",75,0)
 ;             HS component)
"RTN","C0IPXRM",76,0)
 ;         1 - All Reminders with Next and Last Information
"RTN","C0IPXRM",77,0)
 ;             (CLINICAL REMINDERS SUMMARY HS component)
"RTN","C0IPXRM",78,0)
 ;         5 - Health Maintenance (CLINICAL REMINDERS MAINTENANCE
"RTN","C0IPXRM",79,0)
 ;              HS component)
"RTN","C0IPXRM",80,0)
 ;        10 - MyHealtheVet summary
"RTN","C0IPXRM",81,0)
 ;        11 - MyHealtheVet detailed
"RTN","C0IPXRM",82,0)
 ;        12 - MyHealtheVet combined
"RTN","C0IPXRM",83,0)
 ;        DISC - (optional) if this is true then the disclaimer will
"RTN","C0IPXRM",84,0)
 ;             be loaded in ^TMP("PXRM",$J,"DISC").
"RTN","C0IPXRM",85,0)
 ;
"RTN","C0IPXRM",86,0)
 ;OUTPUT  ^TMP("PXRHM",$J,PXRMITEM,PXRMRNAM)=
"RTN","C0IPXRM",87,0)
 ;              STATUS_U_DUE DATE_U_LAST DONE
"RTN","C0IPXRM",88,0)
 ;        where PXRMRNAM is the PRINT NAME or if it is undefined then
"RTN","C0IPXRM",89,0)
 ;        it is the NAME (.01).
"RTN","C0IPXRM",90,0)
 ;        For the Clinical Maintenance component, OUTTYPE=5, there is 
"RTN","C0IPXRM",91,0)
 ;        subsequent output of the form
"RTN","C0IPXRM",92,0)
 ;        ^TMP("PXRHM",$J,PXRMITEM,PXRMRNAM,"TXT",N)=TEXT
"RTN","C0IPXRM",93,0)
 ;        where N is a number and TEXT is a text string.
"RTN","C0IPXRM",94,0)
 ;
"RTN","C0IPXRM",95,0)
 ;        If DISC is true then the disclaimer will be loaded into
"RTN","C0IPXRM",96,0)
 ;        ^TMP("PXRM",$J,"DISC"). The calling application should
"RTN","C0IPXRM",97,0)
 ;        delete this when it is done.
"RTN","C0IPXRM",98,0)
 ;
"RTN","C0IPXRM",99,0)
 ;        The calling application can display the contents of these
"RTN","C0IPXRM",100,0)
 ;        two ^TMP arrays as it chooses. The caller should also make
"RTN","C0IPXRM",101,0)
 ;        sure the ^TMP globals are killed before it exits.
"RTN","C0IPXRM",102,0)
 ;
"RTN","C0IPXRM",103,0)
 N DEFARR ;,FIEVAL gpl don't new FIEVAL
"RTN","C0IPXRM",104,0)
        K FIEVAL ; gpl kill it instead
"RTN","C0IPXRM",105,0)
 ;Load the definition into DEFARR.
"RTN","C0IPXRM",106,0)
 D DEF^PXRMLDR(PXRMITEM,.DEFARR)
"RTN","C0IPXRM",107,0)
 ;
"RTN","C0IPXRM",108,0)
 I $G(NODISC)="" S NODISC=1
"RTN","C0IPXRM",109,0)
 I $D(GMFLAG) S NODISC=0
"RTN","C0IPXRM",110,0)
 D EVAL^PXRM(DFN,.DEFARR,OUTTYPE,NODISC,.FIEVAL) ; gpl fully qualify routine name
"RTN","C0IPXRM",111,0)
 Q
"RTN","C0IPXRM",112,0)
 ;
"RTN","C0IPXRM",113,0)
 ;==========================================================
"RTN","C0IPXRM",114,0)
TEST ; try out the above
"RTN","C0IPXRM",115,0)
 S DFN=$$PAT^C0IICE()
"RTN","C0IPXRM",116,0)
 Q:DFN=0
"RTN","C0IPXRM",117,0)
 N IENHEPA,IENHEPB,IENMEASL,IENVARIC,IENMUMPS,IENRUBEL 
"RTN","C0IPXRM",118,0)
 N RCODE,RNAME ; rubric code and name
"RTN","C0IPXRM",119,0)
 S (IENHEPA,IENHEPB,IENMEASL,IENVARIC,IENMUMPS,IENRUBEL)=""
"RTN","C0IPXRM",120,0)
 N FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG
"RTN","C0IPXRM",121,0)
 S FILE=811.9 
"RTN","C0IPXRM",122,0)
 S IENS=""
"RTN","C0IPXRM",123,0)
 S FLAGS="OQ"
"RTN","C0IPXRM",124,0)
 S INDEX="B"
"RTN","C0IPXRM",125,0)
 S SCREEN=""
"RTN","C0IPXRM",126,0)
 S EMSG=""
"RTN","C0IPXRM",127,0)
 ;N N,HEPA,HEPB,VARICEL,MUMPS,MEASLES,RUBELLA
"RTN","C0IPXRM",128,0)
 S (N,HEPA,HEPB,VARICEL,MUMPS,MEASLES,RUBELLA)=0
"RTN","C0IPXRM",129,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IPXRM",130,0)
 N REMNAME S REMNAME="VIMM-HEPATITIS B DIAGNOSIS"
"RTN","C0IPXRM",131,0)
 S IENHEPB=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IPXRM",132,0)
 I IENHEPB="" Q  ; reminder not found, skip this part
"RTN","C0IPXRM",133,0)
 K REMNAME
"RTN","C0IPXRM",134,0)
 ;D MAIN^PXRM(DFN,IENHEPB,0)
"RTN","C0IPXRM",135,0)
 S RCODE="070.3"
"RTN","C0IPXRM",136,0)
 S RNAME="Hep B"
"RTN","C0IPXRM",137,0)
 I $$EN^C0IPXRM(DFN,IENHEPB,.RETURN,"hadHepB",RCODE,RNAME) S N=N+1 S HEPB=1
"RTN","C0IPXRM",138,0)
 ;I $G(^TMP("PXRHM",$J,IENHEPB,"VIMM-HEPATITIS B DIAGNOSIS"))["DUE NOW" S N=N+1 S HEPB=1
"RTN","C0IPXRM",139,0)
 ;W "HEPB=",HEPB,!
"RTN","C0IPXRM",140,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IPXRM",141,0)
 N REMNAME S REMNAME="VIMM-HEPATITIS A DIAGNOSIS"
"RTN","C0IPXRM",142,0)
 S IENHEPA=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG) 
"RTN","C0IPXRM",143,0)
 K REMNAME
"RTN","C0IPXRM",144,0)
 ;D MAIN^PXRM(DFN,IENHEPA,0)
"RTN","C0IPXRM",145,0)
 S RCODE="070.1"
"RTN","C0IPXRM",146,0)
 S RNAME="Hep A"
"RTN","C0IPXRM",147,0)
 I $$EN^C0IPXRM(DFN,IENHEPA,.RETURN,"hadHepA",RCODE,RNAME) S N=N+1 S HEPA=1
"RTN","C0IPXRM",148,0)
 ;I $G(^TMP("PXRHM",$J,IENHEPA,"VIMM-HEPATITIS A DIAGNOSIS"))["DUE NOW" S N=N+1 S HEPA=1
"RTN","C0IPXRM",149,0)
 ;W "HEPA=",HEPA,!
"RTN","C0IPXRM",150,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IPXRM",151,0)
 N REMNAME S REMNAME="VIMM-VARICELLA DIAGNOSIS"
"RTN","C0IPXRM",152,0)
 S IENVARIC=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IPXRM",153,0)
 K REMNAME
"RTN","C0IPXRM",154,0)
 ;D MAIN^PXRM(DFN,IENVARIC,0)
"RTN","C0IPXRM",155,0)
 S RCODE="052.9"
"RTN","C0IPXRM",156,0)
 S RNAME="Varicella"
"RTN","C0IPXRM",157,0)
 I $$EN^C0IPXRM(DFN,IENVARIC,.RETURN,"hadVaricella",RCODE,RNAME) S N=N+1 S VARICEL=1
"RTN","C0IPXRM",158,0)
 ;I $G(^TMP("PXRHM",$J,IENVARIC,"VIMM-VARICELLA DIAGNOSIS"))["DUE NOW" S N=N+1 S VARICEL=1
"RTN","C0IPXRM",159,0)
 ;W "VARICEL=",VARICEL,!
"RTN","C0IPXRM",160,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IPXRM",161,0)
 N REMNAME S REMNAME="VIMM-MUMPS DIAGNOSIS" 
"RTN","C0IPXRM",162,0)
 S IENMUMPS=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG) D MAIN^PXRM(DFN,267,0)
"RTN","C0IPXRM",163,0)
 K REMNME
"RTN","C0IPXRM",164,0)
 ;D MAIN^PXRM(DFN,IENMUMPS,0)
"RTN","C0IPXRM",165,0)
 S RCODE="072.9"
"RTN","C0IPXRM",166,0)
 S RNAME="Mumps"
"RTN","C0IPXRM",167,0)
 I $$EN^C0IPXRM(DFN,IENMUMPS,.RETURN,"hadMumps",RCODE,RNAME) S N=N+1 S IENMUMPS=1
"RTN","C0IPXRM",168,0)
 ;I $G(^TMP("PXRHM",$J,IENMUMPS,"VIMM-MUMPS DIAGNOSIS"))["DUE NOW" S N=N+1 S MUMPS=1
"RTN","C0IPXRM",169,0)
 ;W "MUMPS=",MUMPS,!
"RTN","C0IPXRM",170,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IPXRM",171,0)
 N REMNAME S REMNAME="VIMM-MEASLES DIAGNOSIS"
"RTN","C0IPXRM",172,0)
 S IENMEASL=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IPXRM",173,0)
 K REMNAME
"RTN","C0IPXRM",174,0)
 ;D MAIN^PXRM(DFN,IENMEASL,0)
"RTN","C0IPXRM",175,0)
 S RCODE="055.9"
"RTN","C0IPXRM",176,0)
 S RNAME="Measles"
"RTN","C0IPXRM",177,0)
 I $$EN^C0IPXRM(DFN,IENMEASL,.RETURN,"hadMeasles",RCODE,RNAME) S N=N+1 S MEASLES=1
"RTN","C0IPXRM",178,0)
 ;I $G(^TMP("PXRHM",$J,IENMEASL,"VIMM-MEASLES DIAGNOSIS"))["DUE NOW" S N=N+1 S MEASLES=1
"RTN","C0IPXRM",179,0)
 ;W "MEASLES=",MEASLES,!
"RTN","C0IPXRM",180,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IPXRM",181,0)
 N REMNAME S REMNAME="VIMM-RUBELLA DIAGNOSIS"
"RTN","C0IPXRM",182,0)
 S IENRUBEL=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IPXRM",183,0)
 K REMNAME
"RTN","C0IPXRM",184,0)
 ;D MAIN^PXRM(DFN,IENRUBEL,0)
"RTN","C0IPXRM",185,0)
 S RCODE="056.9"
"RTN","C0IPXRM",186,0)
 S RNAME="Rubella"
"RTN","C0IPXRM",187,0)
 I $$EN^C0IPXRM(DFN,IENRUBEL,.RETURN,"hadRubella",RCODE,RNAME) S N=N+1 S RUBELLA=1
"RTN","C0IPXRM",188,0)
 ;I $G(^TMP("PXRHM",$J,IENRUBEL,"VIMM-RUBELLA DIAGNOSIS"))["DUE NOW" S N=N+1 S RUBELLA=1
"RTN","C0IPXRM",189,0)
 ;W "RUBELLA=",RUBELLA,!
"RTN","C0IPXRM",190,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IPXRM",191,0)
 I N=0 Q
"RTN","C0IPXRM",192,0)
 Q
"RTN","C0IPXRM",193,0)
 ;
"RTN","C0ISOAP4")
0^3^B15279793
"RTN","C0ISOAP4",1,0)
C0ISOAP   ; GPL/RCR - Web Service utilities; 8/31/09; 12/08/2010
"RTN","C0ISOAP4",2,0)
 ;;0.1;IMMUNIZATIONS FORECASTING;nopatch;noreleasedate;Build 1
"RTN","C0ISOAP4",3,0)
 ;Copyright 2009 George Lilly.  Licensed Apache 2
"RTN","C0ISOAP4",4,0)
 ;
"RTN","C0ISOAP4",5,0)
 ; Modified by Chris Richardson, November, 2010.  George's License is still in force.
"RTN","C0ISOAP4",6,0)
 ; Code has been modified to accept very large XML documents and block them logically.
"RTN","C0ISOAP4",7,0)
 ; 3101208 - RCR - Correct end of buffer condition, BF=">"
"RTN","C0ISOAP4",8,0)
 ;
"RTN","C0ISOAP4",9,0)
 QUIT
"RTN","C0ISOAP4",10,0)
 ;
"RTN","C0ISOAP4",11,0)
 ;  ==========
"RTN","C0ISOAP4",12,0)
SOAP(C0RTN,C0PARMS,C0DETAIL) ; MAKES A SOAP CALL FOR BASED ON C0PARMS passed by reference
"RTN","C0ISOAP4",13,0)
 ; C0PARMS("xml")=location of ready to go xml (skip encoding and soap envelop buildling)
"RTN","C0ISOAP4",14,0)
 ; C0PARMS("url")=url string for the SOAP call
"RTN","C0ISOAP4",15,0)
 ; C0PARMS("payload")=name of location of the xml payload
"RTN","C0ISOAP4",16,0)
 ; C0PARMS("envelop")=name of the location of the xml soap envelop
"RTN","C0ISOAP4",17,0)
 ; C0PARMS("payloadVarOut")=variable for outgoing payload; default "outPayload"
"RTN","C0ISOAP4",18,0)
 ; C0PARMS("payloadVarIn")=incoming tag for payload; default "base64EncodedPayload"
"RTN","C0ISOAP4",19,0)
 ; C0PARMS("format")=format of the output: xml,outline,global - default global
"RTN","C0ISOAP4",20,0)
 ;
"RTN","C0ISOAP4",21,0)
 N C0URL,PAYLOAD,ENVELOP,PLVAR,C0RSLT,HEADER,C0RHDR,C0MIME,XML,XMLLOC,C0MIME
"RTN","C0ISOAP4",22,0)
 ;K @C0RTN
"RTN","C0ISOAP4",23,0)
 S C0URL=$G(C0PARMS("url"))
"RTN","C0ISOAP4",24,0)
 ;I C0URL="" S C0URL="https://54.235.195.41:8443/opencds-decision-support-service-1.0.0-SNAPSHOT/evaluate"
"RTN","C0ISOAP4",25,0)
 ;I C0URL="" S C0URL="http://54.235.195.41:8080/opencds-decision-support-service-1.0.0-SNAPSHOT/evaluate"
"RTN","C0ISOAP4",26,0)
 ;I C0URL="" S C0URL="http://54.235.195.41:8080/opencds-decision-support-service-1.0.0-SNAPSHOT/evaluate"
"RTN","C0ISOAP4",27,0)
 I C0URL="" S C0URL="https://ehr1.opensourcevista.net:9300/opencds-decision-support-service-1.0.0-SNAPSHOT/evaluate"
"RTN","C0ISOAP4",28,0)
 N C0IP,C0PORT,C0SVC
"RTN","C0ISOAP4",29,0)
 S C0IP="23.253.7.224"
"RTN","C0ISOAP4",30,0)
 ;S C0IP="199.180.113.42"
"RTN","C0ISOAP4",31,0)
 ;S C0IP="54.235.195.41"
"RTN","C0ISOAP4",32,0)
 S C0PORT="443"
"RTN","C0ISOAP4",33,0)
 ;S C0SVC="/opencds-decision-support-service-1.0.0-SNAPSHOT/evaluate"
"RTN","C0ISOAP4",34,0)
 S C0SVC="/opencds-decision-support-service/evaluate"
"RTN","C0ISOAP4",35,0)
 S PAYLOAD=$G(C0PARMS("payload"))
"RTN","C0ISOAP4",36,0)
 S OUTPLV=$G(C0PARMS("payloadVarOut"),"outPayload") ; payload variable outgoing
"RTN","C0ISOAP4",37,0)
 S INPLV=$G(C0PARMS("payloadVarIn"),"base64EncodedPayload") ; payload tag incoming
"RTN","C0ISOAP4",38,0)
 S ENVELOP=$G(C0PARMS("envelop"))
"RTN","C0ISOAP4",39,0)
 S C0MIME="content-type: text/soap+xml; charset=utf-8"
"RTN","C0ISOAP4",40,0)
 S HEADER(1)="User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.3074)"
"RTN","C0ISOAP4",41,0)
 S HEADER(2)="Expect: 100-continue"
"RTN","C0ISOAP4",42,0)
 S HEADER(3)="Connection: Keep-Alive"
"RTN","C0ISOAP4",43,0)
 S XMLLOC=$G(C0PARMS("xml")) ; only set as an override - means skipping payload building
"RTN","C0ISOAP4",44,0)
 I XMLLOC'="" M XML=@XMLLOC
"RTN","C0ISOAP4",45,0)
 ;
"RTN","C0ISOAP4",46,0)
 I XMLLOC="" D  ; no complete xml supplied, build the payload
"RTN","C0ISOAP4",47,0)
 . S XMLLOC=$NA(^TMP("ICE",$J,"XML"))
"RTN","C0ISOAP4",48,0)
 . K @XMLLOC
"RTN","C0ISOAP4",49,0)
 . N C0IV
"RTN","C0ISOAP4",50,0)
 . S C0IV(OUTPLV)=$$ENCODE(PAYLOAD)
"RTN","C0ISOAP4",51,0)
 . S C0IV("hl7OutTime")=$$FMDTOUTC^C0CUTIL(DT)
"RTN","C0ISOAP4",52,0)
 . D GETNMAP^C0IUTIL("XML","TENVOUT^C0ITEST","C0IV")
"RTN","C0ISOAP4",53,0)
 . K XML(0)
"RTN","C0ISOAP4",54,0)
 . ;M @XMLLOC=XML
"RTN","C0ISOAP4",55,0)
 . ;W $$GTF^%ZISH($NA(@XMLLOC@(1)),4,"/home/vista/immu-log/",$$FMDTOUTC^JJOHPPCU($$NOW^XLFDT)_"ice-sending.xml") 
"RTN","C0ISOAP4",56,0)
 ;
"RTN","C0ISOAP4",57,0)
 ;M XML=@XMLLOC
"RTN","C0ISOAP4",58,0)
 K C0RSLT,C0RHDR
"RTN","C0ISOAP4",59,0)
 N C0RXML
"RTN","C0ISOAP4",60,0)
 ;
"RTN","C0ISOAP4",61,0)
 ; make the soap call
"RTN","C0ISOAP4",62,0)
 ;
"RTN","C0ISOAP4",63,0)
 ;S ok=$$httpPOST^C0IEWD(C0URL,.XML,C0MIME,.C0RXML,.HEADER) ;,,1) ;for test
"RTN","C0ISOAP4",64,0)
 ;S ok=$$httpPOST^%zewdGTM(C0URL,.XML,C0MIME,.C0RSLT,.HEADER,"",.PARM5,.C0RHDR)
"RTN","C0ISOAP4",65,0)
 N % S %=$$POST1^XUSBSE2(.C0RSLT,C0IP,C0PORT,C0SVC,.XML)
"RTN","C0ISOAP4",66,0)
 B
"RTN","C0ISOAP4",67,0)
 ;
"RTN","C0ISOAP4",68,0)
 ;I $G(C0RXML(2))="" D  Q ;
"RTN","C0ISOAP4",69,0)
 ;. K @C0RTN
"RTN","C0ISOAP4",70,0)
 ;. M @C0RTN=C0RXML
"RTN","C0ISOAP4",71,0)
 ;
"RTN","C0ISOAP4",72,0)
 ; locate and decode the embedded xml
"RTN","C0ISOAP4",73,0)
 ;
"RTN","C0ISOAP4",74,0)
 N %BEG,%END
"RTN","C0ISOAP4",75,0)
 S %BEG="<"_INPLV_">"
"RTN","C0ISOAP4",76,0)
 S %END="</"_INPLV_">"
"RTN","C0ISOAP4",77,0)
 N ALLXML S ALLXML=""
"RTN","C0ISOAP4",78,0)
 N ZI
"RTN","C0ISOAP4",79,0)
 S ZI=""
"RTN","C0ISOAP4",80,0)
 F  S ZI=$O(C0RXML(ZI)) Q:ZI=""  D  ;
"RTN","C0ISOAP4",81,0)
 . S ALLXML=ALLXML_C0RXML(ZI)
"RTN","C0ISOAP4",82,0)
 . ;W !,ZI
"RTN","C0ISOAP4",83,0)
 ;I ALLXML'[%BEG D  B  Q  ;
"RTN","C0ISOAP4",84,0)
 I ALLXML'[%BEG D  Q  ;
"RTN","C0ISOAP4",85,0)
 . ;W !,"ERROR DETECTED",!
"RTN","C0ISOAP4",86,0)
 . ;ZWR C0RXML
"RTN","C0ISOAP4",87,0)
 . N RXML S RXML=$NA(^TMP("ICE",$J,"RETURNXML"))
"RTN","C0ISOAP4",88,0)
 . M @RXML=C0RXML
"RTN","C0ISOAP4",89,0)
 . S @C0RTN=C0RXML
"RTN","C0ISOAP4",90,0)
 ;
"RTN","C0ISOAP4",91,0)
 N XMLBASE64
"RTN","C0ISOAP4",92,0)
 S XMLBASE64=$P($P(ALLXML,%END,1),%BEG,2)
"RTN","C0ISOAP4",93,0)
 N RTNXML
"RTN","C0ISOAP4",94,0)
 S RTNXML(1)=$$DECODER(XMLBASE64)
"RTN","C0ISOAP4",95,0)
 S OK=$$REDUCRCR(.RTNXML,1)
"RTN","C0ISOAP4",96,0)
 N RXML S RXML=$NA(^TMP("ICE",$J,"RETURNXML"))
"RTN","C0ISOAP4",97,0)
 K @RXML
"RTN","C0ISOAP4",98,0)
 M @RXML=RTNXML
"RTN","C0ISOAP4",99,0)
 W $$GTF^%ZISH($NA(@RXML@(1)),4,"/home/vista/immu-log/",$$FMDTOUTC^JJOHPPCU($$NOW^XLFDT)_"ice-return.xml") 
"RTN","C0ISOAP4",100,0)
 ;
"RTN","C0ISOAP4",101,0)
 ;B
"RTN","C0ISOAP4",102,0)
 ;K C0RSLT
"RTN","C0ISOAP4",103,0)
 ;I $D(C0RXML(1)) D  ;
"RTN","C0ISOAP4",104,0)
 ;. D CHUNK("C0RSLT","C0RXML",1000) ;RETURN IN AN ARRAY
"RTN","C0ISOAP4",105,0)
 ;. I $G(C0RSLT("RELOC",1,1))'="" D  ; THERE WAS EMBEDED XML
"RTN","C0ISOAP4",106,0)
 ;. . K C0RXML ; THROW AWAY WRAPPER
"RTN","C0ISOAP4",107,0)
 ;. . M C0RXML=C0RSLT("RELOC",1) ; REPLACE WITH EMBEDDED DOCUMENT 
"RTN","C0ISOAP4",108,0)
 ;
"RTN","C0ISOAP4",109,0)
 I '$D(C0RXML(2)) D  Q  ;
"RTN","C0ISOAP4",110,0)
 . W !,"ERROR DETECTED",!
"RTN","C0ISOAP4",111,0)
 . ZWR C0RXML
"RTN","C0ISOAP4",112,0)
 ;
"RTN","C0ISOAP4",113,0)
 I $G(C0PARMS("format"))="xml" D  Q  ;
"RTN","C0ISOAP4",114,0)
 . M @C0RTN=RTNXML
"RTN","C0ISOAP4",115,0)
 ;
"RTN","C0ISOAP4",116,0)
 ; call the parser
"RTN","C0ISOAP4",117,0)
 N C0IDOCID
"RTN","C0ISOAP4",118,0)
 S C0IDOCID=$$PARSE^C0IEXTR(RXML,"C0IDOC"_$J)
"RTN","C0ISOAP4",119,0)
 ;
"RTN","C0ISOAP4",120,0)
 I $G(C0PARMS("format"))="outline" D  Q  ;
"RTN","C0ISOAP4",121,0)
 . ;S GN=$NA(^TMP("SOAPOUT",$J))
"RTN","C0ISOAP4",122,0)
 . D show^C0IUTIL(1,C0IDOCID,C0RTN)
"RTN","C0ISOAP4",123,0)
 ;
"RTN","C0ISOAP4",124,0)
 ; convert the MXML DOM into a mumps array to return
"RTN","C0ISOAP4",125,0)
 ;
"RTN","C0ISOAP4",126,0)
 D domo3^C0IEXTR(C0RTN)
"RTN","C0ISOAP4",127,0)
 ;
"RTN","C0ISOAP4",128,0)
 ; return all the artifacts here
"RTN","C0ISOAP4",129,0)
 ;
"RTN","C0ISOAP4",130,0)
 Q
"RTN","C0ISOAP4",131,0)
 ;
"RTN","C0ISOAP4",132,0)
EXTRACT(C0RXML)
"RTN","C0ISOAP4",133,0)
 I $G(INPLV)="" S INPLV="base64EncodedPayload"
"RTN","C0ISOAP4",134,0)
 N %BEG,%END
"RTN","C0ISOAP4",135,0)
 S %BEG="<"_INPLV_">"
"RTN","C0ISOAP4",136,0)
 S %END="</"_INPLV_">"
"RTN","C0ISOAP4",137,0)
 N ALLXML S ALLXML=""
"RTN","C0ISOAP4",138,0)
 N ZI
"RTN","C0ISOAP4",139,0)
 S ZI=""
"RTN","C0ISOAP4",140,0)
 F  S ZI=$O(C0RXML(ZI)) Q:ZI=""  D  ;
"RTN","C0ISOAP4",141,0)
 . S ALLXML=ALLXML_C0RXML(ZI)
"RTN","C0ISOAP4",142,0)
 . ;W !,ZI
"RTN","C0ISOAP4",143,0)
 I ALLXML'[%BEG D  Q  ;
"RTN","C0ISOAP4",144,0)
 . W !,"ERROR DETECTED",!
"RTN","C0ISOAP4",145,0)
 . ZWR C0RXML
"RTN","C0ISOAP4",146,0)
 ;
"RTN","C0ISOAP4",147,0)
 N XMLBASE64
"RTN","C0ISOAP4",148,0)
 S XMLBASE64=$P($P(ALLXML,%END,1),%BEG,2)
"RTN","C0ISOAP4",149,0)
 N RTNXML
"RTN","C0ISOAP4",150,0)
 S RTNXML(1)=$$DECODER(XMLBASE64)
"RTN","C0ISOAP4",151,0)
 S OK=$$REDUCRCR(.RTNXML,1)
"RTN","C0ISOAP4",152,0)
 N RXML S RXML=$NA(^TMP("ICE",$J,"RETURNXML"))
"RTN","C0ISOAP4",153,0)
 K @RXML
"RTN","C0ISOAP4",154,0)
 M @RXML=RTNXML
"RTN","C0ISOAP4",155,0)
 W $$GTF^%ZISH($NA(@RXML@(1)),4,"/home/vista/immu-log/",$$FMDTOUTC^JJOHPPCU($$NOW^XLFDT)_"ice-unwrap.xml") 
"RTN","C0ISOAP4",156,0)
 Q
"RTN","C0ISOAP4",157,0)
 ;
"RTN","C0ISOAP4",158,0)
TEST ;
"RTN","C0ISOAP4",159,0)
 ; SOAP testing... get the override request xml from a file
"RTN","C0ISOAP4",160,0)
 N TESTXML
"RTN","C0ISOAP4",161,0)
 S TESTXML=$NA(^TMP("ICE",$J,"XML",1))
"RTN","C0ISOAP4",162,0)
 N ZOK
"RTN","C0ISOAP4",163,0)
 ;S ZOK=$$FTG^%ZISH("/home/vista/immu-log/","ice-test.xml",TESTXML,4)
"RTN","C0ISOAP4",164,0)
 S ZOK=$$FTG^%ZISH("/home/vista/immu-log/","ICE-SOAP-NoImmunizationMessage.xml",TESTXML,4)
"RTN","C0ISOAP4",165,0)
 S TESTXML=$NA(^TMP("ICE",$J,"XML")) ; name to pass as xml parameter
"RTN","C0ISOAP4",166,0)
 ; correct for overflow produced by GTF^%ZISH
"RTN","C0ISOAP4",167,0)
 N ZI S ZI=""
"RTN","C0ISOAP4",168,0)
 N XML
"RTN","C0ISOAP4",169,0)
 F  S ZI=$O(@TESTXML@(ZI)) Q:ZI=""  D  ;
"RTN","C0ISOAP4",170,0)
 . S XML(ZI)=@TESTXML@(ZI)
"RTN","C0ISOAP4",171,0)
 . I $D(@TESTXML@(ZI,"OVF")) D  ;
"RTN","C0ISOAP4",172,0)
 . . N ZJ S ZJ=""
"RTN","C0ISOAP4",173,0)
 . . F  S ZJ=$O(@TESTXML@(ZI,"OVF",ZJ)) Q:ZJ=""  D  ;
"RTN","C0ISOAP4",174,0)
 . . . S XML(ZI)=XML(ZI)_@TESTXML@(ZI,"OVF",ZJ)
"RTN","C0ISOAP4",175,0)
 K @TESTXML
"RTN","C0ISOAP4",176,0)
 M @TESTXML=XML
"RTN","C0ISOAP4",177,0)
 D EXTRACT(.XML)
"RTN","C0ISOAP4",178,0)
 K XML
"RTN","C0ISOAP4",179,0)
 N PARMS
"RTN","C0ISOAP4",180,0)
 S PARMS("xml")=TESTXML
"RTN","C0ISOAP4",181,0)
 S PARMS("url")="http://54.235.195.41:8080/opencds-decision-support-service-1.0.0-SNAPSHOT/evaluate"
"RTN","C0ISOAP4",182,0)
 D SOAP("RETURN",.PARMS)
"RTN","C0ISOAP4",183,0)
 ZWR RETURN
"RTN","C0ISOAP4",184,0)
 W !,"SUCCESS !"
"RTN","C0ISOAP4",185,0)
 Q
"RTN","C0ISOAP4",186,0)
 ;
"RTN","C0ISOAP4",187,0)
TEST2 ;
"RTN","C0ISOAP4",188,0)
 ; SOAP testing... get the request xml from a file, but let SOAP encode and wrap
"RTN","C0ISOAP4",189,0)
 S TESTXML=$NA(^TMP("ICE",$J,"TESTXML",1))
"RTN","C0ISOAP4",190,0)
 N ZOK
"RTN","C0ISOAP4",191,0)
 S ZOK=$$FTG^%ZISH("/home/vista/immu-log/","ice-test.xml",TESTXML,4)
"RTN","C0ISOAP4",192,0)
 ;S ZOK=$$FTG^%ZISH("/home/vista/immu-log/","ICE-SOAP-NoImmunizationMessage.xml",TESTXML,4)
"RTN","C0ISOAP4",193,0)
 S TESTXML=$NA(^TMP("ICE",$J,"TESTXML")) ; name to pass as xml parameter
"RTN","C0ISOAP4",194,0)
 ; correct for overflow produced by GTF^%ZISH
"RTN","C0ISOAP4",195,0)
 N ZI S ZI=""
"RTN","C0ISOAP4",196,0)
 N XML
"RTN","C0ISOAP4",197,0)
 F  S ZI=$O(@TESTXML@(ZI)) Q:ZI=""  D  ;
"RTN","C0ISOAP4",198,0)
 . S XML(ZI)=@TESTXML@(ZI)
"RTN","C0ISOAP4",199,0)
 . I $D(@TESTXML@(ZI,"OVF")) D  ;
"RTN","C0ISOAP4",200,0)
 . . N ZJ S ZJ=""
"RTN","C0ISOAP4",201,0)
 . . F  S ZJ=$O(@TESTXML@(ZI,"OVF",ZJ)) Q:ZJ=""  D  ;
"RTN","C0ISOAP4",202,0)
 . . . S XML(ZI)=XML(ZI)_@TESTXML@(ZI,"OVF",ZJ)
"RTN","C0ISOAP4",203,0)
 K @TESTXML
"RTN","C0ISOAP4",204,0)
 M @TESTXML=XML
"RTN","C0ISOAP4",205,0)
 K XML
"RTN","C0ISOAP4",206,0)
 N PARMS
"RTN","C0ISOAP4",207,0)
 S PARMS("payload")=TESTXML
"RTN","C0ISOAP4",208,0)
 S PARMS("url")="http://54.235.195.41:8080/opencds-decision-support-service-1.0.0-SNAPSHOT/evaluate"
"RTN","C0ISOAP4",209,0)
 D SOAP("RETURN",.PARMS)
"RTN","C0ISOAP4",210,0)
 ZWR RETURN
"RTN","C0ISOAP4",211,0)
 W !,"SUCCESS !"
"RTN","C0ISOAP4",212,0)
 Q
"RTN","C0ISOAP4",213,0)
 ;
"RTN","C0ISOAP4",214,0)
ENCODE(ZXML) ; extrinsic which returns a base64 encoding of the XML, which 
"RTN","C0ISOAP4",215,0)
 ; is passsed by name
"RTN","C0ISOAP4",216,0)
 N ZI,ZS
"RTN","C0ISOAP4",217,0)
 S ZI="" S ZS=""
"RTN","C0ISOAP4",218,0)
 F  S ZI=$O(@ZXML@(ZI)) Q:ZI=""  D  ;
"RTN","C0ISOAP4",219,0)
 . S ZS=ZS_@ZXML@(ZI)
"RTN","C0ISOAP4",220,0)
 Q $$ENCODE^RGUTUU(ZS)
"RTN","C0ISOAP4",221,0)
 ;
"RTN","C0ISOAP4",222,0)
 ; ===================
"RTN","C0ISOAP4",223,0)
NORMAL(OUTXML,INXML) ;NORMALIZES AN XML STRING PASSED BY NAME IN INXML
"RTN","C0ISOAP4",224,0)
 ; INTO AN XML ARRAY RETURNED IN OUTXML, ALSO PASSED BY NAME
"RTN","C0ISOAP4",225,0)
 ;
"RTN","C0ISOAP4",226,0)
 N INBF,ZI,ZN,ZTMP
"RTN","C0ISOAP4",227,0)
 S ZN=1,INBF=@INXML
"RTN","C0ISOAP4",228,0)
 S @OUTXML@(ZN)=$P(INBF,"><",ZN)_">"
"RTN","C0ISOAP4",229,0)
 ; S ZN=ZN+1
"RTN","C0ISOAP4",230,0)
 ; F  S @OUTXML@(ZN)="<"_$P(@INXML,"><",ZN) Q:$P(@INXML,"><",ZN+1)=""  D  ;
"RTN","C0ISOAP4",231,0)
 ; Should speed up, and not leave a dangling node, and doesn't stop at first NULL
"RTN","C0ISOAP4",232,0)
 F ZN=2:1:$L(INBF,"><") S @OUTXML@(ZN)="<"_$P(INBF,"><",ZN)_">"
"RTN","C0ISOAP4",233,0)
 ; . ; S ZN=ZN+1 
"RTN","C0ISOAP4",234,0)
 ; .QUIT
"RTN","C0ISOAP4",235,0)
 QUIT
"RTN","C0ISOAP4",236,0)
 ;  ================
"RTN","C0ISOAP4",237,0)
 ; The goal of this block has changed a little bit.  Most modern MUMPS engines can
"RTN","C0ISOAP4",238,0)
 ; handle a 1,000,000 byte string.  We will use BF to hold hunks that big so that 
"RTN","C0ISOAP4",239,0)
 ; we can logically suck up a big hunk of the input to supply the reblocking of the XML
"RTN","C0ISOAP4",240,0)
 ; into more logical blocks less than 2000 bytes in length blocks.
"RTN","C0ISOAP4",241,0)
 ; A series of signals will be needed, Source (INXML) is exhausted (INEND),
"RTN","C0ISOAP4",242,0)
 ; BF is less than 2200 bytes (BFLD, BuFfer reLoaD)
"RTN","C0ISOAP4",243,0)
 ; BF is Full (BF contains 998,000 bytes or more, BFULL)
"RTN","C0ISOAP4",244,0)
 ; BF and Process is Complete (BFEND)
"RTN","C0ISOAP4",245,0)
 ; ZSIZE defaults to 2,000 now, but can be set lower or higher
"RTN","C0ISOAP4",246,0)
 ;
"RTN","C0ISOAP4",247,0)
CHUNK(OUTXML,INXML,ZSIZE) ; BREAKS INXML INTO ZSIZE BLOCKS
"RTN","C0ISOAP4",248,0)
 ; INXML IS AN ARRAY PASSED BY NAME OF STRINGS
"RTN","C0ISOAP4",249,0)
 ; OUTXML IS ALSO PASSED BY NAME
"RTN","C0ISOAP4",250,0)
 ; IF ZSIZE IS NOT PASSED, 2000 IS USED
"RTN","C0ISOAP4",251,0)
 I '$D(ZSIZE) S ZSIZE=2000 ; DEFAULT BLOCK SIZE
"RTN","C0ISOAP4",252,0)
 N BF,BFEND,BFLD,BFMAX,BFULL,INEND,ZB,ZI,ZJ,ZK,ZL,ZN
"RTN","C0ISOAP4",253,0)
 ; S ZB=ZSIZE-1
"RTN","C0ISOAP4",254,0)
 S ZN=1
"RTN","C0ISOAP4",255,0)
 S BFMAX=998000
"RTN","C0ISOAP4",256,0)
 S ZI=0 ; BEGINNING OF INDEX TO INXML
"RTN","C0ISOAP4",257,0)
 S (BFLD,BFEND,BFULL,INEND)=0,BF=""
"RTN","C0ISOAP4",258,0)
 ; Major loop loads the buffer, BF, and unloads it into the Output Array
"RTN","C0ISOAP4",259,0)
 ;  in 
"RTN","C0ISOAP4",260,0)
 F  D  Q:BFEND
"RTN","C0ISOAP4",261,0)
 . ; Input LOADER
"RTN","C0ISOAP4",262,0)
 . D:'INEND
"RTN","C0ISOAP4",263,0)
 . . F  S ZI=$O(@INXML@(ZI)) S INEND=(ZI="")  Q:INEND!BFULL  D   ; LOAD EACH STRING IN INXML
"RTN","C0ISOAP4",264,0)
 . . . S BF=BF_@INXML@(ZI)                                       ; ADD TO THE BF STRING
"RTN","C0ISOAP4",265,0)
 . . . S BFULL=($L(BF)>BFMAX)
"RTN","C0ISOAP4",266,0)
 . . .QUIT
"RTN","C0ISOAP4",267,0)
 . .QUIT
"RTN","C0ISOAP4",268,0)
 . ;  Full Buffer, BF, now check for Encryption and Unpack
"RTN","C0ISOAP4",269,0)
 . D TEST4COD(.BF,"C0RSLT(""RELOC"")")
"RTN","C0ISOAP4",270,0)
 . ; Output BREAKER
"RTN","C0ISOAP4",271,0)
 . F  Q:BFLD  D   ; ZJ=1:ZSIZE:ZL D  ;
"RTN","C0ISOAP4",272,0)
 . . ; ZK=$S(ZJ+ZB<ZL:ZJ+ZB,1:ZL) ; END FOR EXTRACT
"RTN","C0ISOAP4",273,0)
 . . F ZK=ZSIZE:-1:0  Q:$E(BF,ZK)=">"
"RTN","C0ISOAP4",274,0)
 . . I ZK=0 S ZK=ZSIZE
"RTN","C0ISOAP4",275,0)
 . . S @OUTXML@(ZN)=$E(BF,1,ZK) ; PULL OUT THE PIECE
"RTN","C0ISOAP4",276,0)
 . . S ZN=ZN+1 ; INCREMENT OUT ARRAY INDEX
"RTN","C0ISOAP4",277,0)
 . . S BF=$E(BF,ZK+1,BFMAX)
"RTN","C0ISOAP4",278,0)
 . . S BFLD=($L(BF)<(ZSIZE*2))
"RTN","C0ISOAP4",279,0)
 . .QUIT
"RTN","C0ISOAP4",280,0)
 . S BFEND=(INEND&BFLD)!(">"[BF)
"RTN","C0ISOAP4",281,0)
 . I $L(BF)&BFEND S @OUTXML@(ZN)=BF,BF=""
"RTN","C0ISOAP4",282,0)
 .QUIT
"RTN","C0ISOAP4",283,0)
 QUIT
"RTN","C0ISOAP4",284,0)
 ;  ==============
"RTN","C0ISOAP4",285,0)
 ; Test for Encryption, extract it and decode it.
"RTN","C0ISOAP4",286,0)
TEST4COD(INBF,RELOC) 
"RTN","C0ISOAP4",287,0)
 N DBF,I,MSK,TBF,TRG,RCNT
"RTN","C0ISOAP4",288,0)
 S RCNT=0
"RTN","C0ISOAP4",289,0)
 ;  Segments expected <seg 1>DATA</seg 1><seg 2>DATA</seg 2>
"RTN","C0ISOAP4",290,0)
 ;                           ^   ^
"RTN","C0ISOAP4",291,0)
 S MSK=""   ; It turns out that some of the characters used were not reliable
"RTN","C0ISOAP4",292,0)
 F I=32:1:42,44:1:47,62:1:64,91:1:96 S MSK=MSK_$C(I)
"RTN","C0ISOAP4",293,0)
 F I=1:1:$L(INBF,"</")-1 D
"RTN","C0ISOAP4",294,0)
 . S TBF=$RE($P($RE($P(INBF,"</",I)),">"))
"RTN","C0ISOAP4",295,0)
 . ; Remove sample for testing
"RTN","C0ISOAP4",296,0)
 . ; Set the trigger, mostly included to show intent and associated code
"RTN","C0ISOAP4",297,0)
 . ;  this could be refined later if determined already obvious enough
"RTN","C0ISOAP4",298,0)
 . S TRG=0
"RTN","C0ISOAP4",299,0)
 . DO:$L(TBF)>20  ; If $TR doesn't remove anything, then these characters are not there
"RTN","C0ISOAP4",300,0)
 . . I (TBF=$TR(TBF,MSK))   S TRG=1
"RTN","C0ISOAP4",301,0)
 . . ; I (TBF=$TR(TBF," <->@*!?.,:;#$%&[/|\]={}~")) S TRG=1
"RTN","C0ISOAP4",302,0)
 . . ;   <>!"#$%&'()*,-./67:;<>?@[\]^_`fqr{|}~  <<= Ignore 6,7,f,q, and r
"RTN","C0ISOAP4",303,0)
 . . ; Now we set up for the DECODE and replacement in INBF
"RTN","C0ISOAP4",304,0)
 . . DO:TRG
"RTN","C0ISOAP4",305,0)
 . . . N A,C,CC,CV,CCX,K,XBF,T,V
"RTN","C0ISOAP4",306,0)
 . . . DO
"RTN","C0ISOAP4",307,0)
 . . . . N I
"RTN","C0ISOAP4",308,0)
 . . . . S DBF=$$DECODER(TBF)
"RTN","C0ISOAP4",309,0)
 . . . .QUIT
"RTN","C0ISOAP4",310,0)
 . . . ;
"RTN","C0ISOAP4",311,0)
 . . . S CCX=""
"RTN","C0ISOAP4",312,0)
 . . . F K=1:1:$L(DBF) S CC=$E(DBF,K) S:CC?1C C=$A(CC),A(C)=$G(A(C))+1
"RTN","C0ISOAP4",313,0)
 . . . S C="",V=""
"RTN","C0ISOAP4",314,0)
 . . . F  S C=$O(A(C)) Q:C=""  S CCX=CCX_$C(C) S:A(C)>V V=A(C),CV=C
"RTN","C0ISOAP4",315,0)
 . . . S CC=$C(CV)
"RTN","C0ISOAP4",316,0)
 . . . ;  The "_$C(13,10)_" may need to be generalized, tested and set earlier
"RTN","C0ISOAP4",317,0)
 . . . ;    Expand embedded XML in XBF
"RTN","C0ISOAP4",318,0)
 . . . F K=1:1:$L(DBF,CC) S T=$P(DBF,CC,K),XBF(K)=$TR(T,CCX)
"RTN","C0ISOAP4",319,0)
 . . . S RCNT=RCNT+1
"RTN","C0ISOAP4",320,0)
 . . . M @RELOC@(RCNT)=XBF
"RTN","C0ISOAP4",321,0)
 . . . ;   Curley braces and = makes it so it won't trigger a second time by retest.                                
"RTN","C0ISOAP4",322,0)
 . . . S INBF=$P(INBF,TBF)_"<{REPLACED}="_RCNT_$P(INBF,TBF,2,999)
"RTN","C0ISOAP4",323,0)
 . . .QUIT
"RTN","C0ISOAP4",324,0)
 . .QUIT
"RTN","C0ISOAP4",325,0)
 .QUIT
"RTN","C0ISOAP4",326,0)
 ;  Now shorten the INBF so it gets smaller
"RTN","C0ISOAP4",327,0)
 ;S INBF=$P(INBF,">",I+1,99999)
"RTN","C0ISOAP4",328,0)
 QUIT
"RTN","C0ISOAP4",329,0)
 ;  ===================
"RTN","C0ISOAP4",330,0)
DECODER(BF) ; Decrypts the Encrypted Strings
"RTN","C0ISOAP4",331,0)
 QUIT $$DECODE^RGUTUU(BF)
"RTN","C0ISOAP4",332,0)
 ;  ===================
"RTN","C0ISOAP4",333,0)
NORMAL2(OUTXML,INXML) ;NORMALIZES AN ARRAY OF XML STRINGS PASSED BY NAME INXML
"RTN","C0ISOAP4",334,0)
 ; AS @INXML@(1) TO @INXML@(x) ALL NUMERIC
"RTN","C0ISOAP4",335,0)
 ; INTO AN XML ARRAY RETURNED IN OUTXML, ALSO PASSED BY NAME
"RTN","C0ISOAP4",336,0)
 ; this routine doesn't work unless the blocks are on xml tag boundaries - gpl
"RTN","C0ISOAP4",337,0)
 ; which is hard to do... this routine is left here awaiting future development
"RTN","C0ISOAP4",338,0)
 N ZI,ZN,ZJ
"RTN","C0ISOAP4",339,0)
 S ZJ=0
"RTN","C0ISOAP4",340,0)
 S ZN=1
"RTN","C0ISOAP4",341,0)
 F  S ZJ=$O(@INXML@(ZJ)) Q:+ZJ=0  D  ; FOR EACH XML STRING IN ARRAY
"RTN","C0ISOAP4",342,0)
 . S @OUTXML@(ZN)=$P(@INXML@(ZJ),"><",ZN)_">"
"RTN","C0ISOAP4",343,0)
 . S ZN=ZN+1
"RTN","C0ISOAP4",344,0)
 . F  S @OUTXML@(ZN)="<"_$P(@INXML@(ZJ),"><",ZN) Q:$P(@INXML@(ZJ),"><",ZN+1)=""  D  ;
"RTN","C0ISOAP4",345,0)
 . . S @OUTXML@(ZN)=@OUTXML@(ZN)_">"
"RTN","C0ISOAP4",346,0)
 . . S ZN=ZN+1
"RTN","C0ISOAP4",347,0)
 . .QUIT
"RTN","C0ISOAP4",348,0)
 .QUIT
"RTN","C0ISOAP4",349,0)
 QUIT
"RTN","C0ISOAP4",350,0)
 ;  ===============
"RTN","C0ISOAP4",351,0)
 ;
"RTN","C0ISOAP4",352,0)
UNWRAP(ZXML,ZI,ZNOM) ; EXTRINSIC TO LOCATE, DECODE AND PARSE AN EMBEDED XML DOC
"RTN","C0ISOAP4",353,0)
 ; RETURNS THE DOCID OF THE DOM
"RTN","C0ISOAP4",354,0)
 N ZS,ZX
"RTN","C0ISOAP4",355,0)
 S ZS=$P($P(@ZXML@(ZI),">",2),"<",1) ; PULL OUT THE ENCODED STRING
"RTN","C0ISOAP4",356,0)
 S ZX=$$DECODE^RGUTUU(ZS)
"RTN","C0ISOAP4",357,0)
 N ZZ
"RTN","C0ISOAP4",358,0)
 N ZY S ZY="<?xml version=""1.0"" encoding=""utf-8""?>"
"RTN","C0ISOAP4",359,0)
 I $E(ZX,1,5)'="<?xml" S ZZ(1)=ZY_ZX
"RTN","C0ISOAP4",360,0)
 E  S ZZ(1)=ZX
"RTN","C0ISOAP4",361,0)
 N ZI
"RTN","C0ISOAP4",362,0)
 ;F ZI=1:1 Q:$$REDUCE(.ZZ,ZI) ; CHOP THE STRING INTO 4000 CHAR ARRAY
"RTN","C0ISOAP4",363,0)
 S ZI=$$REDUCRCR(.ZZ,1) ; RECURSIVE VERSION OF REDUCE
"RTN","C0ISOAP4",364,0)
 S G=$$PARSE^C0XEWD("ZZ",C0NOM)
"RTN","C0ISOAP4",365,0)
 ; GTM Specific
"RTN","C0ISOAP4",366,0)
 ; I G=0 ZWR ^TMP("MXMLERR",$J,*) B
"RTN","C0ISOAP4",367,0)
 QUIT G
"RTN","C0ISOAP4",368,0)
 ;  =============
"RTN","C0ISOAP4",369,0)
REDUCE(ZARY,ZN) ; WILL REDUCE ZARY(ZN) BY CHOPPING IT TO 4000 CHARS
"RTN","C0ISOAP4",370,0)
 ; AND PUTTING THE REST IN ZARY(ZN+1)
"RTN","C0ISOAP4",371,0)
 ; ZARY IS PASSED BY REFERENCE
"RTN","C0ISOAP4",372,0)
 ; EXTRINSIC WHICH RETURNS FALSE IF THERE IS NOTHING TO REDUCE
"RTN","C0ISOAP4",373,0)
 I $L(ZARY(ZN))<4001   QUIT 0 ;NOTHING TO REDUCE
"RTN","C0ISOAP4",374,0)
 ;
"RTN","C0ISOAP4",375,0)
 S ZARY(ZN+1)=$E(ZARY(ZN),4001,$L(ZZ(ZN))) ;BREAK IT UP
"RTN","C0ISOAP4",376,0)
 S ZARY(ZN)=$E(ZARY(ZN),1,4000) ;  
"RTN","C0ISOAP4",377,0)
 QUIT 1  ;ACTUALLY REDUCED
"RTN","C0ISOAP4",378,0)
 ;  ===========
"RTN","C0ISOAP4",379,0)
REDUCRCR(ZARY,ZN) ; RECURSIVE VERSION OF REDUCE ABOVE
"RTN","C0ISOAP4",380,0)
 ; WILL REDUCE ZARY(ZN) BY CHOPPING IT TO 4000 CHARS
"RTN","C0ISOAP4",381,0)
 ; AND PUTTING THE REST IN ZARY(ZN+1)
"RTN","C0ISOAP4",382,0)
 ; ZARY IS PASSED BY REFERENCE
"RTN","C0ISOAP4",383,0)
 ; EXTRINSIC WHICH RETURNS FALSE IF THERE IS NOTHING TO REDUCE
"RTN","C0ISOAP4",384,0)
 I $L(ZARY(ZN))<4001 Q 0 ;NOTHING TO REDUCE
"RTN","C0ISOAP4",385,0)
 ; 
"RTN","C0ISOAP4",386,0)
 S ZARY(ZN+1)=$E(ZARY(ZN),4001,$L(ZARY(ZN))) ;BREAK IT UP
"RTN","C0ISOAP4",387,0)
 S ZARY(ZN)=$E(ZARY(ZN),1,4000) ;  
"RTN","C0ISOAP4",388,0)
 I '$$REDUCRCR(.ZARY,ZN+1) Q 1 ; CALL RECURSIVELY
"RTN","C0ISOAP4",389,0)
 ;  
"RTN","C0ISOAP4",390,0)
 QUIT 1  ;ACTUALLY REDUCED
"RTN","C0ISOAP4",391,0)
 ;  ===========
"RTN","C0ISOAP4",392,0)
DEMUXARY(OARY,IARY) ;CONVERT AN XPATH ARRAY PASSED AS IARY TO
"RTN","C0ISOAP4",393,0)
 ; FORMAT @OARY@(x,xpath) where x is the first multiple
"RTN","C0ISOAP4",394,0)
 N ZI,ZJ,ZK,ZL S ZI=""
"RTN","C0ISOAP4",395,0)
 F  S ZI=$O(@IARY@(ZI)) Q:ZI=""  D  ;
"RTN","C0ISOAP4",396,0)
 . D DEMUX^C0CMXP("ZJ",ZI)
"RTN","C0ISOAP4",397,0)
 . S ZK=$P(ZJ,"^",3)
"RTN","C0ISOAP4",398,0)
 . S ZK=$RE($P($RE(ZK),"/",1))
"RTN","C0ISOAP4",399,0)
 . S ZL=$P(ZJ,"^",1)
"RTN","C0ISOAP4",400,0)
 . I ZL="" S ZL=1
"RTN","C0ISOAP4",401,0)
 . S @OARY@(ZL,ZK)=@IARY@(ZI)
"RTN","C0ISOAP4",402,0)
 .QUIT
"RTN","C0ISOAP4",403,0)
 QUIT
"RTN","C0ISOAP4",404,0)
 ;
"RTN","C0ITEST")
0^5^B240245143
"RTN","C0ITEST",1,0)
C0ITEST ; GPL/NEA - Immunizations Forecasting Routine ;05/03/14  17:05
"RTN","C0ITEST",2,0)
 ;;0.1;Immunizations Forecasting;nopatch;noreleasedate;Build 1
"RTN","C0ITEST",3,0)
 ;
"RTN","C0ITEST",4,0)
 ; License Apache 2
"RTN","C0ITEST",5,0)
 ; 
"RTN","C0ITEST",6,0)
 Q
"RTN","C0ITEST",7,0)
 ;
"RTN","C0ITEST",8,0)
EN(WRK,DFN,PARMS) ;
"RTN","C0ITEST",9,0)
 K WRK
"RTN","C0ITEST",10,0)
 N C0ARY,G,C0IPOA,CPTMAP,CVXMAP,CPTIMAP,CVXIMAP
"RTN","C0ITEST",11,0)
 D CPTMAP^C0ITEST
"RTN","C0ITEST",12,0)
 D CVXMAP^C0ITEST
"RTN","C0ITEST",13,0)
 D CPTIMAP^C0ITEST
"RTN","C0ITEST",14,0)
 D CVXIMAP^C0ITEST
"RTN","C0ITEST",15,0)
 D PAYOUTAV^C0ITEST
"RTN","C0ITEST",16,0)
 D PAYOUTBV^C0ITEST
"RTN","C0ITEST",17,0)
 D GET^C0IUTIL("WRK","TPAYOUTC^C0ITEST")
"RTN","C0ITEST",18,0)
 D PAYOUTDV^C0ITEST
"RTN","C0ITEST",19,0)
 D GET^C0IUTIL("WRK","TPAYOUTE^C0ITEST")
"RTN","C0ITEST",20,0)
 M ^TMP("C0IWRK",$J)=WRK
"RTN","C0ITEST",21,0)
 S OK=$$GTF^%ZISH($NA(^TMP("C0IWRK",$J,1)),3,"/home/vista/","ice-test.xml")
"RTN","C0ITEST",22,0)
 K WRK(0)
"RTN","C0ITEST",23,0)
 Q
"RTN","C0ITEST",24,0)
 ;
"RTN","C0ITEST",25,0)
TEST1 ;
"RTN","C0ITEST",26,0)
 S DFN=$$PAT^C0IICE()
"RTN","C0ITEST",27,0)
 K WRK
"RTN","C0ITEST",28,0)
 D CPTMAP
"RTN","C0ITEST",29,0)
 D CVXMAP
"RTN","C0ITEST",30,0)
 D CPTIMAP
"RTN","C0ITEST",31,0)
 D CVXIMAP
"RTN","C0ITEST",32,0)
 D PAYOUTAV
"RTN","C0ITEST",33,0)
 D PAYOUTBV
"RTN","C0ITEST",34,0)
 D GET^C0IUTIL("WRK","TPAYOUTC^C0ITEST")
"RTN","C0ITEST",35,0)
 D PAYOUTDV
"RTN","C0ITEST",36,0)
 D GET^C0IUTIL("WRK","TPAYOUTE^C0ITEST")
"RTN","C0ITEST",37,0)
 M ^TMP("C0IWRK",$J)=WRK
"RTN","C0ITEST",38,0)
 W $$GTF^%ZISH($NA(^TMP("C0IWRK",$J,1)),3,"/home/vista/","ice-test.xml")
"RTN","C0ITEST",39,0)
 Q
"RTN","C0ITEST",40,0)
 ; get patient DFN
"RTN","C0ITEST",41,0)
 ; get patient VPR demographics for sex and DOB
"RTN","C0ITEST",42,0)
 ; call VPR to get patient Immunizaitons
"RTN","C0ITEST",43,0)
 ; 
"RTN","C0ITEST",44,0)
 ; begin building SOAP request XML
"RTN","C0ITEST",45,0)
 ; loop through immunizations array and generate XML pieces
"RTN","C0ITEST",46,0)
 ; call build to put all the pieces together into one XML array
"RTN","C0ITEST",47,0)
 ; base64 encode the XML array
"RTN","C0ITEST",48,0)
 ;
"RTN","C0ITEST",49,0)
TENVOUT ; build SOAP envelope
"RTN","C0ITEST",50,0)
 ;;<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope"> 
"RTN","C0ITEST",51,0)
 ;;<S:Body>
"RTN","C0ITEST",52,0)
 ;;<ns2:evaluateAtSpecifiedTime xmlns:ns2="http://www.omg.org/spec/CDSS/201105/dss">
"RTN","C0ITEST",53,0)
 ;;<interactionId scopingEntityId="gov.nyc.health" interactionId="123456"/>
"RTN","C0ITEST",54,0)
 ;;<specifiedTime>@@hl7OutTime@@</specifiedTime>
"RTN","C0ITEST",55,0)
 ;;<evaluationRequest clientLanguage="" clientTimeZoneOffset="">
"RTN","C0ITEST",56,0)
 ;;<kmEvaluationRequest>
"RTN","C0ITEST",57,0)
 ;;<kmId scopingEntityId="org.nyc.cir" businessId="ICE" version="1.0.0"/>
"RTN","C0ITEST",58,0)
 ;;</kmEvaluationRequest>
"RTN","C0ITEST",59,0)
 ;;<dataRequirementItemData>
"RTN","C0ITEST",60,0)
 ;;<driId itemId="cdsPayload">
"RTN","C0ITEST",61,0)
 ;;<containingEntityId scopingEntityId="gov.nyc.health" businessId="ICEData" version="1.0.0.0"/>
"RTN","C0ITEST",62,0)
 ;;</driId>
"RTN","C0ITEST",63,0)
 ;;<data>
"RTN","C0ITEST",64,0)
 ;;<informationModelSSId scopingEntityId="org.opencds.vmr" businessId="VMR" version="1.0"/>
"RTN","C0ITEST",65,0)
 ;;<base64EncodedPayload>@@outPayload@@</base64EncodedPayload>
"RTN","C0ITEST",66,0)
 ;;</data>
"RTN","C0ITEST",67,0)
 ;;</dataRequirementItemData>
"RTN","C0ITEST",68,0)
 ;;</evaluationRequest>
"RTN","C0ITEST",69,0)
 ;;</ns2:evaluateAtSpecifiedTime>
"RTN","C0ITEST",70,0)
 ;; </S:Body>
"RTN","C0ITEST",71,0)
 ;; </S:Envelope>
"RTN","C0ITEST",72,0)
 Q
"RTN","C0ITEST",73,0)
ENVOUTV ; create beginning of envelop
"RTN","C0ITEST",74,0)
 K C0IARY
"RTN","C0ITEST",75,0)
 S C0IARY("hl7OutTime")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0ITEST",76,0)
 D GETNMAP^C0IUTIL("WRK","TENVOUT^C0ITEST","C0IARY")
"RTN","C0ITEST",77,0)
 Q
"RTN","C0ITEST",78,0)
TPAYOUTA ; First part of payload message with Sex and DOB and a UUID variables
"RTN","C0ITEST",79,0)
 ;;<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
"RTN","C0ITEST",80,0)
 ;;<ns4:cdsInput xmlns:ns2="org.opencds" xmlns:ns3="org.opencds.vmr.v1_0.schema.vmr" xmlns:ns4="org.opencds.vmr.v1_0.schema.cdsinput" xmlns:ns5="org.opencds.vmr.v1_0.schema.cdsoutput">
"RTN","C0ITEST",81,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.1.1"/>
"RTN","C0ITEST",82,0)
 ;;<cdsContext>
"RTN","C0ITEST",83,0)
 ;;<cdsSystemUserPreferredLanguage code="en" codeSystem="2.16.840.1.113883.6.99" displayName="English"/>
"RTN","C0ITEST",84,0)
 ;;</cdsContext>
"RTN","C0ITEST",85,0)
 ;;<vmrInput>
"RTN","C0ITEST",86,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.1.1"/>
"RTN","C0ITEST",87,0)
 ;;<patient>
"RTN","C0ITEST",88,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.2.1.1"/>
"RTN","C0ITEST",89,0)
 ;;<id root="@@UUID0@@"/>
"RTN","C0ITEST",90,0)
 ;;<demographics>
"RTN","C0ITEST",91,0)
 ;;<birthTime value="@@DOB@@"/>
"RTN","C0ITEST",92,0)
 ;;<gender code="@@genderCode@@" codeSystem="2.16.840.1.113883.5.1" displayName="@@genderName@@" originalText="@@genderCode@@"/>
"RTN","C0ITEST",93,0)
 ;;</demographics>
"RTN","C0ITEST",94,0)
 ;;<clinicalStatements>
"RTN","C0ITEST",95,0)
 Q
"RTN","C0ITEST",96,0)
 ;
"RTN","C0ITEST",97,0)
PAYOUTAV ; setting payload variables sex, DOB and UUID for the first section (PAYOUTA)
"RTN","C0ITEST",98,0)
 K C0IPOA
"RTN","C0ITEST",99,0)
 S X=$$GET1^DIQ(2,DFN,"DOB","I")
"RTN","C0ITEST",100,0)
 S C0IPOA("UUID0")=$$UUID^C0IUTIL
"RTN","C0ITEST",101,0)
 S C0IPOA("DOB")=$$FMDTOCDA^C0IUTIL(X)
"RTN","C0ITEST",102,0)
 S C0IPOA("genderCode")=$$GET1^DIQ(2,DFN,"SEX","I")
"RTN","C0ITEST",103,0)
 I C0IPOA("genderCode")="M" S C0IPOA("genderName")="Male"
"RTN","C0ITEST",104,0)
 I C0IPOA("genderCode")="F" S C0IPOA("genderName")="Female"
"RTN","C0ITEST",105,0)
 I C0IPOA("genderCode")="UN" S C0IPOA("genderName")="Undifferentiated" ; ICE term, not VISTA  VistA allow M F only.P
"RTN","C0ITEST",106,0)
 D GETNMAP^C0IUTIL("WRK","TPAYOUTA^C0ITEST","C0IPOA") 
"RTN","C0ITEST",107,0)
 Q
"RTN","C0ITEST",108,0)
 ;
"RTN","C0ITEST",109,0)
PAYOUTB ;
"RTN","C0ITEST",110,0)
 ;;;Disease an immunity section which is optional. the DISEASE_DOCUMENTED and IS_IMMUNE
"RTN","C0ITEST",111,0)
 ;;;Cycle through 6 diseases using reminders to check for prior diagnosis
"RTN","C0ITEST",112,0)
 ;;;Hep A: 070.1
"RTN","C0ITEST",113,0)
 ;;;Hep B: 070.3
"RTN","C0ITEST",114,0)
 ;;;Measles: 055.9
"RTN","C0ITEST",115,0)
 ;;;Mumps: 072.9
"RTN","C0ITEST",116,0)
 ;;;Rubella: 056.9
"RTN","C0ITEST",117,0)
 ;;;Varicella: 052.9
"RTN","C0ITEST",118,0)
 ;;;First Tag for this section if any prior diagnoses are available
"RTN","C0ITEST",119,0)
 ;;<observationResults>
"RTN","C0ITEST",120,0)
 Q
"RTN","C0ITEST",121,0)
 ;
"RTN","C0ITEST",122,0)
PAYOUTM ;
"RTN","C0ITEST",123,0)
 ;;;Populate this section for each disease found leading to immunity
"RTN","C0ITEST",124,0)
 ;;<observationResult>
"RTN","C0ITEST",125,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.6.3.1"/>
"RTN","C0ITEST",126,0)
 ;;<id root="@@UUIDA@@"/>
"RTN","C0ITEST",127,0)
 ;;<observationFocus code="@@codeICD9@@" codeSystem="2.16.840.1.113883.6.103" displayName="@@codeName@@" originalText="@@codeICD9@@"/>
"RTN","C0ITEST",128,0)
 ;;<observationEventTime low="@@timeProblem@@" high="@@timeProblem@@"/>
"RTN","C0ITEST",129,0)
 ;;<observationValue>
"RTN","C0ITEST",130,0)
 ;;<concept code="DISEASE_DOCUMENTED" codeSystem="2.16.840.1.113883.3.795.12.100.8" displayName="Disease Documented" originalText="DISEASE_DOCUMENTED"/>
"RTN","C0ITEST",131,0)
 ;;</observationValue>
"RTN","C0ITEST",132,0)
 ;;<interpretation code="IS_IMMUNE" codeSystem="2.16.840.1.113883.3.795.12.100.9" displayName="Is Immune" originalText="IS_IMMUNE"/>
"RTN","C0ITEST",133,0)
 ;;</observationResult>
"RTN","C0ITEST",134,0)
 Q
"RTN","C0ITEST",135,0)
 ;
"RTN","C0ITEST",136,0)
PAYOUTN ;
"RTN","C0ITEST",137,0)
 ;;;Finishes off the disease section if there is one
"RTN","C0ITEST",138,0)
 ;;</observationResults>
"RTN","C0ITEST",139,0)
 Q
"RTN","C0ITEST",140,0)
PAYOUTBV ;
"RTN","C0ITEST",141,0)
 ;Placeholder for logic and variables for populating the DISEASE_DOCUMENTED and IS_IMMUNE
"RTN","C0ITEST",142,0)
 ;Diseases Hep A, Hep B, Measles, Mumps, Rubella, Varicella only as of 5/2014,
"RTN","C0ITEST",143,0)
 ;If N is 0 after using reminders to test for the diseases in the taxonomies, then skip this section
"RTN","C0ITEST",144,0)
 ;If more than one of these present, use the needed disease tags to write this part of the message
"RTN","C0ITEST",145,0)
 ;NEED TO REPLACE HARD CODED REMINDER IENS WITH A LOOKUP!!!
"RTN","C0ITEST",146,0)
 N IENHEPA,IENHEPB,IENMEASL,IENVARIC,IENMUMPS,IENRUBEL 
"RTN","C0ITEST",147,0)
 S (IENHEPA,IENHEPB,IENMEASL,IENVARIC,IENMUMPS,IENRUBEL)=""
"RTN","C0ITEST",148,0)
 N FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG
"RTN","C0ITEST",149,0)
 S FILE=811.9 
"RTN","C0ITEST",150,0)
 S IENS=""
"RTN","C0ITEST",151,0)
 S FLAGS="OQ"
"RTN","C0ITEST",152,0)
 S INDEX="B"
"RTN","C0ITEST",153,0)
 S SCREEN=""
"RTN","C0ITEST",154,0)
 S EMSG=""
"RTN","C0ITEST",155,0)
 N N,HEPA,HEPB,VARICEL,MUMPS,MEASLES,RUBELLA
"RTN","C0ITEST",156,0)
 S (N,HEPA,HEPB,VARICEL,MUMPS,MEASLES,RUBELLA)=0
"RTN","C0ITEST",157,0)
 K ^TMP("PXRHM",$J)
"RTN","C0ITEST",158,0)
 N REMNAME S REMNAME="VIMM-HEPATITIS B DIAGNOSIS"
"RTN","C0ITEST",159,0)
 S IENHEPB=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0ITEST",160,0)
 I IENHEPB="" Q  ; reminder not found, skip this part
"RTN","C0ITEST",161,0)
 K REMNAME
"RTN","C0ITEST",162,0)
 D MAIN^PXRM(DFN,IENHEPB,0)
"RTN","C0ITEST",163,0)
 I $G(^TMP("PXRHM",$J,IENHEPB,"VIMM-HEPATITIS B DIAGNOSIS"))["DUE NOW" S N=N+1 S HEPB=1
"RTN","C0ITEST",164,0)
 ;W "HEPB=",HEPB,!
"RTN","C0ITEST",165,0)
 K ^TMP("PXRHM",$J)
"RTN","C0ITEST",166,0)
 N REMNAME S REMNAME="VIMM-HEPATITIS A DIAGNOSIS"
"RTN","C0ITEST",167,0)
 S IENHEPA=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG) 
"RTN","C0ITEST",168,0)
 K REMNAME
"RTN","C0ITEST",169,0)
 D MAIN^PXRM(DFN,IENHEPA,0)
"RTN","C0ITEST",170,0)
 I $G(^TMP("PXRHM",$J,IENHEPA,"VIMM-HEPATITIS A DIAGNOSIS"))["DUE NOW" S N=N+1 S HEPA=1
"RTN","C0ITEST",171,0)
 ;W "HEPA=",HEPA,!
"RTN","C0ITEST",172,0)
 K ^TMP("PXRHM",$J)
"RTN","C0ITEST",173,0)
 N REMNAME S REMNAME="VIMM-VARICELLA DIAGNOSIS"
"RTN","C0ITEST",174,0)
 S IENVARIC=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0ITEST",175,0)
 K REMNAME
"RTN","C0ITEST",176,0)
 D MAIN^PXRM(DFN,IENVARIC,0)
"RTN","C0ITEST",177,0)
 I $G(^TMP("PXRHM",$J,IENVARIC,"VIMM-VARICELLA DIAGNOSIS"))["DUE NOW" S N=N+1 S VARICEL=1
"RTN","C0ITEST",178,0)
 ;W "VARICEL=",VARICEL,!
"RTN","C0ITEST",179,0)
 K ^TMP("PXRHM",$J)
"RTN","C0ITEST",180,0)
 N REMNAME S REMNAME="VIMM-MUMPS DIAGNOSIS" 
"RTN","C0ITEST",181,0)
 S IENMUMPS=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG) D MAIN^PXRM(DFN,267,0)
"RTN","C0ITEST",182,0)
 K REMNME
"RTN","C0ITEST",183,0)
 D MAIN^PXRM(DFN,IENMUMPS,0)
"RTN","C0ITEST",184,0)
 I $G(^TMP("PXRHM",$J,IENMUMPS,"VIMM-MUMPS DIAGNOSIS"))["DUE NOW" S N=N+1 S MUMPS=1
"RTN","C0ITEST",185,0)
 ;W "MUMPS=",MUMPS,!
"RTN","C0ITEST",186,0)
 K ^TMP("PXRHM",$J)
"RTN","C0ITEST",187,0)
 N REMNAME S REMNAME="VIMM-MEASLES DIAGNOSIS"
"RTN","C0ITEST",188,0)
 S IENMEASL=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0ITEST",189,0)
 K REMNAME
"RTN","C0ITEST",190,0)
 D MAIN^PXRM(DFN,IENMEASL,0)
"RTN","C0ITEST",191,0)
 I $G(^TMP("PXRHM",$J,IENMEASL,"VIMM-MEASLES DIAGNOSIS"))["DUE NOW" S N=N+1 S MEASLES=1
"RTN","C0ITEST",192,0)
 ;W "MEASLES=",MEASLES,!
"RTN","C0ITEST",193,0)
 K ^TMP("PXRHM",$J)
"RTN","C0ITEST",194,0)
 N REMNAME S REMNAME="VIMM-RUBELLA DIAGNOSIS"
"RTN","C0ITEST",195,0)
 S IENRUBEL=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0ITEST",196,0)
 K REMNAME
"RTN","C0ITEST",197,0)
 D MAIN^PXRM(DFN,IENRUBEL,0)
"RTN","C0ITEST",198,0)
 I $G(^TMP("PXRHM",$J,IENRUBEL,"VIMM-RUBELLA DIAGNOSIS"))["DUE NOW" S N=N+1 S RUBELLA=1
"RTN","C0ITEST",199,0)
 ;W "RUBELLA=",RUBELLA,!
"RTN","C0ITEST",200,0)
 K ^TMP("PXRHM",$J)
"RTN","C0ITEST",201,0)
 I N=0 Q
"RTN","C0ITEST",202,0)
 E  D
"RTN","C0ITEST",203,0)
 .D GETNMAP^C0IUTIL("WRK","PAYOUTB^C0ITEST","C0IPOA")
"RTN","C0ITEST",204,0)
 .I HEPB=1 D HEPB
"RTN","C0ITEST",205,0)
 .I HEPA=1 D HEPA
"RTN","C0ITEST",206,0)
 .I VARICEL=1 D VARICEL
"RTN","C0ITEST",207,0)
 .I MUMPS=1 D MUMPS
"RTN","C0ITEST",208,0)
 .I MEASLES=1 D MEASLES
"RTN","C0ITEST",209,0)
 .I RUBELLA=1 D RUBELLA
"RTN","C0ITEST",210,0)
 .D GETNMAP^C0IUTIL("WRK","PAYOUTN^C0ITEST","C0IPOA")
"RTN","C0ITEST",211,0)
 .K ^TMP("PXRHM",$J)
"RTN","C0ITEST",212,0)
 Q
"RTN","C0ITEST",213,0)
 ;
"RTN","C0ITEST",214,0)
HEPB ;
"RTN","C0ITEST",215,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0ITEST",216,0)
 S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0ITEST",217,0)
 S C0IPOA("codeICD9")="070.30"
"RTN","C0ITEST",218,0)
 S C0IPOA("codeName")="Viral hepatitis B without mention of hepatic coma, acute or unspecified, without mention of hepatitis delta"
"RTN","C0ITEST",219,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0ITEST","C0IPOA")
"RTN","C0ITEST",220,0)
 K C0IPOA("UUIDA")
"RTN","C0ITEST",221,0)
 K C0IPOA("timeProblem")
"RTN","C0ITEST",222,0)
 K C0IPOA("codeICD9")
"RTN","C0ITEST",223,0)
 K C0IPOA("codeName")
"RTN","C0ITEST",224,0)
 Q
"RTN","C0ITEST",225,0)
 ;
"RTN","C0ITEST",226,0)
HEPA ;
"RTN","C0ITEST",227,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0ITEST",228,0)
 S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0ITEST",229,0)
 ;S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL("3130101")
"RTN","C0ITEST",230,0)
 S C0IPOA("codeICD9")="070.1"
"RTN","C0ITEST",231,0)
 S C0IPOA("codeName")="Viral hepatitis A without mention of hepatic coma"
"RTN","C0ITEST",232,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0ITEST","C0IPOA")
"RTN","C0ITEST",233,0)
 K C0IPOA("UUIDA")
"RTN","C0ITEST",234,0)
 K C0IPOA("timeProblem")
"RTN","C0ITEST",235,0)
 K C0IPOA("codeICD9")
"RTN","C0ITEST",236,0)
 K C0IPOA("codeName") 
"RTN","C0ITEST",237,0)
 Q
"RTN","C0ITEST",238,0)
 ;
"RTN","C0ITEST",239,0)
VARICEL ;
"RTN","C0ITEST",240,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0ITEST",241,0)
 S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0ITEST",242,0)
 S C0IPOA("codeICD9")="052.9"
"RTN","C0ITEST",243,0)
 S C0IPOA("codeName")="Varicella without mention of complication"
"RTN","C0ITEST",244,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0ITEST","C0IPOA")
"RTN","C0ITEST",245,0)
 K C0IPOA("UUIDA")
"RTN","C0ITEST",246,0)
 K C0IPOA("timeProblem")
"RTN","C0ITEST",247,0)
 K C0IPOA("codeICD9")
"RTN","C0ITEST",248,0)
 K C0IPOA("codeName")
"RTN","C0ITEST",249,0)
 Q 
"RTN","C0ITEST",250,0)
 ;  
"RTN","C0ITEST",251,0)
MUMPS ;
"RTN","C0ITEST",252,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0ITEST",253,0)
 S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0ITEST",254,0)
 S C0IPOA("codeICD9")="072.9"
"RTN","C0ITEST",255,0)
 S C0IPOA("codeName")="Mumps without mention of complication"
"RTN","C0ITEST",256,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0ITEST","C0IPOA")
"RTN","C0ITEST",257,0)
 K C0IPOA("UUIDA")  
"RTN","C0ITEST",258,0)
 K C0IPOA("timeProblem")
"RTN","C0ITEST",259,0)
 K C0IPOA("codeICD9")
"RTN","C0ITEST",260,0)
 K C0IPOA("codeName")
"RTN","C0ITEST",261,0)
 Q
"RTN","C0ITEST",262,0)
 ; 
"RTN","C0ITEST",263,0)
MEASLES ;
"RTN","C0ITEST",264,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0ITEST",265,0)
 S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0ITEST",266,0)
 S C0IPOA("codeICD9")="055.9"
"RTN","C0ITEST",267,0)
 S C0IPOA("codeName")="Measles without mention of complication"
"RTN","C0ITEST",268,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0ITEST","C0IPOA")
"RTN","C0ITEST",269,0)
 K C0IPOA("UUIDA")
"RTN","C0ITEST",270,0)
 K C0IPOA("timeProblem")
"RTN","C0ITEST",271,0)
 K C0IPOA("codeICD9")
"RTN","C0ITEST",272,0)
 K C0IPOA("codeName")
"RTN","C0ITEST",273,0)
 Q
"RTN","C0ITEST",274,0)
 ;
"RTN","C0ITEST",275,0)
RUBELLA ;
"RTN","C0ITEST",276,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0ITEST",277,0)
 S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0ITEST",278,0)
 S C0IPOA("codeICD9")="056.9"
"RTN","C0ITEST",279,0)
 S C0IPOA("codeName")="Rubella without mention of complication"
"RTN","C0ITEST",280,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0ITEST","C0IPOA")
"RTN","C0ITEST",281,0)
 K C0IPOA("UUIDA")  
"RTN","C0ITEST",282,0)
 K C0IPOA("timeProblem")
"RTN","C0ITEST",283,0)
 K C0IPOA("codeICD9")
"RTN","C0ITEST",284,0)
 K C0IPOA("codeName")
"RTN","C0ITEST",285,0)
 Q
"RTN","C0ITEST",286,0)
 ;
"RTN","C0ITEST",287,0)
TPAYOUTC ;
"RTN","C0ITEST",288,0)
 ;;; only one line that is fixed for substance administration 
"RTN","C0ITEST",289,0)
 ;;<substanceAdministrationEvents>
"RTN","C0ITEST",290,0)
 Q
"RTN","C0ITEST",291,0)
 ;
"RTN","C0ITEST",292,0)
TPAYOUTD ; 
"RTN","C0ITEST",293,0)
 ;;; this section loops through the immunizations
"RTN","C0ITEST",294,0)
 ;;<substanceAdministrationEvent>
"RTN","C0ITEST",295,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.9.1.1"/>
"RTN","C0ITEST",296,0)
 ;;<id root="@@UUID1@@"/>
"RTN","C0ITEST",297,0)
 ;;<substanceAdministrationGeneralPurpose code="384810002" codeSystem="2.16.840.1.113883.6.5"/>
"RTN","C0ITEST",298,0)
 ;;<substance>
"RTN","C0ITEST",299,0)
 ;;<id root="@@UUID2@@"/>
"RTN","C0ITEST",300,0)
 ;;<substanceCode code="@@CVXCode@@" codeSystem="2.16.840.1.113883.12.292" displayName="@@CVXName@@" originalText="@@ORIGName@@"/>
"RTN","C0ITEST",301,0)
 ;;</substance>
"RTN","C0ITEST",302,0)
 ;;<administrationTimeInterval low="@@admDate@@" high="@@admDate@@"/>
"RTN","C0ITEST",303,0)
 ;;</substanceAdministrationEvent>
"RTN","C0ITEST",304,0)
 Q
"RTN","C0ITEST",305,0)
 ;
"RTN","C0ITEST",306,0)
PAYOUTDV ;
"RTN","C0ITEST",307,0)
 ; Variable and code for the looping IMMUNIZATIONS section
"RTN","C0ITEST",308,0)
 ; Need UUID x 2, CVX code, name from CVX Short name, administration date 
"RTN","C0ITEST",309,0)
 ;(need really only one eve thought it asks for high and low - use the same variable)
"RTN","C0ITEST",310,0)
 D GETPAT^C0IEXTR(.G,DFN,"immunization")
"RTN","C0ITEST",311,0)
 I G("results","immunizations@total")=0 Q
"RTN","C0ITEST",312,0)
 E  D
"RTN","C0ITEST",313,0)
 .N T S T=G("results","immunizations@total")
"RTN","C0ITEST",314,0)
 .I T=1 D  ;
"RTN","C0ITEST",315,0)
 ..N GTMP
"RTN","C0ITEST",316,0)
 ..M GTMP=G("results","immunizations")
"RTN","C0ITEST",317,0)
 ..K G("results","immunizations")
"RTN","C0ITEST",318,0)
 .. M G("results","immunizations",1)=GTMP
"RTN","C0ITEST",319,0)
 .. K GTMP
"RTN","C0ITEST",320,0)
 .N I S I=""
"RTN","C0ITEST",321,0)
 .F I=1:1:T D
"RTN","C0ITEST",322,0)
 ..W:'$G(DIQUIET) "I is ",I,!
"RTN","C0ITEST",323,0)
 ..D OUTLOG^C0IUTIL("I is "_I)
"RTN","C0ITEST",324,0)
 ..N CPTIMM,CVXCODE,ADMDATE,IMMNAME,IMMCVX
"RTN","C0ITEST",325,0)
 ..S C0IPOA("UUID1")=$$UUID^C0IUTIL 
"RTN","C0ITEST",326,0)
 ..S C0IPOA("UUID2")=$$UUID^C0IUTIL
"RTN","C0ITEST",327,0)
 ..S C0IPOA("CVXCode")=""
"RTN","C0ITEST",328,0)
 ..S C0IPOA("CVXName")=""
"RTN","C0ITEST",329,0)
 ..S C0IPOA("ORIGName")=""
"RTN","C0ITEST",330,0)
 ..S C0IPOA("admDate")=""
"RTN","C0ITEST",331,0)
 ..I $D(G("results","immunizations",I,"immunization","cpt@code")) D 
"RTN","C0ITEST",332,0)
 ...; If there is a CPT code, use that to get the CVX code and the proper CVC code name
"RTN","C0ITEST",333,0)
 ...N CPTIMM,CVXCODE,ADMDATE 
"RTN","C0ITEST",334,0)
 ...S CPTIMM="" S CVXCODE="" S ADMDATE=""
"RTN","C0ITEST",335,0)
 ...S CPTIMM=$G(G("results","immunizations",I,"immunization","cpt@code"))
"RTN","C0ITEST",336,0)
 ...W:'$G(DIQUIET) "CPTIMM from G is ",CPTIMM,!
"RTN","C0ITEST",337,0)
 ...S CVXCODE=CPTMAP(CPTIMM)
"RTN","C0ITEST",338,0)
 ...W:'$G(DIQUIET) "The CVX code for this immunizaton with a CPT code is ",CVXCODE,!
"RTN","C0ITEST",339,0)
 ...I ((CVXCODE'="")!(CVXCODE=999)) D  Q
"RTN","C0ITEST",340,0)
 ....; If you found the CVXCode by the CPT code, add the XML to the array and QUIT  
"RTN","C0ITEST",341,0)
 ....S C0IPOA("CVXCode")=CVXCODE
"RTN","C0ITEST",342,0)
 ....S C0IPOA("CVXName")=CVXMAP(CVXCODE)
"RTN","C0ITEST",343,0)
 ....S C0IPOA("ORIGName")=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0ITEST",344,0)
 ....S ADMDATE=$G(G("results","immunizations",I,"immunization","administered@value"))
"RTN","C0ITEST",345,0)
 ....S C0IPOA("admDate")=$$FMDTOCDA^C0IUTIL(ADMDATE)
"RTN","C0ITEST",346,0)
 ....D GETNMAP^C0IUTIL("WRK","TPAYOUTD^C0ITEST","C0IPOA")
"RTN","C0ITEST",347,0)
 ..I '$D(G("results","immunizations",I,"immunization","cpt@code")) D
"RTN","C0ITEST",348,0)
 ...; if there is no CPT code, try to look it up by the proper CVX code name
"RTN","C0ITEST",349,0)
 ...N IMMNAME,IMMCVX,IMMCPT,CVXCODE,ADMDATE
"RTN","C0ITEST",350,0)
 ...S (IMMNAME,IMMCVX,IMMCPT,CVXCODE,ADMDATE)=""
"RTN","C0ITEST",351,0)
 ...S IMMNAME=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0ITEST",352,0)
 ...W:'$G(DIQUIET) "IMMNAME in the no CPT look up by proper CVX code name is ",IMMNAME,!
"RTN","C0ITEST",353,0)
 ...S IMMCVX=$O(CVXMAP("B",IMMNAME,""))
"RTN","C0ITEST",354,0)
 ...W:'$G(DIQUIET) "IMMCVX for this vaccine with a proper name is ",IMMCVX,!
"RTN","C0ITEST",355,0)
 ...I IMMCVX="" D
"RTN","C0ITEST",356,0)
 ....; If the CVX code is not found by the proper CVX code name, try the lookup in the CPTIMAP section by the
"RTN","C0ITEST",357,0)
 ....; original name which are odd names in the Immunization file.
"RTN","C0ITEST",358,0)
 ....; Once you have the CVX code, get the proper text from the CVX code from the CVX Map
"RTN","C0ITEST",359,0)
 ....; Once a different method of storing the CVX-Immunization map is found, then this section will be replaced
"RTN","C0ITEST",360,0)
 ....; CVXIMAP is specific a VistA instance.
"RTN","C0ITEST",361,0)
 ....N CVXCODE,IMMNAME,IMMCVX,ADMDATE,CVXNAME
"RTN","C0ITEST",362,0)
 ....S (CVXCODE,IMMNAME,IMMCVX,ADMDATE,CVXNAME)=""
"RTN","C0ITEST",363,0)
 ....S IMMNAME=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0ITEST",364,0)
 ....I IMMNAME="" S IMMNAME=$G(G("results","immunizations","immunization","name@value"))
"RTN","C0ITEST",365,0)
 ....I IMMNAME="" D  Q
"RTN","C0ITEST",366,0)
 ....W:'$G(DIQUIET) "The IMMNAME for this immunization without a proper name is ",IMMNAME,!
"RTN","C0ITEST",367,0)
 ....S CVXCODE=$O(CVXIMAP("B",IMMNAME,""))
"RTN","C0ITEST",368,0)
 ....W:'$G(DIQUIET) "The CVX code for this immunization without the proper name is ",CVXCODE,!
"RTN","C0ITEST",369,0)
 ....S CVXNAME=CVXMAP(CVXCODE) 
"RTN","C0ITEST",370,0)
 ....W:'$G(DIQUIET) "The proper name for this immunization is ",CVXNAME,!
"RTN","C0ITEST",371,0)
 ....I CVXCODE="" D  Q
"RTN","C0ITEST",372,0)
 .....; If there is still no CVX code found, record and error and quit
"RTN","C0ITEST",373,0)
 .....S ZTXT=$G(G("results","immunizations",I,"immunization","id@value"))
"RTN","C0ITEST",374,0)
 .....D OUTLOG("ERROR-Missing CVX or Incorrect Name for IEN="_ZTXT)
"RTN","C0ITEST",375,0)
 ....E  D
"RTN","C0ITEST",376,0)
 .....; Else, if you have found a CVX code, then write the XML to the array and QUIT
"RTN","C0ITEST",377,0)
 .....S C0IPOA("CVXCode")=CVXCODE
"RTN","C0ITEST",378,0)
 .....S C0IPOA("CVXName")=CVXNAME
"RTN","C0ITEST",379,0)
 .....S C0IPOA("ORIGName")=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0ITEST",380,0)
 .....S ADMDATE=$G(G("results","immunizations",I,"immunization","administered@value"))
"RTN","C0ITEST",381,0)
 .....S C0IPOA("admDate")=$$FMDTOCDA^C0IUTIL(ADMDATE) ;S ^GPL("DATE",I)=ADMDATE
"RTN","C0ITEST",382,0)
 .....D GETNMAP^C0IUTIL("WRK","TPAYOUTD^C0ITEST","C0IPOA")
"RTN","C0ITEST",383,0)
 Q
"RTN","C0ITEST",384,0)
 ;
"RTN","C0ITEST",385,0)
OUTLOG(ZTXT) ; add text to the log
"RTN","C0ITEST",386,0)
 I '$D(C0LOGLOC) S C0LOGLOC=$NA(^TMP("C0I",$J,"LOG"))
"RTN","C0ITEST",387,0)
 N LN S LN=$O(@C0LOGLOC@(""),-1)+1
"RTN","C0ITEST",388,0)
 S @C0LOGLOC@(LN)=ZTXT
"RTN","C0ITEST",389,0)
 Q
"RTN","C0ITEST",390,0)
 ;
"RTN","C0ITEST",391,0)
TPAYOUTE
"RTN","C0ITEST",392,0)
 ;;;fixed end portion of payload
"RTN","C0ITEST",393,0)
 ;;</substanceAdministrationEvents>
"RTN","C0ITEST",394,0)
 ;;</clinicalStatements>
"RTN","C0ITEST",395,0)
 ;;</patient>
"RTN","C0ITEST",396,0)
 ;;</vmrInput>
"RTN","C0ITEST",397,0)
 ;;</ns4:cdsInput>
"RTN","C0ITEST",398,0)
 Q
"RTN","C0ITEST",399,0)
 ;
"RTN","C0ITEST",400,0)
CPTMAP
"RTN","C0ITEST",401,0)
 S CPTMAP(90281)=86
"RTN","C0ITEST",402,0)
 S CPTMAP(90283)=87
"RTN","C0ITEST",403,0)
 S CPTMAP(90287)=27
"RTN","C0ITEST",404,0)
 S CPTMAP(90291)=29
"RTN","C0ITEST",405,0)
 S CPTMAP(90296)=12
"RTN","C0ITEST",406,0)
 S CPTMAP(90371)=30
"RTN","C0ITEST",407,0)
 S CPTMAP(90375)=34
"RTN","C0ITEST",408,0)
 S CPTMAP(90376)=34
"RTN","C0ITEST",409,0)
 S CPTMAP(90378)=93
"RTN","C0ITEST",410,0)
 S CPTMAP(90379)=71
"RTN","C0ITEST",411,0)
 S CPTMAP(90389)=13
"RTN","C0ITEST",412,0)
 S CPTMAP(90393)=79
"RTN","C0ITEST",413,0)
 S CPTMAP(90396)=36
"RTN","C0ITEST",414,0)
 S CPTMAP(90470)=128
"RTN","C0ITEST",415,0)
 S CPTMAP(90476)=54
"RTN","C0ITEST",416,0)
 S CPTMAP(90477)=55
"RTN","C0ITEST",417,0)
 S CPTMAP(90581)=24
"RTN","C0ITEST",418,0)
 S CPTMAP(90585)=19
"RTN","C0ITEST",419,0)
 S CPTMAP(90632)=52
"RTN","C0ITEST",420,0)
 S CPTMAP(90633)=83
"RTN","C0ITEST",421,0)
 S CPTMAP(90634)=84
"RTN","C0ITEST",422,0)
 S CPTMAP(90636)=104
"RTN","C0ITEST",423,0)
 S CPTMAP(90644)=148
"RTN","C0ITEST",424,0)
 S CPTMAP(90645)=47
"RTN","C0ITEST",425,0)
 S CPTMAP(90646)=46
"RTN","C0ITEST",426,0)
 S CPTMAP(90647)=49
"RTN","C0ITEST",427,0)
 S CPTMAP(90648)=48
"RTN","C0ITEST",428,0)
 S CPTMAP(90649)=62
"RTN","C0ITEST",429,0)
 S CPTMAP(90650)=118
"RTN","C0ITEST",430,0)
 S CPTMAP(90654)=144
"RTN","C0ITEST",431,0)
 S CPTMAP(90655)=140
"RTN","C0ITEST",432,0)
 S CPTMAP(90656)=140
"RTN","C0ITEST",433,0)
 S CPTMAP(90657)=141
"RTN","C0ITEST",434,0)
 S CPTMAP(90658)=141
"RTN","C0ITEST",435,0)
 S CPTMAP(90659)=16
"RTN","C0ITEST",436,0)
 S CPTMAP(90660)=111
"RTN","C0ITEST",437,0)
 S CPTMAP(90661)=153
"RTN","C0ITEST",438,0)
 S CPTMAP(90662)=135
"RTN","C0ITEST",439,0)
 S CPTMAP(90663)=128
"RTN","C0ITEST",440,0)
 S CPTMAP(90664)=125
"RTN","C0ITEST",441,0)
 S CPTMAP(90665)=66
"RTN","C0ITEST",442,0)
 S CPTMAP(90666)=126
"RTN","C0ITEST",443,0)
 S CPTMAP(90668)=127
"RTN","C0ITEST",444,0)
 S CPTMAP(90669)=100
"RTN","C0ITEST",445,0)
 S CPTMAP(90670)=133
"RTN","C0ITEST",446,0)
 S CPTMAP(90672)=149
"RTN","C0ITEST",447,0)
 S CPTMAP(90673)=155
"RTN","C0ITEST",448,0)
 S CPTMAP(90675)=18
"RTN","C0ITEST",449,0)
 S CPTMAP(90676)=40
"RTN","C0ITEST",450,0)
 S CPTMAP(90680)=116
"RTN","C0ITEST",451,0)
 S CPTMAP(90681)=119
"RTN","C0ITEST",452,0)
 S CPTMAP(90685)=150
"RTN","C0ITEST",453,0)
 S CPTMAP(90686)=150
"RTN","C0ITEST",454,0)
 S CPTMAP(90688)=158
"RTN","C0ITEST",455,0)
 S CPTMAP(90690)=25
"RTN","C0ITEST",456,0)
 S CPTMAP(90691)=101
"RTN","C0ITEST",457,0)
 S CPTMAP(90692)=41
"RTN","C0ITEST",458,0)
 S CPTMAP(90693)=53
"RTN","C0ITEST",459,0)
 S CPTMAP(90696)=130
"RTN","C0ITEST",460,0)
 S CPTMAP(90698)=120
"RTN","C0ITEST",461,0)
 S CPTMAP(90700)=20
"RTN","C0ITEST",462,0)
 S CPTMAP(90700)=106
"RTN","C0ITEST",463,0)
 S CPTMAP(90701)=01
"RTN","C0ITEST",464,0)
 S CPTMAP(90702)=28
"RTN","C0ITEST",465,0)
 S CPTMAP(90703)=35
"RTN","C0ITEST",466,0)
 S CPTMAP(90704)=07
"RTN","C0ITEST",467,0)
 S CPTMAP(90705)=05
"RTN","C0ITEST",468,0)
 S CPTMAP(90706)=06
"RTN","C0ITEST",469,0)
 S CPTMAP(90707)=03
"RTN","C0ITEST",470,0)
 S CPTMAP(90708)=04
"RTN","C0ITEST",471,0)
 S CPTMAP(90710)=94
"RTN","C0ITEST",472,0)
 S CPTMAP(90712)=02
"RTN","C0ITEST",473,0)
 S CPTMAP(90713)=10
"RTN","C0ITEST",474,0)
 S CPTMAP(90714)=113
"RTN","C0ITEST",475,0)
 S CPTMAP(90714)=91
"RTN","C0ITEST",476,0)
 S CPTMAP(90715)=115
"RTN","C0ITEST",477,0)
 S CPTMAP(90716)=21
"RTN","C0ITEST",478,0)
 S CPTMAP(90717)=37
"RTN","C0ITEST",479,0)
 S CPTMAP(90718)=09
"RTN","C0ITEST",480,0)
 S CPTMAP(90720)=22
"RTN","C0ITEST",481,0)
 S CPTMAP(90721)=50
"RTN","C0ITEST",482,0)
 S CPTMAP(90723)=110
"RTN","C0ITEST",483,0)
 S CPTMAP(90724)=88
"RTN","C0ITEST",484,0)
 S CPTMAP(90725)=26
"RTN","C0ITEST",485,0)
 S CPTMAP(90726)=90
"RTN","C0ITEST",486,0)
 S CPTMAP(90727)=23
"RTN","C0ITEST",487,0)
 S CPTMAP(90728)=19
"RTN","C0ITEST",488,0)
 S CPTMAP(90730)=85
"RTN","C0ITEST",489,0)
 S CPTMAP(90731)=45
"RTN","C0ITEST",490,0)
 S CPTMAP(90732)=33
"RTN","C0ITEST",491,0)
 S CPTMAP(90733)=32
"RTN","C0ITEST",492,0)
 S CPTMAP(90734)=136
"RTN","C0ITEST",493,0)
 S CPTMAP(90734)=114
"RTN","C0ITEST",494,0)
 S CPTMAP(90735)=39
"RTN","C0ITEST",495,0)
 S CPTMAP(90736)=121
"RTN","C0ITEST",496,0)
 S CPTMAP(90737)=17
"RTN","C0ITEST",497,0)
 S CPTMAP(90738)=134
"RTN","C0ITEST",498,0)
 S CPTMAP(90740)=44
"RTN","C0ITEST",499,0)
 S CPTMAP(90741)=14
"RTN","C0ITEST",500,0)
 S CPTMAP(90743)=43
"RTN","C0ITEST",501,0)
 S CPTMAP(90744)=08
"RTN","C0ITEST",502,0)
 S CPTMAP(90745)=42
"RTN","C0ITEST",503,0)
 S CPTMAP(90746)=43
"RTN","C0ITEST",504,0)
 S CPTMAP(90747)=44
"RTN","C0ITEST",505,0)
 S CPTMAP(90748)=51  
"RTN","C0ITEST",506,0)
 S CPTMAP(90749)=999
"RTN","C0ITEST",507,0)
 Q
"RTN","C0ITEST",508,0)
CVXMAP
"RTN","C0ITEST",509,0)
 S CVXMAP(86)="IG"
"RTN","C0ITEST",510,0)
 S CVXMAP(87)="IGIV"
"RTN","C0ITEST",511,0)
 S CVXMAP(27)="botulinum antitoxin"
"RTN","C0ITEST",512,0)
 S CVXMAP(29)="CMVIG"
"RTN","C0ITEST",513,0)
 S CVXMAP(12)="diphtheria antitoxin"
"RTN","C0ITEST",514,0)
 S CVXMAP(30)="HBIG"
"RTN","C0ITEST",515,0)
 S CVXMAP(34)="RIG"
"RTN","C0ITEST",516,0)
 S CVXMAP(34)="RIG"
"RTN","C0ITEST",517,0)
 S CVXMAP(93)="RSV-MAb"
"RTN","C0ITEST",518,0)
 S CVXMAP(71)="RSV-IGIV"
"RTN","C0ITEST",519,0)
 S CVXMAP(13)="TIG"
"RTN","C0ITEST",520,0)
 S CVXMAP(79)="vaccinia immune globulin"
"RTN","C0ITEST",521,0)
 S CVXMAP(36)="VZIG"
"RTN","C0ITEST",522,0)
 S CVXMAP(128)="Novel Influenza-H1N1-09, all formulations"
"RTN","C0ITEST",523,0)
 S CVXMAP(54)="adenovirus, type 4"
"RTN","C0ITEST",524,0)
 S CVXMAP(55)="adenovirus, type 7"
"RTN","C0ITEST",525,0)
 S CVXMAP(24)="anthrax"
"RTN","C0ITEST",526,0)
 S CVXMAP(19)="BCG"
"RTN","C0ITEST",527,0)
 S CVXMAP(52)="Hep A, adult"
"RTN","C0ITEST",528,0)
 S CVXMAP(83)="Hep A, ped/adol, 2 dose"
"RTN","C0ITEST",529,0)
 S CVXMAP(84)="Hep A, ped/adol, 3 dose"
"RTN","C0ITEST",530,0)
 S CVXMAP(104)="Hep A-Hep B"
"RTN","C0ITEST",531,0)
 S CVXMAP(148)="Meningococcal C/Y-HIB PRP"
"RTN","C0ITEST",532,0)
 S CVXMAP(47)="Hib (HbOC)"
"RTN","C0ITEST",533,0)
 S CVXMAP(46)="Hib (PRP-D)"
"RTN","C0ITEST",534,0)
 S CVXMAP(49)="Hib (PRP-OMP)"
"RTN","C0ITEST",535,0)
 S CVXMAP(48)="Hib (PRP-T)"
"RTN","C0ITEST",536,0)
 S CVXMAP(62)="HPV, quadrivalent"
"RTN","C0ITEST",537,0)
 S CVXMAP(118)="HPV, bivalent"
"RTN","C0ITEST",538,0)
 S CVXMAP(144)="influenza, seasonal, intradermal, preservative free"
"RTN","C0ITEST",539,0)
 S CVXMAP(140)="Influenza, seasonal, injectable, preservative free"
"RTN","C0ITEST",540,0)
 S CVXMAP(140)="Influenza, seasonal, injectable, preservative free"
"RTN","C0ITEST",541,0)
 S CVXMAP(141)="Influenza, seasonal, injectable"
"RTN","C0ITEST",542,0)
 S CVXMAP(141)="Influenza, seasonal, injectable"
"RTN","C0ITEST",543,0)
 S CVXMAP(16)="influenza, whole"
"RTN","C0ITEST",544,0)
 S CVXMAP(111)="influenza, live, intranasal"
"RTN","C0ITEST",545,0)
 S CVXMAP(153)="Influenza, injectable, MDCK, preservative free"
"RTN","C0ITEST",546,0)
 S CVXMAP(135)="Influenza, high dose seasonal"
"RTN","C0ITEST",547,0)
 S CVXMAP(128)="Novel Influenza-H1N1-09, all formulations"
"RTN","C0ITEST",548,0)
 S CVXMAP(125)="Novel Influenza-H1N1-09, nasal"
"RTN","C0ITEST",549,0)
 S CVXMAP(66)="Lyme disease"
"RTN","C0ITEST",550,0)
 S CVXMAP(126)="Novel influenza-H1N1-09, preservative-free"
"RTN","C0ITEST",551,0)
 S CVXMAP(127)="Novel influenza-H1N1-09"
"RTN","C0ITEST",552,0)
 S CVXMAP(100)="pneumococcal conjugate PCV 7"
"RTN","C0ITEST",553,0)
 S CVXMAP(133)="Pneumococcal conjugate PCV 13"
"RTN","C0ITEST",554,0)
 S CVXMAP(149)="influenza, live, intranasal, quadrivalent"
"RTN","C0ITEST",555,0)
 S CVXMAP(155)="influenza, recombinant, injectable, preservative free"
"RTN","C0ITEST",556,0)
 S CVXMAP(18)="rabies, intramuscular injection"
"RTN","C0ITEST",557,0)
 S CVXMAP(40)="rabies, intradermal injection"
"RTN","C0ITEST",558,0)
 S CVXMAP(116)="rotavirus, pentavalent"
"RTN","C0ITEST",559,0)
 S CVXMAP(119)="rotavirus, monovalent"
"RTN","C0ITEST",560,0)
 S CVXMAP(150)="influenza, injectable, quadrivalent, preservative free"
"RTN","C0ITEST",561,0)
 S CVXMAP(150)="influenza, injectable, quadrivalent, preservative free"
"RTN","C0ITEST",562,0)
 S CVXMAP(158)="influenza, injectable, quadrivalent"
"RTN","C0ITEST",563,0)
 S CVXMAP(25)="typhoid, oral"
"RTN","C0ITEST",564,0)
 S CVXMAP(101)="typhoid, ViCPs"
"RTN","C0ITEST",565,0)
 S CVXMAP(41)="typhoid, parenteral"
"RTN","C0ITEST",566,0)
 S CVXMAP(53)="typhoid, parenteral, AKD (U.S. military)"
"RTN","C0ITEST",567,0)
 S CVXMAP(130)="DTaP-IPV"
"RTN","C0ITEST",568,0)
 S CVXMAP(120)="DTaP-Hib-IPV"
"RTN","C0ITEST",569,0)
 S CVXMAP(20)="DTaP"
"RTN","C0ITEST",570,0)
 S CVXMAP(106)="DTaP, 5 pertussis antigens"
"RTN","C0ITEST",571,0)
 S CVXMAP(01)="DTP"
"RTN","C0ITEST",572,0)
 S CVXMAP(28)="DT (pediatric)"
"RTN","C0ITEST",573,0)
 S CVXMAP(35)="tetanus toxoid, adsorbed"
"RTN","C0ITEST",574,0)
 S CVXMAP(07)="mumps"
"RTN","C0ITEST",575,0)
 S CVXMAP(05)="measles"
"RTN","C0ITEST",576,0)
 S CVXMAP(06)="rubella"
"RTN","C0ITEST",577,0)
 S CVXMAP(03)="MMR"
"RTN","C0ITEST",578,0)
 S CVXMAP(04)="M/R"
"RTN","C0ITEST",579,0)
 S CVXMAP(94)="MMRV"
"RTN","C0ITEST",580,0)
 S CVXMAP(02)="OPV"
"RTN","C0ITEST",581,0)
 S CVXMAP(10)="IPV"
"RTN","C0ITEST",582,0)
 S CVXMAP(113)="Td (adult) preservative free"
"RTN","C0ITEST",583,0)
 S CVXMAP(91)="typhoid, unspecified formulation"
"RTN","C0ITEST",584,0)
 S CVXMAP(115)="Tdap"
"RTN","C0ITEST",585,0)
 S CVXMAP(21)="varicella"
"RTN","C0ITEST",586,0)
 S CVXMAP(37)="yellow fever"
"RTN","C0ITEST",587,0)
 S CVXMAP(09)="Td (adult), adsorbed"
"RTN","C0ITEST",588,0)
 S CVXMAP(22)="DTP-Hib"
"RTN","C0ITEST",589,0)
 S CVXMAP(50)="DTaP-Hib"
"RTN","C0ITEST",590,0)
 S CVXMAP(110)="DTaP-Hep B-IPV"
"RTN","C0ITEST",591,0)
 S CVXMAP(88)="influenza, unspecified formulation"
"RTN","C0ITEST",592,0)
 S CVXMAP(26)="cholera"
"RTN","C0ITEST",593,0)
 S CVXMAP(90)="rabies, unspecified formulation"
"RTN","C0ITEST",594,0)
 S CVXMAP(23)="plague"
"RTN","C0ITEST",595,0)
 S CVXMAP(19)="BCG"
"RTN","C0ITEST",596,0)
 S CVXMAP(85)="Hep A, unspecified formulation"
"RTN","C0ITEST",597,0)
 S CVXMAP(45)="Hep B, unspecified formulation"
"RTN","C0ITEST",598,0)
 S CVXMAP(33)="pneumococcal polysaccharide PPV23"
"RTN","C0ITEST",599,0)
 S CVXMAP(32)="meningococcal MPSV4"
"RTN","C0ITEST",600,0)
 S CVXMAP(136)="Meningococcal MCV4O"
"RTN","C0ITEST",601,0)
 S CVXMAP(114)="meningococcal MCV4P"
"RTN","C0ITEST",602,0)
 S CVXMAP(39)="Japanese encephalitis SC"
"RTN","C0ITEST",603,0)
 S CVXMAP(121)="zoster"
"RTN","C0ITEST",604,0)
 S CVXMAP(17)="Hib, unspecified formulation"
"RTN","C0ITEST",605,0)
 S CVXMAP(134)="Japanese Encephalitis IM"
"RTN","C0ITEST",606,0)
 S CVXMAP(44)="Hep B, dialysis"
"RTN","C0ITEST",607,0)
 S CVXMAP(14)="IG, unspecified formulation"
"RTN","C0ITEST",608,0)
 S CVXMAP(43)="Hep B, adult"
"RTN","C0ITEST",609,0)
 S CVXMAP(08)="Hep B, adolescent or pediatric"
"RTN","C0ITEST",610,0)
 S CVXMAP(42)="Hep B, adolescent/high risk infant"
"RTN","C0ITEST",611,0)
 S CVXMAP(43)="Hep B, adult"
"RTN","C0ITEST",612,0)
 S CVXMAP(44)="Hep B, dialysis"
"RTN","C0ITEST",613,0)
 S CVXMAP(51)="Hib-Hep B"
"RTN","C0ITEST",614,0)
 S CVXMAP(999)="unknown"
"RTN","C0ITEST",615,0)
 S CVXMAP("B","IG",86)=""
"RTN","C0ITEST",616,0)
 S CVXMAP("B","IGIV",87)=""
"RTN","C0ITEST",617,0)
 S CVXMAP("B","botulinum antitoxin",27)=""
"RTN","C0ITEST",618,0)
 S CVXMAP("B","CMVIG",29)=""
"RTN","C0ITEST",619,0)
 S CVXMAP("B","diphtheria antitoxin",12)=""
"RTN","C0ITEST",620,0)
 S CVXMAP("B","HBIG",30)=""
"RTN","C0ITEST",621,0)
 S CVXMAP("B","RIG",34)=""
"RTN","C0ITEST",622,0)
 S CVXMAP("B","RIG",34)=""
"RTN","C0ITEST",623,0)
 S CVXMAP("B","RSV-MAb",93)=""
"RTN","C0ITEST",624,0)
 S CVXMAP("B","RSV-IGIV",71)=""
"RTN","C0ITEST",625,0)
 S CVXMAP("B","TIG",13)=""
"RTN","C0ITEST",626,0)
 S CVXMAP("B","vaccinia immune globulin",79)=""
"RTN","C0ITEST",627,0)
 S CVXMAP("B","VZIG",36)=""
"RTN","C0ITEST",628,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, all formulations",128)=""
"RTN","C0ITEST",629,0)
 S CVXMAP("B","adenovirus, type 4",54)=""
"RTN","C0ITEST",630,0)
 S CVXMAP("B","adenovirus, type 7",55)=""
"RTN","C0ITEST",631,0)
 S CVXMAP("B","anthrax",24)=""
"RTN","C0ITEST",632,0)
 S CVXMAP("B","BCG",19)=""
"RTN","C0ITEST",633,0)
 S CVXMAP("B","Hep A, adult",52)=""
"RTN","C0ITEST",634,0)
 S CVXMAP("B","Hep A, ped/adol, 2 dose",83)=""
"RTN","C0ITEST",635,0)
 S CVXMAP("B","Hep A, ped/adol, 3 dose",84)=""
"RTN","C0ITEST",636,0)
 S CVXMAP("B","Hep A-Hep B",104)=""
"RTN","C0ITEST",637,0)
 S CVXMAP("B","Meningococcal C/Y-HIB PRP",148)=""
"RTN","C0ITEST",638,0)
 S CVXMAP("B","Hib (HbOC)",47)=""
"RTN","C0ITEST",639,0)
 S CVXMAP("B","Hib (PRP-D)",46)=""
"RTN","C0ITEST",640,0)
 S CVXMAP("B","Hib (PRP-OMP)",49)=""
"RTN","C0ITEST",641,0)
 S CVXMAP("B","Hib (PRP-T)",48)=""
"RTN","C0ITEST",642,0)
 S CVXMAP("B","HPV, quadrivalent",62)=""
"RTN","C0ITEST",643,0)
 S CVXMAP("B","HPV, bivalent",118)=""
"RTN","C0ITEST",644,0)
 S CVXMAP("B","influenza, seasonal, intradermal, preservative free",144)=""
"RTN","C0ITEST",645,0)
 S CVXMAP("B","Influenza, seasonal, injectable, preservative free",140)=""
"RTN","C0ITEST",646,0)
 S CVXMAP("B","Influenza, seasonal, injectable, preservative free",140)=""
"RTN","C0ITEST",647,0)
 S CVXMAP("B","Influenza, seasonal, injectable",141)=""
"RTN","C0ITEST",648,0)
 S CVXMAP("B","Influenza, seasonal, injectable",141)=""
"RTN","C0ITEST",649,0)
 S CVXMAP("B","influenza, whole",16)=""
"RTN","C0ITEST",650,0)
 S CVXMAP("B","influenza, live, intranasal",111)=""
"RTN","C0ITEST",651,0)
 S CVXMAP("B","Influenza, injectable, MDCK, preservative free",153)=""
"RTN","C0ITEST",652,0)
 S CVXMAP("B","Influenza, high dose seasonal",135)=""
"RTN","C0ITEST",653,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, all formulations",128)=""
"RTN","C0ITEST",654,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, nasal",125)=""
"RTN","C0ITEST",655,0)
 S CVXMAP("B","Lyme disease",66)=""
"RTN","C0ITEST",656,0)
 S CVXMAP("B","Novel influenza-H1N1-09, preservative-free",126)=""
"RTN","C0ITEST",657,0)
 S CVXMAP("B","Novel influenza-H1N1-09",127)=""
"RTN","C0ITEST",658,0)
 S CVXMAP("B","pneumococcal conjugate PCV 7",100)=""
"RTN","C0ITEST",659,0)
 S CVXMAP("B","Pneumococcal conjugate PCV 13",133)=""
"RTN","C0ITEST",660,0)
 S CVXMAP("B","influenza, live, intranasal, quadrivalent",149)=""
"RTN","C0ITEST",661,0)
 S CVXMAP("B","influenza, recombinant, injectable, preservative free",155)=""
"RTN","C0ITEST",662,0)
 S CVXMAP("B","rabies, intramuscular injection",18)=""
"RTN","C0ITEST",663,0)
 S CVXMAP("B","rabies, intradermal injection",40)=""
"RTN","C0ITEST",664,0)
 S CVXMAP("B","rotavirus, pentavalent",116)=""
"RTN","C0ITEST",665,0)
 S CVXMAP("B","rotavirus, monovalent",119)=""
"RTN","C0ITEST",666,0)
 S CVXMAP("B","influenza, injectable, quadrivalent, preservative free",150)=""
"RTN","C0ITEST",667,0)
 S CVXMAP("B","influenza, injectable, quadrivalent, preservative free",150)=""
"RTN","C0ITEST",668,0)
 S CVXMAP("B","influenza, injectable, quadrivalent",158)=""
"RTN","C0ITEST",669,0)
 S CVXMAP("B","typhoid, oral",25)=""
"RTN","C0ITEST",670,0)
 S CVXMAP("B","typhoid, ViCPs",101)=""
"RTN","C0ITEST",671,0)
 S CVXMAP("B","typhoid, parenteral",41)=""
"RTN","C0ITEST",672,0)
 S CVXMAP("B","typhoid, parenteral, AKD (U.S. military)",53)=""
"RTN","C0ITEST",673,0)
 S CVXMAP("B","DTaP-IPV",130)=""
"RTN","C0ITEST",674,0)
 S CVXMAP("B","DTaP-Hib-IPV",120)=""
"RTN","C0ITEST",675,0)
 S CVXMAP("B","DTaP",20)=""
"RTN","C0ITEST",676,0)
 S CVXMAP("B","DTaP, 5 pertussis antigens",106)=""
"RTN","C0ITEST",677,0)
 S CVXMAP("B","DTP",01)=""
"RTN","C0ITEST",678,0)
 S CVXMAP("B","DT (pediatric)",28)=""
"RTN","C0ITEST",679,0)
 S CVXMAP("B","tetanus toxoid, adsorbed",35)=""
"RTN","C0ITEST",680,0)
 S CVXMAP("B","mumps",07)=""
"RTN","C0ITEST",681,0)
 S CVXMAP("B","measles",05)=""
"RTN","C0ITEST",682,0)
 S CVXMAP("B","rubella",06)=""
"RTN","C0ITEST",683,0)
 S CVXMAP("B","MMR",03)=""
"RTN","C0ITEST",684,0)
 S CVXMAP("B","M/R",04)=""
"RTN","C0ITEST",685,0)
 S CVXMAP("B","MMRV",94)=""
"RTN","C0ITEST",686,0)
 S CVXMAP("B","OPV",02)=""
"RTN","C0ITEST",687,0)
 S CVXMAP("B","IPV",10)=""
"RTN","C0ITEST",688,0)
 S CVXMAP("B","Td (adult) preservative free",113)=""
"RTN","C0ITEST",689,0)
 S CVXMAP("B","typhoid, unspecified formulation",91)=""
"RTN","C0ITEST",690,0)
 S CVXMAP("B","Tdap",115)=""
"RTN","C0ITEST",691,0)
 S CVXMAP("B","varicella",21)=""
"RTN","C0ITEST",692,0)
 S CVXMAP("B","yellow fever",37)=""
"RTN","C0ITEST",693,0)
 S CVXMAP("B","Td (adult), adsorbed",09)=""
"RTN","C0ITEST",694,0)
 S CVXMAP("B","DTP-Hib",22)=""
"RTN","C0ITEST",695,0)
 S CVXMAP("B","DTaP-Hib",50)=""
"RTN","C0ITEST",696,0)
 S CVXMAP("B","DTaP-Hep B-IPV",110)=""
"RTN","C0ITEST",697,0)
 S CVXMAP("B","influenza, unspecified formulation",88)=""
"RTN","C0ITEST",698,0)
 S CVXMAP("B","cholera",26)=""
"RTN","C0ITEST",699,0)
 S CVXMAP("B","rabies, unspecified formulation",90)=""
"RTN","C0ITEST",700,0)
 S CVXMAP("B","plague",23)=""
"RTN","C0ITEST",701,0)
 S CVXMAP("B","BCG",19)=""
"RTN","C0ITEST",702,0)
 S CVXMAP("B","Hep A, unspecified formulation",85)=""
"RTN","C0ITEST",703,0)
 S CVXMAP("B","Hep B, unspecified formulation",45)=""
"RTN","C0ITEST",704,0)
 S CVXMAP("B","pneumococcal polysaccharide PPV23",33)=""
"RTN","C0ITEST",705,0)
 S CVXMAP("B","meningococcal MPSV4",32)=""
"RTN","C0ITEST",706,0)
 S CVXMAP("B","Meningococcal MCV4O",136)=""
"RTN","C0ITEST",707,0)
 S CVXMAP("B","meningococcal MCV4P",114)=""
"RTN","C0ITEST",708,0)
 S CVXMAP("B","Japanese encephalitis SC",39)=""
"RTN","C0ITEST",709,0)
 S CVXMAP("B","zoster",121)=""
"RTN","C0ITEST",710,0)
 S CVXMAP("B","Hib, unspecified formulation",17)=""
"RTN","C0ITEST",711,0)
 S CVXMAP("B","Japanese Encephalitis IM",134)=""
"RTN","C0ITEST",712,0)
 S CVXMAP("B","Hep B, dialysis",44)=""
"RTN","C0ITEST",713,0)
 S CVXMAP("B","IG, unspecified formulation",14)=""
"RTN","C0ITEST",714,0)
 S CVXMAP("B","Hep B, adult",43)=""
"RTN","C0ITEST",715,0)
 S CVXMAP("B","Hep B, adolescent or pediatric",08)=""
"RTN","C0ITEST",716,0)
 S CVXMAP("B","Hep B, adolescent/high risk infant",42)=""
"RTN","C0ITEST",717,0)
 S CVXMAP("B","Hep B, adult",43)=""
"RTN","C0ITEST",718,0)
 S CVXMAP("B","Hep B, dialysis",44)=""
"RTN","C0ITEST",719,0)
 S CVXMAP("B","Hib-Hep B",51)=""
"RTN","C0ITEST",720,0)
 S CVXMAP("B","unknown",999)=""
"RTN","C0ITEST",721,0)
 Q
"RTN","C0ITEST",722,0)
 ;
"RTN","C0ITEST",723,0)
CPTIMAP
"RTN","C0ITEST",724,0)
 S CPTIMAP(90724)="INFLUENZA"
"RTN","C0ITEST",725,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-1"
"RTN","C0ITEST",726,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-2"
"RTN","C0ITEST",727,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-3"
"RTN","C0ITEST",728,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-4"
"RTN","C0ITEST",729,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 1"
"RTN","C0ITEST",730,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 2"
"RTN","C0ITEST",731,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 3"
"RTN","C0ITEST",732,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 4"
"RTN","C0ITEST",733,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 5"
"RTN","C0ITEST",734,0)
 S CPTIMAP(90645)="HIB PED 1"
"RTN","C0ITEST",735,0)
 S CPTIMAP(90645)="HIB PED 2"
"RTN","C0ITEST",736,0)
 S CPTIMAP(90645)="HIB PED 3"
"RTN","C0ITEST",737,0)
 S CPTIMAP(90645)="HIB PED 4"
"RTN","C0ITEST",738,0)
 S CPTIMAP(90707)="MEASLESMUMPSRUBELLA PED #1"
"RTN","C0ITEST",739,0)
 S CPTIMAP(90707)="MEASLESMUMPSRUBELLA PED #2"
"RTN","C0ITEST",740,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #1"
"RTN","C0ITEST",741,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #2"
"RTN","C0ITEST",742,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #3"
"RTN","C0ITEST",743,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #4"
"RTN","C0ITEST",744,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 1"
"RTN","C0ITEST",745,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 2"
"RTN","C0ITEST",746,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 3"
"RTN","C0ITEST",747,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 4"
"RTN","C0ITEST",748,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT)"
"RTN","C0ITEST",749,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 1"
"RTN","C0ITEST",750,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 2"
"RTN","C0ITEST",751,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 3"
"RTN","C0ITEST",752,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 4"
"RTN","C0ITEST",753,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 5"
"RTN","C0ITEST",754,0)
 S CPTIMAP(90732)="PNEUMOVAX"
"RTN","C0ITEST",755,0)
 S CPTIMAP(90715)="TETANUS DIPTHERIA AND PERTUSSIS"
"RTN","C0ITEST",756,0)
 S CPTIMAP(90634)="HEP B PED/ADOL 3 DOSE"
"RTN","C0ITEST",757,0)
 S CPTIMAP(90633)="HEP A2 PEDS"
"RTN","C0ITEST",758,0)
 S CPTIMAP(90633)="HEP A1 PEDS"
"RTN","C0ITEST",759,0)
 S CPTIMAP(90680)="RV 1 PEDS"
"RTN","C0ITEST",760,0)
 S CPTIMAP(90680)="RV 2 PEDS"
"RTN","C0ITEST",761,0)
 S CPTIMAP(90680)="RV 3 PEDS"
"RTN","C0ITEST",762,0)
 S CPTIMAP(90647)="HiB1"
"RTN","C0ITEST",763,0)
 S CPTIMAP(90647)="HiB2"
"RTN","C0ITEST",764,0)
 S CPTIMAP(90647)="HiB3"
"RTN","C0ITEST",765,0)
 S CPTIMAP(90669)="PCV1 PEDS"
"RTN","C0ITEST",766,0)
 S CPTIMAP(90669)="PCV2 PEDS"
"RTN","C0ITEST",767,0)
 S CPTIMAP(90669)="PCV3 PEDS"
"RTN","C0ITEST",768,0)
 S CPTIMAP(90669)="PCV4 PEDS"
"RTN","C0ITEST",769,0)
 S CPTIMAP(90669)="PCV5 PEDS"
"RTN","C0ITEST",770,0)
 S CPTIMAP(90716)="VZV1 INFANT"
"RTN","C0ITEST",771,0)
 S CPTIMAP(90716)="VZV2 INFANT"
"RTN","C0ITEST",772,0)
 S CPTIMAP(90744)="HEP B1 INFANT"
"RTN","C0ITEST",773,0)
 S CPTIMAP(90744)="HEP B2 INFANT"
"RTN","C0ITEST",774,0)
 S CPTIMAP(90744)="HEP B3 INFANT"
"RTN","C0ITEST",775,0)
 S CPTIMAP(90744)="HEP B4 INFANT"
"RTN","C0ITEST",776,0)
 S CPTIMAP(90707)="MMR1"
"RTN","C0ITEST",777,0)
 S CPTIMAP(90713)="IPV1"
"RTN","C0ITEST",778,0)
 S CPTIMAP(90713)="IPV2"
"RTN","C0ITEST",779,0)
 S CPTIMAP(90713)="IPV3"
"RTN","C0ITEST",780,0)
 S CPTIMAP(90713)="IPV4"
"RTN","C0ITEST",781,0)
 S CPTIMAP(90700)="DTaP1"
"RTN","C0ITEST",782,0)
 S CPTIMAP(90700)="DTaP2"
"RTN","C0ITEST",783,0)
 S CPTIMAP(90700)="DTaP3"
"RTN","C0ITEST",784,0)
 S CPTIMAP(90700)="DTaP4"
"RTN","C0ITEST",785,0)
 S CPTIMAP(90700)="DTaP5"
"RTN","C0ITEST",786,0)
 S CPTIMAP(90634)="HEP A3 PEDS"
"RTN","C0ITEST",787,0)
 S CPTIMAP(90658)="FLU,3 YRS"
"RTN","C0ITEST",788,0)
 S CPTIMAP("B","INFLUENZA",90724)=""
"RTN","C0ITEST",789,0)
 S CPTIMAP("B","HEPB, PED/ADOL-1",90744)=""
"RTN","C0ITEST",790,0)
 S CPTIMAP("B","HEPB PED/ADOL-2",90744)=""
"RTN","C0ITEST",791,0)
 S CPTIMAP("B","HEPB PED/ADOL-3",90744)=""
"RTN","C0ITEST",792,0)
 S CPTIMAP("B","HEPB PED/ADOL-4",90744)=""
"RTN","C0ITEST",793,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 1",90701)=""
"RTN","C0ITEST",794,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 2",90701)=""
"RTN","C0ITEST",795,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 3",90701)=""
"RTN","C0ITEST",796,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 4",90701)=""
"RTN","C0ITEST",797,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 5",90701)=""
"RTN","C0ITEST",798,0)
 S CPTIMAP("B","HIB PED 1",90645)=""
"RTN","C0ITEST",799,0)
 S CPTIMAP("B","HIB PED 2",90645)=""
"RTN","C0ITEST",800,0)
 S CPTIMAP("B","HIB PED 3",90645)=""
"RTN","C0ITEST",801,0)
 S CPTIMAP("B","HIB PED 4",90645)=""
"RTN","C0ITEST",802,0)
 S CPTIMAP("B","MEASLES,MUMPS,RUBELLA PED #1",90707)=""
"RTN","C0ITEST",803,0)
 S CPTIMAP("B","MEASLES,MUMPS,RUBELLA PED #2",90707)=""
"RTN","C0ITEST",804,0)
 S CPTIMAP("B","POLIOVIRUS PED #1",90713)=""
"RTN","C0ITEST",805,0)
 S CPTIMAP("B","POLIOVIRUS PED #2",90713)=""
"RTN","C0ITEST",806,0)
 S CPTIMAP("B","POLIOVIRUS PED #3",90713)=""
"RTN","C0ITEST",807,0)
 S CPTIMAP("B","POLIOVIRUS PED #4",90713)=""
"RTN","C0ITEST",808,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 1",90670)=""
"RTN","C0ITEST",809,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 2",90670)=""
"RTN","C0ITEST",810,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 3",90670)=""
"RTN","C0ITEST",811,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 4",90670)=""
"RTN","C0ITEST",812,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT)",90701)=""
"RTN","C0ITEST",813,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 1",90701)=""
"RTN","C0ITEST",814,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 2",90701)=""
"RTN","C0ITEST",815,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 3",90701)=""
"RTN","C0ITEST",816,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 4",90701)=""
"RTN","C0ITEST",817,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 5",90701)=""
"RTN","C0ITEST",818,0)
 S CPTIMAP("B","PNEUMOVAX",90732)=""
"RTN","C0ITEST",819,0)
 S CPTIMAP("B","TETANUS, DIPTHERIA AND PERTUSSIS",90715)=""
"RTN","C0ITEST",820,0)
 S CPTIMAP("B","HEP B PED/ADOL 3 DOSE",90634)=""
"RTN","C0ITEST",821,0)
 S CPTIMAP("B","HEP A2 PEDS",90633)=""
"RTN","C0ITEST",822,0)
 S CPTIMAP("B","HEP A1 PEDS",90633)=""
"RTN","C0ITEST",823,0)
 S CPTIMAP("B","RV 1 PEDS",90680)=""
"RTN","C0ITEST",824,0)
 S CPTIMAP("B","RV 2 PEDS",90680)=""
"RTN","C0ITEST",825,0)
 S CPTIMAP("B","RV 3 PEDS",90680)=""
"RTN","C0ITEST",826,0)
 S CPTIMAP("B","HiB1",90647)=""
"RTN","C0ITEST",827,0)
 S CPTIMAP("B","HiB2",90647)=""
"RTN","C0ITEST",828,0)
 S CPTIMAP("B","HiB3",90647)=""
"RTN","C0ITEST",829,0)
 S CPTIMAP("B","PCV1 PEDS",90669)=""
"RTN","C0ITEST",830,0)
 S CPTIMAP("B","PCV2 PEDS",90669)=""
"RTN","C0ITEST",831,0)
 S CPTIMAP("B","PCV3 PEDS",90669)=""
"RTN","C0ITEST",832,0)
 S CPTIMAP("B","PCV4 PEDS",90669)=""
"RTN","C0ITEST",833,0)
 S CPTIMAP("B","PCV5 PEDS",90669)=""
"RTN","C0ITEST",834,0)
 S CPTIMAP("B","VZV1 INFANT",90716)=""
"RTN","C0ITEST",835,0)
 S CPTIMAP("B","VZV2 INFANT",90716)=""
"RTN","C0ITEST",836,0)
 S CPTIMAP("B","HEP B1 INFANT",90744)=""
"RTN","C0ITEST",837,0)
 S CPTIMAP("B","HEP B2 INFANT",90744)=""
"RTN","C0ITEST",838,0)
 S CPTIMAP("B","HEP B3 INFANT",90744)=""
"RTN","C0ITEST",839,0)
 S CPTIMAP("B","HEP B4 INFANT",90744)=""
"RTN","C0ITEST",840,0)
 S CPTIMAP("B","MMR1",90707)=""
"RTN","C0ITEST",841,0)
 S CPTIMAP("B","IPV1",90713)=""
"RTN","C0ITEST",842,0)
 S CPTIMAP("B","IPV2",90713)=""
"RTN","C0ITEST",843,0)
 S CPTIMAP("B","IPV3",90713)=""
"RTN","C0ITEST",844,0)
 S CPTIMAP("B","IPV4",90713)=""
"RTN","C0ITEST",845,0)
 S CPTIMAP("B","DTaP1",90700)=""
"RTN","C0ITEST",846,0)
 S CPTIMAP("B","DTaP2",90700)=""
"RTN","C0ITEST",847,0)
 S CPTIMAP("B","DTaP3",90700)=""
"RTN","C0ITEST",848,0)
 S CPTIMAP("B","DTaP4",90700)=""
"RTN","C0ITEST",849,0)
 S CPTIMAP("B","DTaP5",90700)=""
"RTN","C0ITEST",850,0)
 S CPTIMAP("B","HEP A3 PEDS",90634)=""
"RTN","C0ITEST",851,0)
 S CPTIMAP("B","FLU,3 YRS",90658)=""
"RTN","C0ITEST",852,0)
 Q
"RTN","C0ITEST",853,0)
 ;
"RTN","C0ITEST",854,0)
CVXIMAP 
"RTN","C0ITEST",855,0)
 S CVXIMAP(75)="SMALLPOX"
"RTN","C0ITEST",856,0)
 S CVXIMAP(09)="TETANUS DIPTHERIA (TD-ADULT)"
"RTN","C0ITEST",857,0)
 S CVXIMAP(01)="DIP.,PERT.,TET. (DPT)"
"RTN","C0ITEST",858,0)
 S CVXIMAP(35)="TETANUS TOXOID"
"RTN","C0ITEST",859,0)
 S CVXIMAP(91)="TYPHOID"
"RTN","C0ITEST",860,0)
 S CVXIMAP(02)="ORAL POLIOVIRUS"
"RTN","C0ITEST",861,0)
 S CVXIMAP(43)="SWINE FLU BIVAL"
"RTN","C0ITEST",862,0)
 S CVXIMAP(45)="HEPATITIS B"
"RTN","C0ITEST",863,0)
 S CVXIMAP(05)="MEASLES"
"RTN","C0ITEST",864,0)
 S CVXIMAP(88)="INFLUENZA"
"RTN","C0ITEST",865,0)
 S CVXIMAP(26)="CHOLERA"
"RTN","C0ITEST",866,0)
 S CVXIMAP(06)="RUBELLA"
"RTN","C0ITEST",867,0)
 S CVXIMAP(07)="MUMPS"
"RTN","C0ITEST",868,0)
 S CVXIMAP(19)="BCG"
"RTN","C0ITEST",869,0)
 S CVXIMAP(03)="MEASLES,MUMPS,RUBELLA (MMR)"
"RTN","C0ITEST",870,0)
 S CVXIMAP(04)="MEASLES,RUBELLA (MR)"
"RTN","C0ITEST",871,0)
 S CVXIMAP(33)="PNEUMOCOCCAL"
"RTN","C0ITEST",872,0)
 S CVXIMAP(37)="YELLOW FEVER"
"RTN","C0ITEST",873,0)
 S CVXIMAP(131)="TYPHUS"
"RTN","C0ITEST",874,0)
 S CVXIMAP(90)="RABIES"
"RTN","C0ITEST",875,0)
 S CVXIMAP(28)="DIPTHERIA-TETANUS (DT-PEDS)"
"RTN","C0ITEST",876,0)
 S CVXIMAP(17)="INFLUENZA B"
"RTN","C0ITEST",877,0)
 S CVXIMAP(85)="HEPATITIS A"
"RTN","C0ITEST",878,0)
 S CVXIMAP(32)="MENINGOCOCCAL"
"RTN","C0ITEST",879,0)
 S CVXIMAP(39)="ENCEPHALITIS"
"RTN","C0ITEST",880,0)
 S CVXIMAP(21)="CHICKENPOX"
"RTN","C0ITEST",881,0)
 S CVXIMAP(106)="DIP-TET-a/PERT"
"RTN","C0ITEST",882,0)
 S CVXIMAP(38)="RUBELLA, MUMPS"
"RTN","C0ITEST",883,0)
 S CVXIMAP(22)="DTB/HIB"
"RTN","C0ITEST",884,0)
 S CVXIMAP(94)="MEA-MUMPS-RUB-VARCELLA"
"RTN","C0ITEST",885,0)
 S CVXIMAP(23)="PLAGUE"
"RTN","C0ITEST",886,0)
 S CVXIMAP(14)="GAMMA GLOBULIN"
"RTN","C0ITEST",887,0)
 S CVXIMAP(54)="ADENOVIRUS,TYPE 4"
"RTN","C0ITEST",888,0)
 S CVXIMAP(55)="ADENOVIRUS,TYPE 7"
"RTN","C0ITEST",889,0)
 S CVXIMAP(24)="ANTHRAX,SC"
"RTN","C0ITEST",890,0)
 S CVXIMAP(19)="BCG,PERCUT"
"RTN","C0ITEST",891,0)
 S CVXIMAP(26)="CHOLERA, ORAL"
"RTN","C0ITEST",892,0)
 S CVXIMAP(52)="HEPA ADULT"
"RTN","C0ITEST",893,0)
 S CVXIMAP(83)="HEPA,PED/ADOL-2"
"RTN","C0ITEST",894,0)
 S CVXIMAP(84)="HEPA,PED/ADOL-3 DOSE"
"RTN","C0ITEST",895,0)
 S CVXIMAP(104)="HEPA/HEPB ADULT"
"RTN","C0ITEST",896,0)
 S CVXIMAP(47)="HIB,HBOC"
"RTN","C0ITEST",897,0)
 S CVXIMAP(46)="HIB,PRP-D"
"RTN","C0ITEST",898,0)
 S CVXIMAP(49)="HIB,PRP-OMP"
"RTN","C0ITEST",899,0)
 S CVXIMAP(48)="HIB,PRP-T"
"RTN","C0ITEST",900,0)
 S CVXIMAP(141)="FLU,3 YRS"
"RTN","C0ITEST",901,0)
 S CVXIMAP(16)="FLU,WHOLE"
"RTN","C0ITEST",902,0)
 S CVXIMAP(111)="FLU,NASAL"
"RTN","C0ITEST",903,0)
 S CVXIMAP(66)="LYME DISEASE"
"RTN","C0ITEST",904,0)
 S CVXIMAP(100)="PNEUMOCOCCAL,PED"
"RTN","C0ITEST",905,0)
 S CVXIMAP(18)="RABIES,IM"
"RTN","C0ITEST",906,0)
 S CVXIMAP(40)="RABIES,ID"
"RTN","C0ITEST",907,0)
 S CVXIMAP(116)="ROTOVIRUS,ORAL"
"RTN","C0ITEST",908,0)
 S CVXIMAP(25)="TYPHOID,ORAL"
"RTN","C0ITEST",909,0)
 S CVXIMAP(101)="TYPHOID"
"RTN","C0ITEST",910,0)
 S CVXIMAP(41)="TYPHOID,H-P,SC/ID"
"RTN","C0ITEST",911,0)
 S CVXIMAP(53)="TYPHOID,AKD,SC"
"RTN","C0ITEST",912,0)
 S CVXIMAP(44)="HEPB, ILL PAT"
"RTN","C0ITEST",913,0)
 S CVXIMAP(51)="HEPB/HIB"
"RTN","C0ITEST",914,0)
 S CVXIMAP(08)="HEPB, PED/ADOL-1"
"RTN","C0ITEST",915,0)
 S CVXIMAP(08)="HEPB PED/ADOL-2"
"RTN","C0ITEST",916,0)
 S CVXIMAP(08)="HEPB PED/ADOL-3"
"RTN","C0ITEST",917,0)
 S CVXIMAP(08)="HEPB PED/ADOL-4"
"RTN","C0ITEST",918,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 1"
"RTN","C0ITEST",919,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 2"
"RTN","C0ITEST",920,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 3"
"RTN","C0ITEST",921,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 4"
"RTN","C0ITEST",922,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 5"
"RTN","C0ITEST",923,0)
 S CVXIMAP(47)="HIB PED 1"
"RTN","C0ITEST",924,0)
 S CVXIMAP(47)="HIB PED 2"
"RTN","C0ITEST",925,0)
 S CVXIMAP(47)="HIB PED 3"
"RTN","C0ITEST",926,0)
 S CVXIMAP(47)="HIB PED 4"
"RTN","C0ITEST",927,0)
 S CVXIMAP(03)="MEASLES,MUMPS,RUBELLA PED #1"
"RTN","C0ITEST",928,0)
 S CVXIMAP(03)="MEASLES,MUMPS,RUBELLA PED #2"
"RTN","C0ITEST",929,0)
 S CVXIMAP(10)="POLIOVIRUS PED #1"
"RTN","C0ITEST",930,0)
 S CVXIMAP(10)="POLIOVIRUS PED #2"
"RTN","C0ITEST",931,0)
 S CVXIMAP(10)="POLIOVIRUS PED #3"
"RTN","C0ITEST",932,0)
 S CVXIMAP(10)="POLIOVIRUS PED #4"
"RTN","C0ITEST",933,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 1"
"RTN","C0ITEST",934,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 2"
"RTN","C0ITEST",935,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 3"
"RTN","C0ITEST",936,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 4"
"RTN","C0ITEST",937,0)
 S CVXIMAP(01)="DIP,PERT,TET (DPT)"
"RTN","C0ITEST",938,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 1"
"RTN","C0ITEST",939,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 2"
"RTN","C0ITEST",940,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 3"
"RTN","C0ITEST",941,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 4"
"RTN","C0ITEST",942,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 5"
"RTN","C0ITEST",943,0)
 S CVXIMAP(33)="PNEUMOVAX"
"RTN","C0ITEST",944,0)
 S CVXIMAP(115)="TETANUS, DIPTHERIA AND PERTUSSIS"
"RTN","C0ITEST",945,0)
 S CVXIMAP(08)="HEP B PED/ADOL 3 DOSE"
"RTN","C0ITEST",946,0)
 S CVXIMAP(106)="DTaP1"
"RTN","C0ITEST",947,0)
 S CVXIMAP(106)="DTaP2"
"RTN","C0ITEST",948,0)
 S CVXIMAP(106)="DTaP3"
"RTN","C0ITEST",949,0)
 S CVXIMAP(106)="DTaP4"
"RTN","C0ITEST",950,0)
 S CVXIMAP(106)="DTaP5"
"RTN","C0ITEST",951,0)
 S CVXIMAP(83)="HEP A1 PEDS"
"RTN","C0ITEST",952,0)
 S CVXIMAP(83)="HEP A2 PEDS"
"RTN","C0ITEST",953,0)
 S CVXIMAP(84)="HEP A3 PEDS"
"RTN","C0ITEST",954,0)
 S CVXIMAP(42)="HEP B1 INFANT"
"RTN","C0ITEST",955,0)
 S CVXIMAP(42)="HEP B2 INFANT"
"RTN","C0ITEST",956,0)
 S CVXIMAP(42)="HEP B3 INFANT"
"RTN","C0ITEST",957,0)
 S CVXIMAP(42)="HEP B4 INFANT"
"RTN","C0ITEST",958,0)
 S CVXIMAP(49)="HiB1"
"RTN","C0ITEST",959,0)
 S CVXIMAP(49)="HiB2"
"RTN","C0ITEST",960,0)
 S CVXIMAP(49)="HiB3"
"RTN","C0ITEST",961,0)
 S CVXIMAP(10)="IPV1"
"RTN","C0ITEST",962,0)
 S CVXIMAP(10)="IPV2"
"RTN","C0ITEST",963,0)
 S CVXIMAP(10)="IPV3"
"RTN","C0ITEST",964,0)
 S CVXIMAP(10)="IPV4"
"RTN","C0ITEST",965,0)
 S CVXIMAP(03)="MMR1"
"RTN","C0ITEST",966,0)
 S CVXIMAP(133)="PCV1 PEDS"
"RTN","C0ITEST",967,0)
 S CVXIMAP(133)="PCV2 PEDS"
"RTN","C0ITEST",968,0)
 S CVXIMAP(133)="PCV3 PEDS"
"RTN","C0ITEST",969,0)
 S CVXIMAP(133)="PCV4 PEDS"
"RTN","C0ITEST",970,0)
 S CVXIMAP(133)="PCV5 PEDS"
"RTN","C0ITEST",971,0)
 S CVXIMAP(116)="RV 1 PEDS"
"RTN","C0ITEST",972,0)
 S CVXIMAP(116)="RV 2 PEDS"
"RTN","C0ITEST",973,0)
 S CVXIMAP(116)="RV 3 PEDS"
"RTN","C0ITEST",974,0)
 S CVXIMAP(116)="RV 4 PEDS"
"RTN","C0ITEST",975,0)
 S CVXIMAP(21)="VZV1 INFANT"
"RTN","C0ITEST",976,0)
 S CVXIMAP(21)="VZV2 INFANT"
"RTN","C0ITEST",977,0)
 S CVXIMAP(141)="FLU,3 YRS"
"RTN","C0ITEST",978,0)
 S CVXIMAP("B","SMALLPOX",75)=""
"RTN","C0ITEST",979,0)
 S CVXIMAP("B","TETANUS DIPTHERIA (TD-ADULT)",09)=""
"RTN","C0ITEST",980,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT)",01)=""
"RTN","C0ITEST",981,0)
 S CVXIMAP("B","TETANUS TOXOID",35)=""
"RTN","C0ITEST",982,0)
 S CVXIMAP("B","TYPHOID",91)=""
"RTN","C0ITEST",983,0)
 S CVXIMAP("B","ORAL POLIOVIRUS",02)=""
"RTN","C0ITEST",984,0)
 S CVXIMAP("B","SWINE FLU BIVAL",43)=""
"RTN","C0ITEST",985,0)
 S CVXIMAP("B","HEPATITIS B",45)=""
"RTN","C0ITEST",986,0)
 S CVXIMAP("B","MEASLES",05)=""
"RTN","C0ITEST",987,0)
 S CVXIMAP("B","INFLUENZA",88)=""
"RTN","C0ITEST",988,0)
 S CVXIMAP("B","CHOLERA",26)=""
"RTN","C0ITEST",989,0)
 S CVXIMAP("B","RUBELLA",06)=""
"RTN","C0ITEST",990,0)
 S CVXIMAP("B","MUMPS",07)=""
"RTN","C0ITEST",991,0)
 S CVXIMAP("B","BCG",19)=""
"RTN","C0ITEST",992,0)
 S CVXIMAP("B","MEASLES,MUMPS,RUBELLA (MMR)",03)=""
"RTN","C0ITEST",993,0)
 S CVXIMAP("B","MEASLES,RUBELLA (MR)",04)=""
"RTN","C0ITEST",994,0)
 S CVXIMAP("B","PNEUMOCOCCAL",33)=""
"RTN","C0ITEST",995,0)
 S CVXIMAP("B","YELLOW FEVER",37)=""
"RTN","C0ITEST",996,0)
 S CVXIMAP("B","TYPHUS",131)=""
"RTN","C0ITEST",997,0)
 S CVXIMAP("B","RABIES",90)=""
"RTN","C0ITEST",998,0)
 S CVXIMAP("B","DIPTHERIA-TETANUS (DT-PEDS)",28)=""
"RTN","C0ITEST",999,0)
 S CVXIMAP("B","INFLUENZA B",17)=""
"RTN","C0ITEST",1000,0)
 S CVXIMAP("B","HEPATITIS A",85)=""
"RTN","C0ITEST",1001,0)
 S CVXIMAP("B","MENINGOCOCCAL",32)=""
"RTN","C0ITEST",1002,0)
 S CVXIMAP("B","ENCEPHALITIS",39)=""
"RTN","C0ITEST",1003,0)
 S CVXIMAP("B","CHICKENPOX",21)=""
"RTN","C0ITEST",1004,0)
 S CVXIMAP("B","DIP-TET-a/PERT",106)=""
"RTN","C0ITEST",1005,0)
 S CVXIMAP("B","RUBELLA, MUMPS",38)=""
"RTN","C0ITEST",1006,0)
 S CVXIMAP("B","DTB/HIB",22)=""
"RTN","C0ITEST",1007,0)
 S CVXIMAP("B","MEA-MUMPS-RUB-VARCELLA",94)=""
"RTN","C0ITEST",1008,0)
 S CVXIMAP("B","PLAGUE",23)=""
"RTN","C0ITEST",1009,0)
 S CVXIMAP("B","GAMMA GLOBULIN",14)=""
"RTN","C0ITEST",1010,0)
 S CVXIMAP("B","ADENOVIRUS,TYPE 4",54)=""
"RTN","C0ITEST",1011,0)
 S CVXIMAP("B","ADENOVIRUS,TYPE 7",55)=""
"RTN","C0ITEST",1012,0)
 S CVXIMAP("B","ANTHRAX,SC",24)=""
"RTN","C0ITEST",1013,0)
 S CVXIMAP("B","BCG,PERCUT",19)=""
"RTN","C0ITEST",1014,0)
 S CVXIMAP("B","CHOLERA, ORAL",26)=""
"RTN","C0ITEST",1015,0)
 S CVXIMAP("B","HEPA ADULT",52)=""
"RTN","C0ITEST",1016,0)
 S CVXIMAP("B","HEPA,PED/ADOL-2",83)=""
"RTN","C0ITEST",1017,0)
 S CVXIMAP("B","HEPA,PED/ADOL-3 DOSE",84)=""
"RTN","C0ITEST",1018,0)
 S CVXIMAP("B","HEPA/HEPB ADULT",104)=""
"RTN","C0ITEST",1019,0)
 S CVXIMAP("B","HIB,HBOC",47)=""
"RTN","C0ITEST",1020,0)
 S CVXIMAP("B","HIB,PRP-D",46)=""
"RTN","C0ITEST",1021,0)
 S CVXIMAP("B","HIB,PRP-OMP",49)=""
"RTN","C0ITEST",1022,0)
 S CVXIMAP("B","HIB,PRP-T",48)=""
"RTN","C0ITEST",1023,0)
 S CVXIMAP("B","FLU,3 YRS",141)=""
"RTN","C0ITEST",1024,0)
 S CVXIMAP("B","FLU,WHOLE",16)=""
"RTN","C0ITEST",1025,0)
 S CVXIMAP("B","FLU,NASAL",111)=""
"RTN","C0ITEST",1026,0)
 S CVXIMAP("B","LYME DISEASE",66)=""
"RTN","C0ITEST",1027,0)
 S CVXIMAP("B","PNEUMOCOCCAL,PED",100)=""
"RTN","C0ITEST",1028,0)
 S CVXIMAP("B","RABIES,IM",18)=""
"RTN","C0ITEST",1029,0)
 S CVXIMAP("B","RABIES,ID",40)=""
"RTN","C0ITEST",1030,0)
 S CVXIMAP("B","ROTOVIRUS,ORAL",116)=""
"RTN","C0ITEST",1031,0)
 S CVXIMAP("B","TYPHOID,ORAL",25)=""
"RTN","C0ITEST",1032,0)
 S CVXIMAP("B","TYPHOID",101)=""
"RTN","C0ITEST",1033,0)
 S CVXIMAP("B","TYPHOID,H-P,SC/ID",41)=""
"RTN","C0ITEST",1034,0)
 S CVXIMAP("B","TYPHOID,AKD,SC",53)=""
"RTN","C0ITEST",1035,0)
 S CVXIMAP("B","HEPB, ILL PAT",44)=""
"RTN","C0ITEST",1036,0)
 S CVXIMAP("B","HEPB/HIB",51)=""
"RTN","C0ITEST",1037,0)
 S CVXIMAP("B","HEPB, PED/ADOL-1",08)=""
"RTN","C0ITEST",1038,0)
 S CVXIMAP("B","HEPB PED/ADOL-2",08)=""
"RTN","C0ITEST",1039,0)
 S CVXIMAP("B","HEPB PED/ADOL-3",08)=""
"RTN","C0ITEST",1040,0)
 S CVXIMAP("B","HEPB PED/ADOL-4",08)=""
"RTN","C0ITEST",1041,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 1",20)=""
"RTN","C0ITEST",1042,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 2",20)=""
"RTN","C0ITEST",1043,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 3",20)=""
"RTN","C0ITEST",1044,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 4",20)=""
"RTN","C0ITEST",1045,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 5",20)=""
"RTN","C0ITEST",1046,0)
 S CVXIMAP("B","HIB PED 1",47)=""
"RTN","C0ITEST",1047,0)
 S CVXIMAP("B","HIB PED 2",47)=""
"RTN","C0ITEST",1048,0)
 S CVXIMAP("B","HIB PED 3",47)=""
"RTN","C0ITEST",1049,0)
 S CVXIMAP("B","HIB PED 4",47)=""
"RTN","C0ITEST",1050,0)
 S CVXIMAP("B","MEASLES,MUMPS,RUBELLA PED #1",03)=""
"RTN","C0ITEST",1051,0)
 S CVXIMAP("B","MEASLES,MUMPS,RUBELLA PED #2",03)=""
"RTN","C0ITEST",1052,0)
 S CVXIMAP("B","POLIOVIRUS PED #1",10)=""
"RTN","C0ITEST",1053,0)
 S CVXIMAP("B","POLIOVIRUS PED #2",10)=""
"RTN","C0ITEST",1054,0)
 S CVXIMAP("B","POLIOVIRUS PED #3",10)=""
"RTN","C0ITEST",1055,0)
 S CVXIMAP("B","POLIOVIRUS PED #4",10)=""
"RTN","C0ITEST",1056,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 1",100)=""
"RTN","C0ITEST",1057,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 2",100)=""
"RTN","C0ITEST",1058,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 3",100)=""
"RTN","C0ITEST",1059,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 4",100)=""
"RTN","C0ITEST",1060,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT)",01)=""
"RTN","C0ITEST",1061,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 1",106)=""
"RTN","C0ITEST",1062,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 2",106)=""
"RTN","C0ITEST",1063,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 3",106)=""
"RTN","C0ITEST",1064,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 4",106)=""
"RTN","C0ITEST",1065,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 5",106)=""
"RTN","C0ITEST",1066,0)
 S CVXIMAP("B","PNEUMOVAX",33)=""
"RTN","C0ITEST",1067,0)
 S CVXIMAP("B","TETANUS, DIPTHERIA AND PERTUSSIS",115)=""
"RTN","C0ITEST",1068,0)
 S CVXIMAP("B","HEP B PED/ADOL 3 DOSE",08)=""
"RTN","C0ITEST",1069,0)
 S CVXIMAP("B","DTaP1",106)=""
"RTN","C0ITEST",1070,0)
 S CVXIMAP("B","DTaP2",106)=""
"RTN","C0ITEST",1071,0)
 S CVXIMAP("B","DTaP3",106)=""
"RTN","C0ITEST",1072,0)
 S CVXIMAP("B","DTaP4",106)=""
"RTN","C0ITEST",1073,0)
 S CVXIMAP("B","DTaP5",106)=""
"RTN","C0ITEST",1074,0)
 S CVXIMAP("B","HEP A1 PEDS",83)=""
"RTN","C0ITEST",1075,0)
 S CVXIMAP("B","HEP A2 PEDS",83)=""
"RTN","C0ITEST",1076,0)
 S CVXIMAP("B","HEP A3 PEDS",84)=""
"RTN","C0ITEST",1077,0)
 S CVXIMAP("B","HEP B1 INFANT",42)=""
"RTN","C0ITEST",1078,0)
 S CVXIMAP("B","HEP B2 INFANT",42)=""
"RTN","C0ITEST",1079,0)
 S CVXIMAP("B","HEP B3 INFANT",42)=""
"RTN","C0ITEST",1080,0)
 S CVXIMAP("B","HEP B4 INFANT",42)=""
"RTN","C0ITEST",1081,0)
 S CVXIMAP("B","HiB1",49)=""
"RTN","C0ITEST",1082,0)
 S CVXIMAP("B","HiB2",49)=""
"RTN","C0ITEST",1083,0)
 S CVXIMAP("B","HiB3",49)=""
"RTN","C0ITEST",1084,0)
 S CVXIMAP("B","IPV1",10)=""
"RTN","C0ITEST",1085,0)
 S CVXIMAP("B","IPV2",10)=""
"RTN","C0ITEST",1086,0)
 S CVXIMAP("B","IPV3",10)=""
"RTN","C0ITEST",1087,0)
 S CVXIMAP("B","IPV4",10)=""
"RTN","C0ITEST",1088,0)
 S CVXIMAP("B","MMR1",03)=""
"RTN","C0ITEST",1089,0)
 S CVXIMAP("B","PCV1 PEDS",133)=""
"RTN","C0ITEST",1090,0)
 S CVXIMAP("B","PCV2 PEDS",133)=""
"RTN","C0ITEST",1091,0)
 S CVXIMAP("B","PCV3 PEDS",133)=""
"RTN","C0ITEST",1092,0)
 S CVXIMAP("B","PCV4 PEDS",133)=""
"RTN","C0ITEST",1093,0)
 S CVXIMAP("B","PCV5 PEDS",133)=""
"RTN","C0ITEST",1094,0)
 S CVXIMAP("B","RV 1 PEDS",116)=""
"RTN","C0ITEST",1095,0)
 S CVXIMAP("B","RV 2 PEDS",116)=""
"RTN","C0ITEST",1096,0)
 S CVXIMAP("B","RV 3 PEDS",116)=""
"RTN","C0ITEST",1097,0)
 S CVXIMAP("B","RV 4 PEDS",116)=""
"RTN","C0ITEST",1098,0)
 S CVXIMAP("B","VZV1 INFANT",21)=""
"RTN","C0ITEST",1099,0)
 S CVXIMAP("B","VZV2 INFANT",21)=""
"RTN","C0ITEST",1100,0)
 S CVXIMAP("B","FLU,3 YRS",141)=""
"RTN","C0ITEST",1101,0)
 Q
"RTN","C0ITEST",1102,0)
 ;
"RTN","C0ITEST",1103,0)
ALLMAP ; 
"RTN","C0ITEST",1104,0)
 ; create a single map out the above maps
"RTN","C0ITEST",1105,0)
 N CVX,MAP
"RTN","C0ITEST",1106,0)
 S CVX=""
"RTN","C0ITEST",1107,0)
 D CPTMAP
"RTN","C0ITEST",1108,0)
 D CVXMAP
"RTN","C0ITEST",1109,0)
 D CPTIMAP
"RTN","C0ITEST",1110,0)
 D CVXIMAP
"RTN","C0ITEST",1111,0)
 S MAP=$NA(^C0CodeMap("immunizations"))
"RTN","C0ITEST",1112,0)
 K @MAP
"RTN","C0ITEST",1113,0)
 F  S CVX=$O(CVXMAP(CVX)) Q:+CVX=0  D  ;
"RTN","C0ITEST",1114,0)
 . S @MAP@(CVX,"preferredName")=CVXMAP(CVX)
"RTN","C0ITEST",1115,0)
 . S @MAP@(CVX,"CVXcode")=CVX
"RTN","C0ITEST",1116,0)
 . S @MAP@("B",CVXMAP(CVX),CVX)=""
"RTN","C0ITEST",1117,0)
 . D:$G(CVXIMAP(CVX))'="" 
"RTN","C0ITEST",1118,0)
 . . S @MAP@(CVX,"altName",1)=CVXIMAP(CVX)
"RTN","C0ITEST",1119,0)
 . . S @MAP@("B",CVXIMAP(CVX),CVX)=""
"RTN","C0ITEST",1120,0)
 N CPT S CPT=""
"RTN","C0ITEST",1121,0)
 F  S CPT=$O(CPTMAP(CPT)) Q:+CPT=0  D  ;
"RTN","C0ITEST",1122,0)
 . S CVX=CPTMAP(CPT)
"RTN","C0ITEST",1123,0)
 . S @MAP@(CVX,"CPT")=CPT
"RTN","C0ITEST",1124,0)
 . S @MAP@("CPT",CPT,CVX)=""
"RTN","C0ITEST",1125,0)
 ; now do all the extra names in the B index of CVXIMAP
"RTN","C0ITEST",1126,0)
 N ZJ S ZJ=""
"RTN","C0ITEST",1127,0)
 F  S ZJ=$O(CVXIMAP("B",ZJ)) Q:ZJ=""  D  ;
"RTN","C0ITEST",1128,0)
 . S CVX=""
"RTN","C0ITEST",1129,0)
 . F  S CVX=$O(CVXIMAP("B",ZJ,CVX)) Q:CVX=""  D  ;
"RTN","C0ITEST",1130,0)
 . . I $D(@MAP@("B",ZJ)) Q  ; already in the map
"RTN","C0ITEST",1131,0)
 . . S @MAP@(CVX,"altName",$O(@MAP@(CVX,"altName",""),-1)+1)=ZJ
"RTN","C0ITEST",1132,0)
 . . S @MAP@("B",ZJ,CVX)=""
"RTN","C0ITEST",1133,0)
 M G=@MAP
"RTN","C0ITEST",1134,0)
 ZWR G
"RTN","C0ITEST",1135,0)
 Q
"RTN","C0ITEST",1136,0)
 ;
"RTN","C0IUTIL")
0^4^B149111605
"RTN","C0IUTIL",1,0)
C0IUTIL ; GPL/NEA - Immunizations Forecasting Utilities ;05/03/14  17:05
"RTN","C0IUTIL",2,0)
 ;;0.1;Immunizations Forecasting;nopatch;noreleasedate;Build 1
"RTN","C0IUTIL",3,0)
 ;
"RTN","C0IUTIL",4,0)
 ; License Apache 2
"RTN","C0IUTIL",5,0)
 ; 
"RTN","C0IUTIL",6,0)
 Q
"RTN","C0IUTIL",7,0)
 ;
"RTN","C0IUTIL",8,0)
GETNMAP(OUTXML,INXML,IARY) ; Retrieves XML stored in Mumps routines and maps
"RTN","C0IUTIL",9,0)
 ; them using IARY, passed by name. Maps use @@var@@ protocol
"RTN","C0IUTIL",10,0)
 ; with @IARY@("var")=value for the map values
"RTN","C0IUTIL",11,0)
 ; OUTXML is passed by name and will hold the result
"RTN","C0IUTIL",12,0)
 ; INXML is the name of the storage place ie "HEADER^JJOHPPC2"
"RTN","C0IUTIL",13,0)
 N GTAG,GRT,GI
"RTN","C0IUTIL",14,0)
 S GTAG=$P(INXML,"^",1)
"RTN","C0IUTIL",15,0)
 S GRT=$P(INXML,"^",2)
"RTN","C0IUTIL",16,0)
 ; first get all of the lines of the XML
"RTN","C0IUTIL",17,0)
 N TXML ; temp var for xml
"RTN","C0IUTIL",18,0)
 S GX=1
"RTN","C0IUTIL",19,0)
 S GN=1
"RTN","C0IUTIL",20,0)
 F  S GI=GTAG_"+"_GX_"^"_GRT  Q:$T(@GI)'[";;"  D  ;
"RTN","C0IUTIL",21,0)
 . S GX=GX+1
"RTN","C0IUTIL",22,0)
 . N LN S LN=$P($T(@GI),";;",2)
"RTN","C0IUTIL",23,0)
 . I $E(LN,1)=";" Q  ; skip over comments
"RTN","C0IUTIL",24,0)
 . S TXML(GN)=LN
"RTN","C0IUTIL",25,0)
 . I $G(CCDADEBUG) W !,GN," ",TXML(GN)
"RTN","C0IUTIL",26,0)
 . S GN=GN+1
"RTN","C0IUTIL",27,0)
 ; next call MAP to resolve mappings and place result directly in OUTXML
"RTN","C0IUTIL",28,0)
 ; if OUTXML has contents already, add the result to the end and update the count (0)
"RTN","C0IUTIL",29,0)
 I $D(@OUTXML@(1)) D  ;
"RTN","C0IUTIL",30,0)
 . N TXML2
"RTN","C0IUTIL",31,0)
 . D MAP^MXMLTMPL("TXML",IARY,"TXML2")
"RTN","C0IUTIL",32,0)
 . S GI=0
"RTN","C0IUTIL",33,0)
 . F  S GI=$O(TXML2(GI)) Q:+GI=0  S @OUTXML@($O(@OUTXML@(""),-1)+1)=TXML2(GI)
"RTN","C0IUTIL",34,0)
 . S @OUTXML@(0)=$O(@OUTXML@(""),-1)
"RTN","C0IUTIL",35,0)
 E  D MAP^MXMLTMPL("TXML",IARY,OUTXML)
"RTN","C0IUTIL",36,0)
 Q
"RTN","C0IUTIL",37,0)
 ;
"RTN","C0IUTIL",38,0)
GET(OUTXML,INXML) ; GET ONLY Retrieves XML stored in Mumps routines 
"RTN","C0IUTIL",39,0)
 ; OUTXML is passed by name and will hold the result
"RTN","C0IUTIL",40,0)
 ; INXML is the name of the storage place ie "HEADER^JJOHPPC2"
"RTN","C0IUTIL",41,0)
 N GTAG,GRT,GI
"RTN","C0IUTIL",42,0)
 S GTAG=$P(INXML,"^",1)
"RTN","C0IUTIL",43,0)
 S GRT=$P(INXML,"^",2)
"RTN","C0IUTIL",44,0)
 ; get all of the lines of the XML
"RTN","C0IUTIL",45,0)
 S GX=1
"RTN","C0IUTIL",46,0)
 S GN=1
"RTN","C0IUTIL",47,0)
 F  S GI=GTAG_"+"_GX_"^"_GRT  Q:$T(@GI)'[";;"  D  ;
"RTN","C0IUTIL",48,0)
 . S GX=GX+1
"RTN","C0IUTIL",49,0)
 . N LN S LN=$P($T(@GI),";;",2)
"RTN","C0IUTIL",50,0)
 . I $E(LN,1)=";" Q  ; skip over comments
"RTN","C0IUTIL",51,0)
 . S @OUTXML@($O(@OUTXML@(""),-1)+1)=LN
"RTN","C0IUTIL",52,0)
 . S @OUTXML@(0)=$O(@OUTXML@(""),-1)
"RTN","C0IUTIL",53,0)
 . I $G(CCDADEBUG) W !,GN," ",@OUTXML@(GN)
"RTN","C0IUTIL",54,0)
 . S GN=GN+1
"RTN","C0IUTIL",55,0)
 Q
"RTN","C0IUTIL",56,0)
 ;
"RTN","C0IUTIL",57,0)
TEST ;
"RTN","C0IUTIL",58,0)
 N GV S GV("hl7OutTime")=$$FMDTOUTC^C0IUTIL(DT)
"RTN","C0IUTIL",59,0)
 K G
"RTN","C0IUTIL",60,0)
 D GETNMAP("G","TENVOUT^C0ITEST","GV")
"RTN","C0IUTIL",61,0)
 ZWR G
"RTN","C0IUTIL",62,0)
 Q
"RTN","C0IUTIL",63,0)
 ;
"RTN","C0IUTIL",64,0)
OUTLOG(ZTXT) ; add text to the log
"RTN","C0IUTIL",65,0)
 I '$D(C0LOGLOC) S C0LOGLOC=$NA(^TMP("C0I",$J,"LOG"))
"RTN","C0IUTIL",66,0)
 N LN S LN=$O(@C0LOGLOC@(""),-1)+1
"RTN","C0IUTIL",67,0)
 S @C0LOGLOC@(LN)=ZTXT
"RTN","C0IUTIL",68,0)
 Q
"RTN","C0IUTIL",69,0)
 ;
"RTN","C0IUTIL",70,0)
LOGARY(ARY) ; LOG AN ARRAY
"RTN","C0IUTIL",71,0)
 N II S II=""
"RTN","C0IUTIL",72,0)
 F  S II=$O(@ARY@(II)) Q:II=""  D  ;
"RTN","C0IUTIL",73,0)
 . D OUTLOG(ARY_" "_II_" = "_$G(@ARY@(II)))
"RTN","C0IUTIL",74,0)
 Q
"RTN","C0IUTIL",75,0)
 ;
"RTN","C0IUTIL",76,0)
UUID()  ; thanks to Wally for this.
"RTN","C0IUTIL",77,0)
 N R,I,J,N 
"RTN","C0IUTIL",78,0)
 S N="",R="" F  S N=N_$R(100000) Q:$L(N)>64 
"RTN","C0IUTIL",79,0)
 F I=1:2:64 S R=R_$E("0123456789abcdef",($E(N,I,I+1)#16+1)) 
"RTN","C0IUTIL",80,0)
 Q $E(R,1,8)_"-"_$E(R,9,12)_"-4"_$E(R,14,16)_"-"_$E("89ab",$E(N,17)#4+1)_$E(R,18,20)_"-"_$E(R,21,32)
"RTN","C0IUTIL",81,0)
 ;
"RTN","C0IUTIL",82,0)
 ; the following was borrowed from the C0CUTIL and adapted
"RTN","C0IUTIL",83,0)
 ;
"RTN","C0IUTIL",84,0)
FMDTOCDA(DATE,FORMAT) ; Convert Fileman Date to UTC Date Format; PUBLIC; Extrinsic
"RTN","C0IUTIL",85,0)
 ; FORMAT is Format of Date. Can be either D (Day) or DT (Date and Time)
"RTN","C0IUTIL",86,0)
 ; If not passed, or passed incorrectly, it's assumed that it is D.
"RTN","C0IUTIL",87,0)
 ; FM Date format is "YYYMMDD.HHMMSS" HHMMSS may not be supplied.
"RTN","C0IUTIL",88,0)
 ; UTC date is formatted as follows: YYYY-MM-DDThh:mm:ss_offsetfromUTC
"RTN","C0IUTIL",89,0)
 ; UTC, Year, Month, Day, Hours, Minutes, Seconds, Time offset (obtained from Mailman Site Parameters)
"RTN","C0IUTIL",90,0)
 N UTC,Y,M,D,H,MM,S,OFF
"RTN","C0IUTIL",91,0)
 S Y=1700+$E(DATE,1,3)
"RTN","C0IUTIL",92,0)
 S M=$E(DATE,4,5)
"RTN","C0IUTIL",93,0)
 S D=$E(DATE,6,7)
"RTN","C0IUTIL",94,0)
 S H=$E(DATE,9,10)
"RTN","C0IUTIL",95,0)
 I $L(H)=1 S H="0"_H
"RTN","C0IUTIL",96,0)
 S MM=$E(DATE,11,12)
"RTN","C0IUTIL",97,0)
 I $L(MM)=1 S MM="0"_MM
"RTN","C0IUTIL",98,0)
 S S=$E(DATE,13,14)
"RTN","C0IUTIL",99,0)
 I $L(S)=1 S S="0"_S
"RTN","C0IUTIL",100,0)
 S OFF=$$TZ^XLFDT ; See Kernel Manual for documentation.
"RTN","C0IUTIL",101,0)
 S OFFS=$E(OFF,1,1)
"RTN","C0IUTIL",102,0)
 S OFF0=$TR(OFF,"+-")
"RTN","C0IUTIL",103,0)
 S OFF1=$E(OFF0+10000,2,3)
"RTN","C0IUTIL",104,0)
 S OFF2=$E(OFF0+10000,4,5)
"RTN","C0IUTIL",105,0)
 ;S OFF=OFFS_OFF1_":"_OFF2
"RTN","C0IUTIL",106,0)
 S OFF=OFFS_OFF1_OFF2
"RTN","C0IUTIL",107,0)
 ;S OFF2=$E(OFF,1,2) ;
"RTN","C0IUTIL",108,0)
 ;S OFF2=$E(100+OFF2,2,3) ; GPL 11/08 CHANGED TO -05:00 FORMAT
"RTN","C0IUTIL",109,0)
 ;S OFF3=$E(OFF,3,4) ;MINUTES
"RTN","C0IUTIL",110,0)
 ;S OFF=$S(OFF2="":"00",0:"00",1:OFF2)_"."_$S(OFF3="":"00",1:OFF3)
"RTN","C0IUTIL",111,0)
 ; If H, MM and S are empty, it means that the FM date didn't supply the time.
"RTN","C0IUTIL",112,0)
 ; In this case, set H, MM and S to "00"
"RTN","C0IUTIL",113,0)
 ; S:('$L(H)&'$L(MM)&'$L(S)) (H,MM,S)="00" ; IF ONLY SOME ARE MISSING?
"RTN","C0IUTIL",114,0)
 S:'$L(H) H="00"
"RTN","C0IUTIL",115,0)
 S:'$L(MM) MM="00"
"RTN","C0IUTIL",116,0)
 S:'$L(S) S="00"
"RTN","C0IUTIL",117,0)
 S UTC=Y_M_D_H_MM_$S(S="":"00",1:S)_OFF ; Skip's code to fix hanging colon if no seconds
"RTN","C0IUTIL",118,0)
 ;S UTC=Y_"-"_M_"-"_D_"T"_H_":"_MM_$S(S="":":00",1:":"_S)_OFF ; Skip's code to fix hanging colon if no seconds
"RTN","C0IUTIL",119,0)
 I $E(UTC,9,14)="000000" S UTC=$E(UTC,1,8) ; admit our precision gpl 9/2013
"RTN","C0IUTIL",120,0)
 S UTC=$E(UTC,1,8) ; admit our precision gpl 6/2014 only date no time
"RTN","C0IUTIL",121,0)
 I $L($G(FORMAT)),FORMAT="DT" Q UTC ; Date with time.
"RTN","C0IUTIL",122,0)
 E  Q $P(UTC,"T")
"RTN","C0IUTIL",123,0)
 ;
"RTN","C0IUTIL",124,0)
FMDTOUT2(DATE,FORMAT) ; Convert Fileman Date to UTC Date Format; PUBLIC; Extrinsic
"RTN","C0IUTIL",125,0)
 ; FORMAT is Format of Date. Can be either D (Day) or DT (Date and Time)
"RTN","C0IUTIL",126,0)
 ; If not passed, or passed incorrectly, it's assumed that it is D.
"RTN","C0IUTIL",127,0)
 ; FM Date format is "YYYMMDD.HHMMSS" HHMMSS may not be supplied.
"RTN","C0IUTIL",128,0)
 ; UTC date is formatted as follows: YYYY-MM-DDThh:mm:ss_offsetfromUTC
"RTN","C0IUTIL",129,0)
 ; UTC, Year, Month, Day, Hours, Minutes, Seconds, Time offset (obtained from Mailman Site Parameters)
"RTN","C0IUTIL",130,0)
 N UTC,Y,M,D,H,MM,S,OFF
"RTN","C0IUTIL",131,0)
 S Y=1700+$E(DATE,1,3)
"RTN","C0IUTIL",132,0)
 S M=$E(DATE,4,5)
"RTN","C0IUTIL",133,0)
 S D=$E(DATE,6,7)
"RTN","C0IUTIL",134,0)
 S H=$E(DATE,9,10)
"RTN","C0IUTIL",135,0)
 I $L(H)=1 S H="0"_H
"RTN","C0IUTIL",136,0)
 S MM=$E(DATE,11,12)
"RTN","C0IUTIL",137,0)
 I $L(MM)=1 S MM="0"_MM
"RTN","C0IUTIL",138,0)
 S S=$E(DATE,13,14)
"RTN","C0IUTIL",139,0)
 I $L(S)=1 S S="0"_S
"RTN","C0IUTIL",140,0)
 S OFF=$$TZ^XLFDT ; See Kernel Manual for documentation.
"RTN","C0IUTIL",141,0)
 S OFFS=$E(OFF,1,1)
"RTN","C0IUTIL",142,0)
 S OFF0=$TR(OFF,"+-")
"RTN","C0IUTIL",143,0)
 S OFF1=$E(OFF0+10000,2,3)
"RTN","C0IUTIL",144,0)
 S OFF2=$E(OFF0+10000,4,5)
"RTN","C0IUTIL",145,0)
 ;S OFF=OFFS_OFF1_":"_OFF2
"RTN","C0IUTIL",146,0)
 S OFF=OFFS_OFF1_OFF2
"RTN","C0IUTIL",147,0)
 ;S OFF2=$E(OFF,1,2) ;
"RTN","C0IUTIL",148,0)
 ;S OFF2=$E(100+OFF2,2,3) ; GPL 11/08 CHANGED TO -05:00 FORMAT
"RTN","C0IUTIL",149,0)
 ;S OFF3=$E(OFF,3,4) ;MINUTES
"RTN","C0IUTIL",150,0)
 ;S OFF=$S(OFF2="":"00",0:"00",1:OFF2)_"."_$S(OFF3="":"00",1:OFF3)
"RTN","C0IUTIL",151,0)
 ; If H, MM and S are empty, it means that the FM date didn't supply the time.
"RTN","C0IUTIL",152,0)
 ; In this case, set H, MM and S to "00"
"RTN","C0IUTIL",153,0)
 ; S:('$L(H)&'$L(MM)&'$L(S)) (H,MM,S)="00" ; IF ONLY SOME ARE MISSING?
"RTN","C0IUTIL",154,0)
 S:'$L(H) H="00"
"RTN","C0IUTIL",155,0)
 S:'$L(MM) MM="00"
"RTN","C0IUTIL",156,0)
 S:'$L(S) S="00"
"RTN","C0IUTIL",157,0)
 S UTC=Y_M_D_H_MM_$S(S="":"00",1:S)_OFF ; Skip's code to fix hanging colon if no seconds
"RTN","C0IUTIL",158,0)
 ;S UTC=Y_"-"_M_"-"_D_"T"_H_":"_MM_$S(S="":":00",1:":"_S)_OFF ; Skip's code to fix hanging colon if no seconds
"RTN","C0IUTIL",159,0)
 I $E(UTC,9,14)="000000" S UTC=$E(UTC,1,8) ; admit our precision gpl 9/2013
"RTN","C0IUTIL",160,0)
 I $L($G(FORMAT)),FORMAT="DT" Q UTC ; Date with time.
"RTN","C0IUTIL",161,0)
 E  Q $P(UTC,"T")
"RTN","C0IUTIL",162,0)
 ;
"RTN","C0IUTIL",163,0)
FMDTOUTC(DATE,FORMAT) ; Convert Fileman Date to UTC Date Format; PUBLIC; Extrinsic
"RTN","C0IUTIL",164,0)
 ; FORMAT is Format of Date. Can be either D (Day) or DT (Date and Time)
"RTN","C0IUTIL",165,0)
 ; If not passed, or passed incorrectly, it's assumed that it is D.
"RTN","C0IUTIL",166,0)
 ; FM Date format is "YYYMMDD.HHMMSS" HHMMSS may not be supplied.
"RTN","C0IUTIL",167,0)
 ; UTC date is formatted as follows: YYYY-MM-DDThh:mm:ss_offsetfromUTC
"RTN","C0IUTIL",168,0)
 ; UTC, Year, Month, Day, Hours, Minutes, Seconds, Time offset (obtained from Mailman Site Parameters)
"RTN","C0IUTIL",169,0)
 N UTC,Y,M,D,H,MM,S,OFF
"RTN","C0IUTIL",170,0)
 S Y=1700+$E(DATE,1,3)
"RTN","C0IUTIL",171,0)
 S M=$E(DATE,4,5)
"RTN","C0IUTIL",172,0)
 S D=$E(DATE,6,7)
"RTN","C0IUTIL",173,0)
 S H=$E(DATE,9,10)
"RTN","C0IUTIL",174,0)
 I $L(H)=1 S H="0"_H
"RTN","C0IUTIL",175,0)
 S MM=$E(DATE,11,12)
"RTN","C0IUTIL",176,0)
 I $L(MM)=1 S MM="0"_MM
"RTN","C0IUTIL",177,0)
 S S=$E(DATE,13,14)
"RTN","C0IUTIL",178,0)
 I $L(S)=1 S S="0"_S
"RTN","C0IUTIL",179,0)
 S OFF=$$TZ^XLFDT ; See Kernel Manual for documentation.
"RTN","C0IUTIL",180,0)
 S OFFS=$E(OFF,1,1)
"RTN","C0IUTIL",181,0)
 S OFF0=$TR(OFF,"+-")
"RTN","C0IUTIL",182,0)
 S OFF1=$E(OFF0+10000,2,3)
"RTN","C0IUTIL",183,0)
 S OFF2=$E(OFF0+10000,4,5)
"RTN","C0IUTIL",184,0)
 S OFF=OFFS_OFF1_":"_OFF2
"RTN","C0IUTIL",185,0)
 ;S OFF2=$E(OFF,1,2) ;
"RTN","C0IUTIL",186,0)
 ;S OFF2=$E(100+OFF2,2,3) ; GPL 11/08 CHANGED TO -05:00 FORMAT
"RTN","C0IUTIL",187,0)
 ;S OFF3=$E(OFF,3,4) ;MINUTES
"RTN","C0IUTIL",188,0)
 ;S OFF=$S(OFF2="":"00",0:"00",1:OFF2)_"."_$S(OFF3="":"00",1:OFF3)
"RTN","C0IUTIL",189,0)
 ; If H, MM and S are empty, it means that the FM date didn't supply the time.
"RTN","C0IUTIL",190,0)
 ; In this case, set H, MM and S to "00"
"RTN","C0IUTIL",191,0)
 ; S:('$L(H)&'$L(MM)&'$L(S)) (H,MM,S)="00" ; IF ONLY SOME ARE MISSING?
"RTN","C0IUTIL",192,0)
 S:'$L(H) H="00"
"RTN","C0IUTIL",193,0)
 S:'$L(MM) MM="00"
"RTN","C0IUTIL",194,0)
 S:'$L(S) S="00"
"RTN","C0IUTIL",195,0)
 S UTC=Y_"-"_M_"-"_D_"T"_H_":"_MM_$S(S="":":00",1:":"_S)_OFF ; Skip's code to fix hanging colon if no seconds
"RTN","C0IUTIL",196,0)
 I $L($G(FORMAT)),FORMAT="DT" Q UTC ; Date with time.
"RTN","C0IUTIL",197,0)
 E  Q $P(UTC,"T")
"RTN","C0IUTIL",198,0)
 ;
"RTN","C0IUTIL",199,0)
HTMLDT2(FMDT) ; extrinsic which produces mm/dd/yyyy no time from fileman date
"RTN","C0IUTIL",200,0)
 N TMP,TMP2
"RTN","C0IUTIL",201,0)
 S TMP=$$FMDTOCDA(FMDT)
"RTN","C0IUTIL",202,0)
 N M,D,Y
"RTN","C0IUTIL",203,0)
 S M=$E(TMP,5,6)
"RTN","C0IUTIL",204,0)
 S D=$E(TMP,7,8)
"RTN","C0IUTIL",205,0)
 S Y=$E(TMP,1,4)
"RTN","C0IUTIL",206,0)
 I +M=0 Q Y
"RTN","C0IUTIL",207,0)
 I +D=0 Q M_"/"_Y
"RTN","C0IUTIL",208,0)
 Q M_"/"_D_"/"_Y
"RTN","C0IUTIL",209,0)
 ;
"RTN","C0IUTIL",210,0)
HTMLDT(FMDT) ; extrinsic returns date format MM/DD/YYYY for display in html
"RTN","C0IUTIL",211,0)
 ;
"RTN","C0IUTIL",212,0)
 N TMP,TMP2
"RTN","C0IUTIL",213,0)
 S TMP=$$FMDTOUTC(FMDT)
"RTN","C0IUTIL",214,0)
 S TMP2=$E(TMP,5,6)_"/"_$E(TMP,7,8)_"/"_$E(TMP,1,4)
"RTN","C0IUTIL",215,0)
 I $E(TMP,9,14)'="000000" D  ;
"RTN","C0IUTIL",216,0)
 . I $L(TMP)=8 Q  ; no time
"RTN","C0IUTIL",217,0)
 . S TMP2=TMP2_" "_$E(TMP,9,10)_":"
"RTN","C0IUTIL",218,0)
 . S TMP2=TMP2_$E(TMP,11,12)_":"
"RTN","C0IUTIL",219,0)
 . S TMP2=TMP2_$E(TMP,13,19)
"RTN","C0IUTIL",220,0)
 Q TMP2
"RTN","C0IUTIL",221,0)
 ;
"RTN","C0IUTIL",222,0)
TESTDATE ; test the above transform
"RTN","C0IUTIL",223,0)
 N GT
"RTN","C0IUTIL",224,0)
 S GT=$$FMDTOUTC($$NOW^XLFDT,"DT")
"RTN","C0IUTIL",225,0)
 W !,GT
"RTN","C0IUTIL",226,0)
 Q
"RTN","C0IUTIL",227,0)
 ; 
"RTN","C0IUTIL",228,0)
GENHTML(HOUT,HARY) ; generate an HTML table from array HARY
"RTN","C0IUTIL",229,0)
 ; HOUT AND HARY are passed by name
"RTN","C0IUTIL",230,0)
 ;
"RTN","C0IUTIL",231,0)
 ; format of the table:
"RTN","C0IUTIL",232,0)
 ;  HARY("TITLE")="Problem List"
"RTN","C0IUTIL",233,0)
 ;  HARY("HEADER",1)="column 1 header"
"RTN","C0IUTIL",234,0)
 ;  HARY("HEADER",2)="col 2 header"
"RTN","C0IUTIL",235,0)
 ;  HARY(1,1)="row 1 col1 value"
"RTN","C0IUTIL",236,0)
 ;  HARY(1,2)="row 1 col2 value"
"RTN","C0IUTIL",237,0)
 ;  HARY(1,2,"ID")="the ID of the element" 
"RTN","C0IUTIL",238,0)
 ;  etc...
"RTN","C0IUTIL",239,0)
 ;
"RTN","C0IUTIL",240,0)
 N C0I,C0J
"RTN","C0IUTIL",241,0)
 D ADDTO(HOUT,"<div align=""center"">")
"RTN","C0IUTIL",242,0)
 ;I $D(@HARY@("TITLE")) D  ;
"RTN","C0IUTIL",243,0)
 ;. N X
"RTN","C0IUTIL",244,0)
 ;. S X="<title>"_@HARY@("TITLE")_"</title>"
"RTN","C0IUTIL",245,0)
 ;. D ADDTO(HOUT,X)
"RTN","C0IUTIL",246,0)
 D ADDTO(HOUT,"<text>")
"RTN","C0IUTIL",247,0)
 D ADDTO(HOUT,"<table border=""1"" style=""width:80%"">")
"RTN","C0IUTIL",248,0)
 I $D(@HARY@("TITLE")) D  ;
"RTN","C0IUTIL",249,0)
 . N X
"RTN","C0IUTIL",250,0)
 . S X="<caption><b>"_@HARY@("TITLE")_"</b></caption>"
"RTN","C0IUTIL",251,0)
 . D ADDTO(HOUT,X)
"RTN","C0IUTIL",252,0)
 I $D(@HARY@("HEADER")) D  ;
"RTN","C0IUTIL",253,0)
 . D ADDTO(HOUT,"<thead>")
"RTN","C0IUTIL",254,0)
 . D ADDTO(HOUT,"<tr>")
"RTN","C0IUTIL",255,0)
 . S C0I=0
"RTN","C0IUTIL",256,0)
 . F  S C0I=$O(@HARY@("HEADER",C0I)) Q:+C0I=0  D  ;
"RTN","C0IUTIL",257,0)
 . . D ADDTO(HOUT,"<th>"_@HARY@("HEADER",C0I)_"</th>")
"RTN","C0IUTIL",258,0)
 . D ADDTO(HOUT,"</tr>")
"RTN","C0IUTIL",259,0)
 . D ADDTO(HOUT,"</thead>")
"RTN","C0IUTIL",260,0)
 D ADDTO(HOUT,"<tbody>")
"RTN","C0IUTIL",261,0)
 I $D(@HARY@(1)) D  ;
"RTN","C0IUTIL",262,0)
 . S C0I=0 S C0J=0
"RTN","C0IUTIL",263,0)
 . F  S C0I=$O(@HARY@(C0I)) Q:+C0I=0  D  ;
"RTN","C0IUTIL",264,0)
 . . D ADDTO(HOUT,"<tr>")
"RTN","C0IUTIL",265,0)
 . . F  S C0J=$O(@HARY@(C0I,C0J)) Q:+C0J=0  D  ;
"RTN","C0IUTIL",266,0)
 . . . N UID S UID=$G(@HARY@(C0I,C0J,"ID"))
"RTN","C0IUTIL",267,0)
 . . . I UID'="" D ADDTO(HOUT,"<td style=""padding:5px;"" ID="""_UID_""">"_@HARY@(C0I,C0J)_"</td>")
"RTN","C0IUTIL",268,0)
 . . . E  D ADDTO(HOUT,"<td style=""padding:5px;"">"_@HARY@(C0I,C0J)_"</td>")
"RTN","C0IUTIL",269,0)
 . . D ADDTO(HOUT,"</tr>")
"RTN","C0IUTIL",270,0)
 D ADDTO(HOUT,"</tbody>")
"RTN","C0IUTIL",271,0)
 D ADDTO(HOUT,"</table>")
"RTN","C0IUTIL",272,0)
 D ADDTO(HOUT,"</text>")
"RTN","C0IUTIL",273,0)
 D ADDTO(HOUT,"</div>")
"RTN","C0IUTIL",274,0)
 Q
"RTN","C0IUTIL",275,0)
 ;
"RTN","C0IUTIL",276,0)
GENVHTML(HOUT,HARY) ; generate a vertical HTML table from array HARY
"RTN","C0IUTIL",277,0)
 ; headers are in the first row
"RTN","C0IUTIL",278,0)
 ; HOUT AND HARY are passed by name
"RTN","C0IUTIL",279,0)
 ;
"RTN","C0IUTIL",280,0)
 ; format of the table:
"RTN","C0IUTIL",281,0)
 ;  HARY("TITLE")="Problem List"
"RTN","C0IUTIL",282,0)
 ;  HARY("HEADER",1)="row 1 column 1 header"
"RTN","C0IUTIL",283,0)
 ;  HARY("HEADER",2)="row 2 col 2 header"
"RTN","C0IUTIL",284,0)
 ;  HARY(1,1)="row 1 col2 value"
"RTN","C0IUTIL",285,0)
 ;  HARY(2,1)="row 2 col2 value"
"RTN","C0IUTIL",286,0)
 ;  etc...
"RTN","C0IUTIL",287,0)
 ;
"RTN","C0IUTIL",288,0)
 N C0I,C0J
"RTN","C0IUTIL",289,0)
 D ADDTO(HOUT,"<div align=""center"">")
"RTN","C0IUTIL",290,0)
 D ADDTO(HOUT,"<text>")
"RTN","C0IUTIL",291,0)
 D ADDTO(HOUT,"<table border=""1"" style=""width:40%"">")
"RTN","C0IUTIL",292,0)
 I $D(@HARY@("TITLE")) D  ;
"RTN","C0IUTIL",293,0)
 . N X
"RTN","C0IUTIL",294,0)
 . S X="<caption><b>"_@HARY@("TITLE")_"</b></caption>"
"RTN","C0IUTIL",295,0)
 . D ADDTO(HOUT,X)
"RTN","C0IUTIL",296,0)
 I $D(@HARY@("HEADER")) D  ;
"RTN","C0IUTIL",297,0)
 . D ADDTO(HOUT,"<tr>")
"RTN","C0IUTIL",298,0)
 . S C0I=0
"RTN","C0IUTIL",299,0)
 . F  S C0I=$O(@HARY@("HEADER",C0I)) Q:+C0I=0  D  ;
"RTN","C0IUTIL",300,0)
 . . D ADDTO(HOUT,"<th style=""padding:5px;"">"_@HARY@("HEADER",C0I)_"</th>")
"RTN","C0IUTIL",301,0)
 . . D ADDTO(HOUT,"<td style=""padding:5px;"">"_@HARY@(C0I,1)_"</td>")
"RTN","C0IUTIL",302,0)
 . D ADDTO(HOUT,"</tr>")
"RTN","C0IUTIL",303,0)
 D ADDTO(HOUT,"</table>")
"RTN","C0IUTIL",304,0)
 D ADDTO(HOUT,"</text>")
"RTN","C0IUTIL",305,0)
 D ADDTO(HOUT,"</div>")
"RTN","C0IUTIL",306,0)
 Q
"RTN","C0IUTIL",307,0)
 ;
"RTN","C0IUTIL",308,0)
TSTYLE1 ; table style template
"RTN","C0IUTIL",309,0)
 ;;<style>
"RTN","C0IUTIL",310,0)
 ;;table, th, td
"RTN","C0IUTIL",311,0)
 ;;{
"RTN","C0IUTIL",312,0)
 ;;border-collapse:collapse;
"RTN","C0IUTIL",313,0)
 ;;border:1px solid black;
"RTN","C0IUTIL",314,0)
 ;;}
"RTN","C0IUTIL",315,0)
 ;;th, td
"RTN","C0IUTIL",316,0)
 ;;{
"RTN","C0IUTIL",317,0)
 ;;padding:5px;
"RTN","C0IUTIL",318,0)
 ;;}
"RTN","C0IUTIL",319,0)
 ;;</style>
"RTN","C0IUTIL",320,0)
 Q
"RTN","C0IUTIL",321,0)
 ;
"RTN","C0IUTIL",322,0)
TESTHTML ;
"RTN","C0IUTIL",323,0)
 N HTML
"RTN","C0IUTIL",324,0)
 S HTML("TITLE")="Problem List"
"RTN","C0IUTIL",325,0)
 S HTML("HEADER",1)="column 1 header"
"RTN","C0IUTIL",326,0)
 S HTML("HEADER",2)="col 2 header"
"RTN","C0IUTIL",327,0)
 S HTML(1,1)="row 1 col1 value"
"RTN","C0IUTIL",328,0)
 S HTML(1,2)="row 1 col2 value"
"RTN","C0IUTIL",329,0)
 N GHTML
"RTN","C0IUTIL",330,0)
 D GENHTML("GHTML","HTML")
"RTN","C0IUTIL",331,0)
 ZWR GHTML
"RTN","C0IUTIL",332,0)
 Q
"RTN","C0IUTIL",333,0)
 ;
"RTN","C0IUTIL",334,0)
ADDTO(DEST,WHAT) ; adds string WHAT to list DEST 
"RTN","C0IUTIL",335,0)
 ; DEST is passed by name
"RTN","C0IUTIL",336,0)
 N GN
"RTN","C0IUTIL",337,0)
 S GN=$O(@DEST@("AAAAAA"),-1)+1
"RTN","C0IUTIL",338,0)
 S @DEST@(GN)=WHAT
"RTN","C0IUTIL",339,0)
 S @DEST@(0)=GN ; count
"RTN","C0IUTIL",340,0)
 Q
"RTN","C0IUTIL",341,0)
 ;
"RTN","C0IUTIL",342,0)
ORGOID() ; extrinsic which returns the Organization OID
"RTN","C0IUTIL",343,0)
 Q "2.16.840.1.113883.5.83" ; WORLDVISTA HL7 OID - 
"RTN","C0IUTIL",344,0)
 ; REPLACE WITH OID LOOKUP FROM INSTITUTION FILE
"RTN","C0IUTIL",345,0)
 ;
"RTN","C0IUTIL",346,0)
tree(where,prefix,docid,zout) ; show a tree starting at a node in MXML. 
"RTN","C0IUTIL",347,0)
 ; node is passed by name
"RTN","C0IUTIL",348,0)
 ; 
"RTN","C0IUTIL",349,0)
 i $g(prefix)="" s prefix="|--" ; starting prefix
"RTN","C0IUTIL",350,0)
 i '$d(KBAIJOB) s KBAIJOB=$J
"RTN","C0IUTIL",351,0)
 n node s node=$na(^TMP("MXMLDOM",KBAIJOB,docid,where))
"RTN","C0IUTIL",352,0)
 n txt s txt=$$CLEAN($$ALLTXT(node))
"RTN","C0IUTIL",353,0)
 w:'$G(DIQUIET) !,prefix_@node_" "_txt
"RTN","C0IUTIL",354,0)
 d oneout(zout,prefix_@node_" "_txt)
"RTN","C0IUTIL",355,0)
 n zi s zi=""
"RTN","C0IUTIL",356,0)
 f  s zi=$o(@node@("A",zi)) q:zi=""  d  ;
"RTN","C0IUTIL",357,0)
 . w:'$G(DIQUIET) !,prefix_"  : "_zi_"^"_$g(@node@("A",zi))
"RTN","C0IUTIL",358,0)
 . d oneout(zout,prefix_"  : "_zi_"^"_$g(@node@("A",zi)))
"RTN","C0IUTIL",359,0)
 f  s zi=$o(@node@("C",zi)) q:zi=""  d  ;
"RTN","C0IUTIL",360,0)
 . d tree(zi,"|  "_prefix,docid,zout)
"RTN","C0IUTIL",361,0)
 q
"RTN","C0IUTIL",362,0)
 ;
"RTN","C0IUTIL",363,0)
oneout(zbuf,ztxt) ; adds a line to zbuf
"RTN","C0IUTIL",364,0)
 n zi s zi=$o(@zbuf@(""),-1)+1
"RTN","C0IUTIL",365,0)
 s @zbuf@(zi)=ztxt
"RTN","C0IUTIL",366,0)
 q
"RTN","C0IUTIL",367,0)
 ;
"RTN","C0IUTIL",368,0)
ALLTXT(where) ; extrinsic which returns all text lines from the node .. concatinated 
"RTN","C0IUTIL",369,0)
 ; together
"RTN","C0IUTIL",370,0)
 n zti s zti=""
"RTN","C0IUTIL",371,0)
 n ztr s ztr=""
"RTN","C0IUTIL",372,0)
 f  s zti=$o(@where@("T",zti)) q:zti=""  d  ;
"RTN","C0IUTIL",373,0)
 . s ztr=ztr_$g(@where@("T",zti))
"RTN","C0IUTIL",374,0)
 q ztr
"RTN","C0IUTIL",375,0)
 ;
"RTN","C0IUTIL",376,0)
CLEAN(STR) ; extrinsic function; returns string - gpl borrowed from the CCR package
"RTN","C0IUTIL",377,0)
 ;; Removes all non printable characters from a string.
"RTN","C0IUTIL",378,0)
 ;; STR by Value
"RTN","C0IUTIL",379,0)
 N TR,I
"RTN","C0IUTIL",380,0)
 F I=0:1:31 S TR=$G(TR)_$C(I)
"RTN","C0IUTIL",381,0)
 S TR=TR_$C(127)
"RTN","C0IUTIL",382,0)
 N ZR S ZR=$TR(STR,TR)
"RTN","C0IUTIL",383,0)
 S ZR=$$LDBLNKS(ZR) ; get rid of leading blanks
"RTN","C0IUTIL",384,0)
 QUIT ZR
"RTN","C0IUTIL",385,0)
 ;
"RTN","C0IUTIL",386,0)
LDBLNKS(st) ; extrinsic which removes leading blanks from a string
"RTN","C0IUTIL",387,0)
 n pos f pos=1:1:$l(st)  q:$e(st,pos)'=" "
"RTN","C0IUTIL",388,0)
 q $e(st,pos,$l(st))
"RTN","C0IUTIL",389,0)
 ;
"RTN","C0IUTIL",390,0)
show(what,docid,zout) ;
"RTN","C0IUTIL",391,0)
 I '$D(C0XJOB) S C0XJOB=$J
"RTN","C0IUTIL",392,0)
 d tree(what,,docid,zout)
"RTN","C0IUTIL",393,0)
 q
"RTN","C0IUTIL",394,0)
 ; 
"RTN","C0IUTIL",395,0)
listm(out,in) ; out is passed by name in is passed by reference
"RTN","C0IUTIL",396,0)
 n i s i=$q(@in@(""))
"RTN","C0IUTIL",397,0)
 f  s i=$q(@i) q:i=""  d oneout(out,i_"="_@i)
"RTN","C0IUTIL",398,0)
 q
"RTN","C0IUTIL",399,0)
 ;
"RTN","C0IUTIL",400,0)
peel(out,in) ; compress a complex global into something simpler
"RTN","C0IUTIL",401,0)
 n i s i=$q(@in@(""))
"RTN","C0IUTIL",402,0)
 f  s i=$q(@i) q:i=""  d  ;
"RTN","C0IUTIL",403,0)
 . n j,k,l,m,n,m1
"RTN","C0IUTIL",404,0)
 . s (l,m)=""
"RTN","C0IUTIL",405,0)
 . s n=$$shrink($qs(i,$ql(i)))
"RTN","C0IUTIL",406,0)
 . s k=$qs(i,0)_"("""
"RTN","C0IUTIL",407,0)
 . f j=1:1:$ql(i)-1  d  ;
"RTN","C0IUTIL",408,0)
 . . i +$qs(i,j)>0 d  ;
"RTN","C0IUTIL",409,0)
 . . . i m'="" q
"RTN","C0IUTIL",410,0)
 . . . s m=$qs(i,j)
"RTN","C0IUTIL",411,0)
 . . . s m1=j
"RTN","C0IUTIL",412,0)
 . . . i j>1 s l=$qs(i,j-1)
"RTN","C0IUTIL",413,0)
 . . . e  s l=$qs(i,j)
"RTN","C0IUTIL",414,0)
 . . . i l["substanceAdministration" s l=$p(l,"substanceAdministration",2)
"RTN","C0IUTIL",415,0)
 . . s k=k_$qs(i,j)_""","""
"RTN","C0IUTIL",416,0)
 . . w:$g(DEBUG) !,j," ",k
"RTN","C0IUTIL",417,0)
 . s k=k_$qs(i,$ql(i))_""")"
"RTN","C0IUTIL",418,0)
 . w:$g(DEBUG) !,k,"=",@k
"RTN","C0IUTIL",419,0)
 . i l'="" d  q  ;
"RTN","C0IUTIL",420,0)
 . . d:$g(@out@(l,m,n))'=""
"RTN","C0IUTIL",421,0)
 . . . ;n jj,n2
"RTN","C0IUTIL",422,0)
 . . . ;f jj=2:1  w !,jj s n2=$qs(i,$ql(i)-1)_"["_jj_"]"_n q:$g(@out@(l,m,n2))=""  w !,n2
"RTN","C0IUTIL",423,0)
 . . . ;s n=n2
"RTN","C0IUTIL",424,0)
 . . . ;s n=$$shrink($qs(i,$ql(i)-1))_"_"_n
"RTN","C0IUTIL",425,0)
 . . . s n=$$mkxpath(i,m1)
"RTN","C0IUTIL",426,0)
 . . . b:$g(@out@(l,m,n))'=""
"RTN","C0IUTIL",427,0)
 . . s @out@(l,m,n)=@k
"RTN","C0IUTIL",428,0)
 . i @k'="" d  ;
"RTN","C0IUTIL",429,0)
 . . i $ql(i)>1 d  q  ;
"RTN","C0IUTIL",430,0)
 . . . s l=$$shrink($qs(i,$ql(i)-1))
"RTN","C0IUTIL",431,0)
 . . . d:$g(@out@(l,n))'=""
"RTN","C0IUTIL",432,0)
 . . . . ;n jj,n2
"RTN","C0IUTIL",433,0)
 . . . . ;f jj=2:1  s n2=$qs(i,$ql(i)-1)_"["_jj_"]"_"_"_n q:$g(@out@(l,n2))=""
"RTN","C0IUTIL",434,0)
 . . . . ;s n=n2
"RTN","C0IUTIL",435,0)
 . . . . ;b:$g(@out@(l,n))'=""
"RTN","C0IUTIL",436,0)
 . . . . s n=$$shrink($qs(i,$ql(i)-1))_"_"_n
"RTN","C0IUTIL",437,0)
 . . . s @out@(l,n)=@k
"RTN","C0IUTIL",438,0)
 . . s @out@(n)=@k
"RTN","C0IUTIL",439,0)
 q
"RTN","C0IUTIL",440,0)
 ;
"RTN","C0IUTIL",441,0)
shrink(x) ; reduce strings 
"RTN","C0IUTIL",442,0)
 n y,z
"RTN","C0IUTIL",443,0)
 s y=x
"RTN","C0IUTIL",444,0)
 s z="substanceAdministration"
"RTN","C0IUTIL",445,0)
 i x[z s y=$p(x,z,2)
"RTN","C0IUTIL",446,0)
 q y
"RTN","C0IUTIL",447,0)
 ;
"RTN","C0IUTIL",448,0)
mkxpath(zq,zm) ; extrinsic which returns the xpath derived from the $query value 
"RTN","C0IUTIL",449,0)
 ;passed by value. zm is the index to begin with
"RTN","C0IUTIL",450,0)
 ;
"RTN","C0IUTIL",451,0)
 n zr s zr=""
"RTN","C0IUTIL",452,0)
 n zi s zi=""
"RTN","C0IUTIL",453,0)
 f zi=1:1:$ql(zq) s zr=zr_"/"_$qs(zq,zi)
"RTN","C0IUTIL",454,0)
 q zr
"RTN","C0IUTIL",455,0)
 ;
"RTN","C0IVMR")
0^8^B266088944
"RTN","C0IVMR",1,0)
C0IVMR ; GPL&NEA - Immunizations Forecasting Routine ;05/03/14  17:05
"RTN","C0IVMR",2,0)
 ;;0.1;Immunizations Forecasting;nopatch;noreleasedate;Build 1
"RTN","C0IVMR",3,0)
 ;
"RTN","C0IVMR",4,0)
 ; License Apache 2
"RTN","C0IVMR",5,0)
 ; 
"RTN","C0IVMR",6,0)
 Q
"RTN","C0IVMR",7,0)
 ;
"RTN","C0IVMR",8,0)
EN(WRK,DFN,PARMS,RETURN) ;
"RTN","C0IVMR",9,0)
 K WRK
"RTN","C0IVMR",10,0)
 N C0ARY,G,C0IPOA,CPTMAP,CVXMAP,CPTIMAP,CVXIMAP
"RTN","C0IVMR",11,0)
 D CPTMAP^C0IVMR
"RTN","C0IVMR",12,0)
 D CVXMAP^C0IVMR
"RTN","C0IVMR",13,0)
 D CPTIMAP^C0IVMR
"RTN","C0IVMR",14,0)
 D CVXIMAP^C0IVMR
"RTN","C0IVMR",15,0)
 D PAYOUTAV^C0IVMR
"RTN","C0IVMR",16,0)
 D PAYOUTBV^C0IVMR(.RETURN)
"RTN","C0IVMR",17,0)
 D GET^C0IUTIL("WRK","TPAYOUTC^C0IVMR")
"RTN","C0IVMR",18,0)
 D PAYOUTDV^C0IVMR
"RTN","C0IVMR",19,0)
 D GET^C0IUTIL("WRK","TPAYOUTE^C0IVMR")
"RTN","C0IVMR",20,0)
 M ^TMP("C0IWRK",$J)=WRK
"RTN","C0IVMR",21,0)
 S OK=$$GTF^%ZISH($NA(^TMP("C0IWRK",$J,1)),3,"/home/vista/","ice-test.xml")
"RTN","C0IVMR",22,0)
 K WRK(0)
"RTN","C0IVMR",23,0)
 Q
"RTN","C0IVMR",24,0)
 ;
"RTN","C0IVMR",25,0)
TEST1 ;
"RTN","C0IVMR",26,0)
 S DFN=$$PAT^C0IICE()
"RTN","C0IVMR",27,0)
 K WRK
"RTN","C0IVMR",28,0)
 D CPTMAP
"RTN","C0IVMR",29,0)
 D CVXMAP
"RTN","C0IVMR",30,0)
 D CPTIMAP
"RTN","C0IVMR",31,0)
 D CVXIMAP
"RTN","C0IVMR",32,0)
 D PAYOUTAV
"RTN","C0IVMR",33,0)
 D PAYOUTBV(.RETURN)
"RTN","C0IVMR",34,0)
 D GET^C0IUTIL("WRK","TPAYOUTC^C0IVMR")
"RTN","C0IVMR",35,0)
 D PAYOUTDV
"RTN","C0IVMR",36,0)
 D GET^C0IUTIL("WRK","TPAYOUTE^C0IVMR")
"RTN","C0IVMR",37,0)
 M ^TMP("C0IWRK",$J)=WRK
"RTN","C0IVMR",38,0)
 W $$GTF^%ZISH($NA(^TMP("C0IWRK",$J,1)),3,"/home/vista/","ice-test.xml")
"RTN","C0IVMR",39,0)
 Q
"RTN","C0IVMR",40,0)
 ; get patient DFN
"RTN","C0IVMR",41,0)
 ; get patient VPR demographics for sex and DOB
"RTN","C0IVMR",42,0)
 ; call VPR to get patient Immunizaitons
"RTN","C0IVMR",43,0)
 ; 
"RTN","C0IVMR",44,0)
 ; begin building SOAP request XML
"RTN","C0IVMR",45,0)
 ; loop through immunizations array and generate XML pieces
"RTN","C0IVMR",46,0)
 ; call build to put all the pieces together into one XML array
"RTN","C0IVMR",47,0)
 ; base64 encode the XML array
"RTN","C0IVMR",48,0)
 ;
"RTN","C0IVMR",49,0)
TENVOUT ; build SOAP envelope
"RTN","C0IVMR",50,0)
 ;;<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope"> 
"RTN","C0IVMR",51,0)
 ;;<S:Body>
"RTN","C0IVMR",52,0)
 ;;<ns2:evaluateAtSpecifiedTime xmlns:ns2="http://www.omg.org/spec/CDSS/201105/dss">
"RTN","C0IVMR",53,0)
 ;;<interactionId scopingEntityId="gov.nyc.health" interactionId="123456"/>
"RTN","C0IVMR",54,0)
 ;;<specifiedTime>@@hl7OutTime@@</specifiedTime>
"RTN","C0IVMR",55,0)
 ;;<evaluationRequest clientLanguage="" clientTimeZoneOffset="">
"RTN","C0IVMR",56,0)
 ;;<kmEvaluationRequest>
"RTN","C0IVMR",57,0)
 ;;<kmId scopingEntityId="org.nyc.cir" businessId="ICE" version="1.0.0"/>
"RTN","C0IVMR",58,0)
 ;;</kmEvaluationRequest>
"RTN","C0IVMR",59,0)
 ;;<dataRequirementItemData>
"RTN","C0IVMR",60,0)
 ;;<driId itemId="cdsPayload">
"RTN","C0IVMR",61,0)
 ;;<containingEntityId scopingEntityId="gov.nyc.health" businessId="ICEData" version="1.0.0.0"/>
"RTN","C0IVMR",62,0)
 ;;</driId>
"RTN","C0IVMR",63,0)
 ;;<data>
"RTN","C0IVMR",64,0)
 ;;<informationModelSSId scopingEntityId="org.opencds.vmr" businessId="VMR" version="1.0"/>
"RTN","C0IVMR",65,0)
 ;;<base64EncodedPayload>@@outPayload@@</base64EncodedPayload>
"RTN","C0IVMR",66,0)
 ;;</data>
"RTN","C0IVMR",67,0)
 ;;</dataRequirementItemData>
"RTN","C0IVMR",68,0)
 ;;</evaluationRequest>
"RTN","C0IVMR",69,0)
 ;;</ns2:evaluateAtSpecifiedTime>
"RTN","C0IVMR",70,0)
 ;; </S:Body>
"RTN","C0IVMR",71,0)
 ;; </S:Envelope>
"RTN","C0IVMR",72,0)
 Q
"RTN","C0IVMR",73,0)
ENVOUTV ; create beginning of envelop
"RTN","C0IVMR",74,0)
 K C0IARY
"RTN","C0IVMR",75,0)
 S C0IARY("hl7OutTime")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0IVMR",76,0)
 D GETNMAP^C0IUTIL("WRK","TENVOUT^C0IVMR","C0IARY")
"RTN","C0IVMR",77,0)
 Q
"RTN","C0IVMR",78,0)
TPAYOUTA ; First part of payload message with Sex and DOB and a UUID variables
"RTN","C0IVMR",79,0)
 ;;<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
"RTN","C0IVMR",80,0)
 ;;<ns4:cdsInput xmlns:ns2="org.opencds" xmlns:ns3="org.opencds.vmr.v1_0.schema.vmr" xmlns:ns4="org.opencds.vmr.v1_0.schema.cdsinput" xmlns:ns5="org.opencds.vmr.v1_0.schema.cdsoutput">
"RTN","C0IVMR",81,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.1.1"/>
"RTN","C0IVMR",82,0)
 ;;<cdsContext>
"RTN","C0IVMR",83,0)
 ;;<cdsSystemUserPreferredLanguage code="en" codeSystem="2.16.840.1.113883.6.99" displayName="English"/>
"RTN","C0IVMR",84,0)
 ;;</cdsContext>
"RTN","C0IVMR",85,0)
 ;;<vmrInput>
"RTN","C0IVMR",86,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.1.1"/>
"RTN","C0IVMR",87,0)
 ;;<patient>
"RTN","C0IVMR",88,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.2.1.1"/>
"RTN","C0IVMR",89,0)
 ;;<id root="@@UUID0@@"/>
"RTN","C0IVMR",90,0)
 ;;<demographics>
"RTN","C0IVMR",91,0)
 ;;<birthTime value="@@DOB@@"/>
"RTN","C0IVMR",92,0)
 ;;<gender code="@@genderCode@@" codeSystem="2.16.840.1.113883.5.1" displayName="@@genderName@@" originalText="@@genderCode@@"/>
"RTN","C0IVMR",93,0)
 ;;</demographics>
"RTN","C0IVMR",94,0)
 ;;<clinicalStatements>
"RTN","C0IVMR",95,0)
 Q
"RTN","C0IVMR",96,0)
 ;
"RTN","C0IVMR",97,0)
PAYOUTAV ; setting payload variables sex, DOB and UUID for the first section (PAYOUTA)
"RTN","C0IVMR",98,0)
 K C0IPOA
"RTN","C0IVMR",99,0)
 S X=$$GET1^DIQ(2,DFN,"DOB","I")
"RTN","C0IVMR",100,0)
 S C0IPOA("UUID0")=$$UUID^C0IUTIL
"RTN","C0IVMR",101,0)
 S C0IPOA("DOB")=$$FMDTOCDA^C0IUTIL(X)
"RTN","C0IVMR",102,0)
 S C0IPOA("genderCode")=$$GET1^DIQ(2,DFN,"SEX","I")
"RTN","C0IVMR",103,0)
 I C0IPOA("genderCode")="M" S C0IPOA("genderName")="Male"
"RTN","C0IVMR",104,0)
 I C0IPOA("genderCode")="F" S C0IPOA("genderName")="Female"
"RTN","C0IVMR",105,0)
 I C0IPOA("genderCode")="UN" S C0IPOA("genderName")="Undifferentiated" ; ICE term, not VISTA  VistA allow M F only.P
"RTN","C0IVMR",106,0)
 D GETNMAP^C0IUTIL("WRK","TPAYOUTA^C0IVMR","C0IPOA") 
"RTN","C0IVMR",107,0)
 Q
"RTN","C0IVMR",108,0)
 ;
"RTN","C0IVMR",109,0)
PAYOUTB ;
"RTN","C0IVMR",110,0)
 ;;;Disease an immunity section which is optional. the DISEASE_DOCUMENTED and IS_IMMUNE
"RTN","C0IVMR",111,0)
 ;;;Cycle through 6 diseases using reminders to check for prior diagnosis
"RTN","C0IVMR",112,0)
 ;;;Hep A: 070.1
"RTN","C0IVMR",113,0)
 ;;;Hep B: 070.3
"RTN","C0IVMR",114,0)
 ;;;Measles: 055.9
"RTN","C0IVMR",115,0)
 ;;;Mumps: 072.9
"RTN","C0IVMR",116,0)
 ;;;Rubella: 056.9
"RTN","C0IVMR",117,0)
 ;;;Varicella: 052.9
"RTN","C0IVMR",118,0)
 ;;;First Tag for this section if any prior diagnoses are available
"RTN","C0IVMR",119,0)
 ;;<observationResults>
"RTN","C0IVMR",120,0)
 Q
"RTN","C0IVMR",121,0)
 ;
"RTN","C0IVMR",122,0)
PAYOUTM ;
"RTN","C0IVMR",123,0)
 ;;;Populate this section for each disease found leading to immunity
"RTN","C0IVMR",124,0)
 ;;<observationResult>
"RTN","C0IVMR",125,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.6.3.1"/>
"RTN","C0IVMR",126,0)
 ;;<id root="@@UUIDA@@"/>
"RTN","C0IVMR",127,0)
 ;;<observationFocus code="@@codeICD9@@" codeSystem="2.16.840.1.113883.6.103" displayName="@@codeName@@" originalText="@@codeICD9@@"/>
"RTN","C0IVMR",128,0)
 ;;<observationEventTime low="@@timeProblem@@" high="@@timeProblem@@"/>
"RTN","C0IVMR",129,0)
 ;;<observationValue>
"RTN","C0IVMR",130,0)
 ;;<concept code="DISEASE_DOCUMENTED" codeSystem="2.16.840.1.113883.3.795.12.100.8" displayName="Disease Documented" originalText="DISEASE_DOCUMENTED"/>
"RTN","C0IVMR",131,0)
 ;;</observationValue>
"RTN","C0IVMR",132,0)
 ;;<interpretation code="IS_IMMUNE" codeSystem="2.16.840.1.113883.3.795.12.100.9" displayName="Is Immune" originalText="IS_IMMUNE"/>
"RTN","C0IVMR",133,0)
 ;;</observationResult>
"RTN","C0IVMR",134,0)
 Q
"RTN","C0IVMR",135,0)
 ;
"RTN","C0IVMR",136,0)
PAYOUTN ;
"RTN","C0IVMR",137,0)
 ;;;Finishes off the disease section if there is one
"RTN","C0IVMR",138,0)
 ;;</observationResults>
"RTN","C0IVMR",139,0)
 Q
"RTN","C0IVMR",140,0)
PAYOUTBV(RETURN) ;
"RTN","C0IVMR",141,0)
 ; RETURN is passed by reference and is populated with the results of Reminders
"RTN","C0IVMR",142,0)
 ;  and rubrics to tie the ICE return results to the VistA Patient Record
"RTN","C0IVMR",143,0)
 ;
"RTN","C0IVMR",144,0)
 ;Placeholder for logic and variables for populating the DISEASE_DOCUMENTED and IS_IMMUNE
"RTN","C0IVMR",145,0)
 ;Diseases Hep A, Hep B, Measles, Mumps, Rubella, Varicella only as of 5/2014,
"RTN","C0IVMR",146,0)
 ;If N is 0 after using reminders to test for the diseases in the taxonomies, then skip this section
"RTN","C0IVMR",147,0)
 ;If more than one of these present, use the needed disease tags to write this part of the message
"RTN","C0IVMR",148,0)
 ;
"RTN","C0IVMR",149,0)
 N IENHEPA,IENHEPB,IENMEASL,IENVARIC,IENMUMPS,IENRUBEL 
"RTN","C0IVMR",150,0)
 N RCODE,RNAME ; rubric code and name
"RTN","C0IVMR",151,0)
 S (IENHEPA,IENHEPB,IENMEASL,IENVARIC,IENMUMPS,IENRUBEL)=""
"RTN","C0IVMR",152,0)
 N FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG
"RTN","C0IVMR",153,0)
 S FILE=811.9 
"RTN","C0IVMR",154,0)
 S IENS=""
"RTN","C0IVMR",155,0)
 S FLAGS="OQ"
"RTN","C0IVMR",156,0)
 S INDEX="B"
"RTN","C0IVMR",157,0)
 S SCREEN=""
"RTN","C0IVMR",158,0)
 S EMSG=""
"RTN","C0IVMR",159,0)
 N N,HEPA,HEPB,VARICEL,MUMPS,MEASLES,RUBELLA
"RTN","C0IVMR",160,0)
 S (N,HEPA,HEPB,VARICEL,MUMPS,MEASLES,RUBELLA)=0
"RTN","C0IVMR",161,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IVMR",162,0)
 N REMNAME S REMNAME="VIMM-HEPATITIS B DIAGNOSIS"
"RTN","C0IVMR",163,0)
 S IENHEPB=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IVMR",164,0)
 I IENHEPB="" Q  ; reminder not found, skip this part
"RTN","C0IVMR",165,0)
 K REMNAME
"RTN","C0IVMR",166,0)
 ;D MAIN^PXRM(DFN,IENHEPB,0)
"RTN","C0IVMR",167,0)
 S RCODE="070.30"
"RTN","C0IVMR",168,0)
 S RNAME="Hep B"
"RTN","C0IVMR",169,0)
 I $$EN^C0IPXRM(DFN,IENHEPB,.RETURN,"hadHepB",RCODE,RNAME) S N=N+1 S HEPB=1
"RTN","C0IVMR",170,0)
 ;I $G(^TMP("PXRHM",$J,IENHEPB,"VIMM-HEPATITIS B DIAGNOSIS"))["DUE NOW" S N=N+1 S HEPB=1
"RTN","C0IVMR",171,0)
 ;W "HEPB=",HEPB,!
"RTN","C0IVMR",172,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IVMR",173,0)
 N REMNAME S REMNAME="VIMM-HEPATITIS A DIAGNOSIS"
"RTN","C0IVMR",174,0)
 S IENHEPA=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG) 
"RTN","C0IVMR",175,0)
 K REMNAME
"RTN","C0IVMR",176,0)
 ;D MAIN^PXRM(DFN,IENHEPA,0)
"RTN","C0IVMR",177,0)
 S RCODE="070.1"
"RTN","C0IVMR",178,0)
 S RNAME="Hep A"
"RTN","C0IVMR",179,0)
 I $$EN^C0IPXRM(DFN,IENHEPA,.RETURN,"hadHepA",RCODE,RNAME) S N=N+1 S HEPA=1
"RTN","C0IVMR",180,0)
 ;I $G(^TMP("PXRHM",$J,IENHEPA,"VIMM-HEPATITIS A DIAGNOSIS"))["DUE NOW" S N=N+1 S HEPA=1
"RTN","C0IVMR",181,0)
 ;W "HEPA=",HEPA,!
"RTN","C0IVMR",182,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IVMR",183,0)
 N REMNAME S REMNAME="VIMM-VARICELLA DIAGNOSIS"
"RTN","C0IVMR",184,0)
 S IENVARIC=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IVMR",185,0)
 K REMNAME
"RTN","C0IVMR",186,0)
 ;D MAIN^PXRM(DFN,IENVARIC,0)
"RTN","C0IVMR",187,0)
 S RCODE="052.9"
"RTN","C0IVMR",188,0)
 S RNAME="Varicella"
"RTN","C0IVMR",189,0)
 I $$EN^C0IPXRM(DFN,IENVARIC,.RETURN,"hadVaricella",RCODE,RNAME) S N=N+1 S VARICEL=1
"RTN","C0IVMR",190,0)
 ;I $G(^TMP("PXRHM",$J,IENVARIC,"VIMM-VARICELLA DIAGNOSIS"))["DUE NOW" S N=N+1 S VARICEL=1
"RTN","C0IVMR",191,0)
 ;W "VARICEL=",VARICEL,!
"RTN","C0IVMR",192,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IVMR",193,0)
 N REMNAME S REMNAME="VIMM-MUMPS DIAGNOSIS" 
"RTN","C0IVMR",194,0)
 S IENMUMPS=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG) D MAIN^PXRM(DFN,267,0)
"RTN","C0IVMR",195,0)
 K REMNME
"RTN","C0IVMR",196,0)
 ;D MAIN^PXRM(DFN,IENMUMPS,0)
"RTN","C0IVMR",197,0)
 S RCODE="072.9"
"RTN","C0IVMR",198,0)
 S RNAME="Mumps"
"RTN","C0IVMR",199,0)
 I $$EN^C0IPXRM(DFN,IENMUMPS,.RETURN,"hadMumps",RCODE,RNAME) S N=N+1 S MUMPS=1
"RTN","C0IVMR",200,0)
 ;I $G(^TMP("PXRHM",$J,IENMUMPS,"VIMM-MUMPS DIAGNOSIS"))["DUE NOW" S N=N+1 S MUMPS=1
"RTN","C0IVMR",201,0)
 ;W "MUMPS=",MUMPS,!
"RTN","C0IVMR",202,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IVMR",203,0)
 N REMNAME S REMNAME="VIMM-MEASLES DIAGNOSIS"
"RTN","C0IVMR",204,0)
 S IENMEASL=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IVMR",205,0)
 K REMNAME
"RTN","C0IVMR",206,0)
 ;D MAIN^PXRM(DFN,IENMEASL,0)
"RTN","C0IVMR",207,0)
 S RCODE="055.9"
"RTN","C0IVMR",208,0)
 S RNAME="Measles"
"RTN","C0IVMR",209,0)
 I $$EN^C0IPXRM(DFN,IENMEASL,.RETURN,"hadMeasles",RCODE,RNAME) S N=N+1 S MEASLES=1
"RTN","C0IVMR",210,0)
 ;I $G(^TMP("PXRHM",$J,IENMEASL,"VIMM-MEASLES DIAGNOSIS"))["DUE NOW" S N=N+1 S MEASLES=1
"RTN","C0IVMR",211,0)
 ;W "MEASLES=",MEASLES,!
"RTN","C0IVMR",212,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IVMR",213,0)
 N REMNAME S REMNAME="VIMM-RUBELLA DIAGNOSIS"
"RTN","C0IVMR",214,0)
 S IENRUBEL=$$FIND1^DIC(FILE,IENS,FLAGS,REMNAME,INDEX,SCREEN,EMSG)
"RTN","C0IVMR",215,0)
 K REMNAME
"RTN","C0IVMR",216,0)
 ;D MAIN^PXRM(DFN,IENRUBEL,0)
"RTN","C0IVMR",217,0)
 S RCODE="056.9"
"RTN","C0IVMR",218,0)
 S RNAME="Rubella"
"RTN","C0IVMR",219,0)
 I $$EN^C0IPXRM(DFN,IENRUBEL,.RETURN,"hadRubella",RCODE,RNAME) S N=N+1 S RUBELLA=1
"RTN","C0IVMR",220,0)
 ;I $G(^TMP("PXRHM",$J,IENRUBEL,"VIMM-RUBELLA DIAGNOSIS"))["DUE NOW" S N=N+1 S RUBELLA=1
"RTN","C0IVMR",221,0)
 ;W "RUBELLA=",RUBELLA,!
"RTN","C0IVMR",222,0)
 K ^TMP("PXRHM",$J)
"RTN","C0IVMR",223,0)
 I N=0 Q
"RTN","C0IVMR",224,0)
 E  D
"RTN","C0IVMR",225,0)
 .D GETNMAP^C0IUTIL("WRK","PAYOUTB^C0IVMR","C0IPOA")
"RTN","C0IVMR",226,0)
 .I HEPB=1 D HEPB
"RTN","C0IVMR",227,0)
 .I HEPA=1 D HEPA
"RTN","C0IVMR",228,0)
 .I VARICEL=1 D VARICEL
"RTN","C0IVMR",229,0)
 .I MUMPS=1 D MUMPS
"RTN","C0IVMR",230,0)
 .I MEASLES=1 D MEASLES
"RTN","C0IVMR",231,0)
 .I RUBELLA=1 D RUBELLA
"RTN","C0IVMR",232,0)
 .D GETNMAP^C0IUTIL("WRK","PAYOUTN^C0IVMR","C0IPOA")
"RTN","C0IVMR",233,0)
 .K ^TMP("PXRHM",$J)
"RTN","C0IVMR",234,0)
 Q
"RTN","C0IVMR",235,0)
 ;
"RTN","C0IVMR",236,0)
PDATE(INDX) ; extrinsic which returns the date to use for the problem
"RTN","C0IVMR",237,0)
 ; INDX is passed by value and is the index into the findings ie "hadHepB" 
"RTN","C0IVMR",238,0)
 N C0FIND,RTN
"RTN","C0IVMR",239,0)
 S C0FIND=$O(RETURN("findings","B",INDX,""))
"RTN","C0IVMR",240,0)
 I C0FIND'="" D  ;
"RTN","C0IVMR",241,0)
 . N C0DATE
"RTN","C0IVMR",242,0)
 . S C0DATE=$G(RETURN("findings",C0FIND,"dateOfOnset"))
"RTN","C0IVMR",243,0)
 . I C0DATE="" S C0DATE=$G(RETURN("findings",C0FIND,"date"))
"RTN","C0IVMR",244,0)
 . S RTN=$$FMDTOCDA^C0IUTIL(C0DATE)
"RTN","C0IVMR",245,0)
 E  S RTN=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0IVMR",246,0)
 Q RTN
"RTN","C0IVMR",247,0)
 ;
"RTN","C0IVMR",248,0)
HEPB ;
"RTN","C0IVMR",249,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0IVMR",250,0)
 S C0IPOA("timeProblem")=$$PDATE("hadHepB")
"RTN","C0IVMR",251,0)
 S C0IPOA("codeICD9")="070.30"
"RTN","C0IVMR",252,0)
 S C0IPOA("codeName")="Viral hepatitis B without mention of hepatic coma, acute or unspecified, without mention of hepatitis delta"
"RTN","C0IVMR",253,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0IVMR","C0IPOA")
"RTN","C0IVMR",254,0)
 K C0IPOA("UUIDA")
"RTN","C0IVMR",255,0)
 K C0IPOA("timeProblem")
"RTN","C0IVMR",256,0)
 K C0IPOA("codeICD9")
"RTN","C0IVMR",257,0)
 K C0IPOA("codeName")
"RTN","C0IVMR",258,0)
 Q
"RTN","C0IVMR",259,0)
 ;
"RTN","C0IVMR",260,0)
HEPA ;
"RTN","C0IVMR",261,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0IVMR",262,0)
 S C0IPOA("timeProblem")=$$PDATE("hadHepA")
"RTN","C0IVMR",263,0)
 ;S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0IVMR",264,0)
 ;S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL("3130101")
"RTN","C0IVMR",265,0)
 S C0IPOA("codeICD9")="070.1"
"RTN","C0IVMR",266,0)
 S C0IPOA("codeName")="Viral hepatitis A without mention of hepatic coma"
"RTN","C0IVMR",267,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0IVMR","C0IPOA")
"RTN","C0IVMR",268,0)
 K C0IPOA("UUIDA")
"RTN","C0IVMR",269,0)
 K C0IPOA("timeProblem")
"RTN","C0IVMR",270,0)
 K C0IPOA("codeICD9")
"RTN","C0IVMR",271,0)
 K C0IPOA("codeName") 
"RTN","C0IVMR",272,0)
 Q
"RTN","C0IVMR",273,0)
 ;
"RTN","C0IVMR",274,0)
VARICEL ;
"RTN","C0IVMR",275,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0IVMR",276,0)
 S C0IPOA("timeProblem")=$$PDATE("hadVaricella")
"RTN","C0IVMR",277,0)
 ;S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0IVMR",278,0)
 S C0IPOA("codeICD9")="052.9"
"RTN","C0IVMR",279,0)
 S C0IPOA("codeName")="Varicella without mention of complication"
"RTN","C0IVMR",280,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0IVMR","C0IPOA")
"RTN","C0IVMR",281,0)
 K C0IPOA("UUIDA")
"RTN","C0IVMR",282,0)
 K C0IPOA("timeProblem")
"RTN","C0IVMR",283,0)
 K C0IPOA("codeICD9")
"RTN","C0IVMR",284,0)
 K C0IPOA("codeName")
"RTN","C0IVMR",285,0)
 Q 
"RTN","C0IVMR",286,0)
 ;  
"RTN","C0IVMR",287,0)
MUMPS ;
"RTN","C0IVMR",288,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0IVMR",289,0)
 S C0IPOA("timeProblem")=$$PDATE("hadMumps")
"RTN","C0IVMR",290,0)
 ;S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0IVMR",291,0)
 S C0IPOA("codeICD9")="072.9"
"RTN","C0IVMR",292,0)
 S C0IPOA("codeName")="Mumps without mention of complication"
"RTN","C0IVMR",293,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0IVMR","C0IPOA")
"RTN","C0IVMR",294,0)
 K C0IPOA("UUIDA")  
"RTN","C0IVMR",295,0)
 K C0IPOA("timeProblem")
"RTN","C0IVMR",296,0)
 K C0IPOA("codeICD9")
"RTN","C0IVMR",297,0)
 K C0IPOA("codeName")
"RTN","C0IVMR",298,0)
 Q
"RTN","C0IVMR",299,0)
 ; 
"RTN","C0IVMR",300,0)
MEASLES ;
"RTN","C0IVMR",301,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0IVMR",302,0)
 S C0IPOA("timeProblem")=$$PDATE("hadMeasles")
"RTN","C0IVMR",303,0)
 ;S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0IVMR",304,0)
 S C0IPOA("codeICD9")="055.9"
"RTN","C0IVMR",305,0)
 S C0IPOA("codeName")="Measles without mention of complication"
"RTN","C0IVMR",306,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0IVMR","C0IPOA")
"RTN","C0IVMR",307,0)
 K C0IPOA("UUIDA")
"RTN","C0IVMR",308,0)
 K C0IPOA("timeProblem")
"RTN","C0IVMR",309,0)
 K C0IPOA("codeICD9")
"RTN","C0IVMR",310,0)
 K C0IPOA("codeName")
"RTN","C0IVMR",311,0)
 Q
"RTN","C0IVMR",312,0)
 ;
"RTN","C0IVMR",313,0)
RUBELLA ;
"RTN","C0IVMR",314,0)
 S C0IPOA("UUIDA")=$$UUID^C0IUTIL
"RTN","C0IVMR",315,0)
 S C0IPOA("timeProblem")=$$PDATE("hadRubella")
"RTN","C0IVMR",316,0)
 ;S C0IPOA("timeProblem")=$$FMDTOCDA^C0IUTIL(DT)
"RTN","C0IVMR",317,0)
 S C0IPOA("codeICD9")="056.9"
"RTN","C0IVMR",318,0)
 S C0IPOA("codeName")="Rubella without mention of complication"
"RTN","C0IVMR",319,0)
 D GETNMAP^C0IUTIL("WRK","PAYOUTM^C0IVMR","C0IPOA")
"RTN","C0IVMR",320,0)
 K C0IPOA("UUIDA")  
"RTN","C0IVMR",321,0)
 K C0IPOA("timeProblem")
"RTN","C0IVMR",322,0)
 K C0IPOA("codeICD9")
"RTN","C0IVMR",323,0)
 K C0IPOA("codeName")
"RTN","C0IVMR",324,0)
 Q
"RTN","C0IVMR",325,0)
 ;
"RTN","C0IVMR",326,0)
TPAYOUTC ;
"RTN","C0IVMR",327,0)
 ;;; only one line that is fixed for substance administration 
"RTN","C0IVMR",328,0)
 ;;<substanceAdministrationEvents>
"RTN","C0IVMR",329,0)
 Q
"RTN","C0IVMR",330,0)
 ;
"RTN","C0IVMR",331,0)
TPAYOUTD ; 
"RTN","C0IVMR",332,0)
 ;;; this section loops through the immunizations
"RTN","C0IVMR",333,0)
 ;;<substanceAdministrationEvent>
"RTN","C0IVMR",334,0)
 ;;<templateId root="2.16.840.1.113883.3.795.11.9.1.1"/>
"RTN","C0IVMR",335,0)
 ;;<id root="@@UUID1@@"/>
"RTN","C0IVMR",336,0)
 ;;<substanceAdministrationGeneralPurpose code="384810002" codeSystem="2.16.840.1.113883.6.5"/>
"RTN","C0IVMR",337,0)
 ;;<substance>
"RTN","C0IVMR",338,0)
 ;;<id root="@@UUID2@@"/>
"RTN","C0IVMR",339,0)
 ;;<substanceCode code="@@CVXCode@@" codeSystem="2.16.840.1.113883.12.292" displayName="@@CVXName@@" originalText="@@ORIGName@@"/>
"RTN","C0IVMR",340,0)
 ;;</substance>
"RTN","C0IVMR",341,0)
 ;;<administrationTimeInterval low="@@admDate@@" high="@@admDate@@"/>
"RTN","C0IVMR",342,0)
 ;;</substanceAdministrationEvent>
"RTN","C0IVMR",343,0)
 Q
"RTN","C0IVMR",344,0)
 ;
"RTN","C0IVMR",345,0)
PAYOUTDV ;
"RTN","C0IVMR",346,0)
 ; Variable and code for the looping IMMUNIZATIONS section
"RTN","C0IVMR",347,0)
 ; Need UUID x 2, CVX code, name from CVX Short name, administration date 
"RTN","C0IVMR",348,0)
 ;(need really only one eve thought it asks for high and low - use the same variable)
"RTN","C0IVMR",349,0)
 D GETPAT^C0IEXTR(.G,DFN,"immunization")
"RTN","C0IVMR",350,0)
 I G("results","immunizations@total")=0 Q
"RTN","C0IVMR",351,0)
 E  D
"RTN","C0IVMR",352,0)
 .N T S T=G("results","immunizations@total")
"RTN","C0IVMR",353,0)
 .I T=1 D  ;
"RTN","C0IVMR",354,0)
 ..N GTMP
"RTN","C0IVMR",355,0)
 ..M GTMP=G("results","immunizations")
"RTN","C0IVMR",356,0)
 ..K G("results","immunizations")
"RTN","C0IVMR",357,0)
 .. M G("results","immunizations",1)=GTMP
"RTN","C0IVMR",358,0)
 .. K GTMP
"RTN","C0IVMR",359,0)
 .N I S I=""
"RTN","C0IVMR",360,0)
 .F I=1:1:T D
"RTN","C0IVMR",361,0)
 ..W:'$G(DIQUIET) "I is ",I,!
"RTN","C0IVMR",362,0)
 ..D OUTLOG^C0IUTIL("I is "_I)
"RTN","C0IVMR",363,0)
 ..N CPTIMM,CVXCODE,ADMDATE,IMMNAME,IMMCVX
"RTN","C0IVMR",364,0)
 ..S C0IPOA("UUID1")=$$UUID^C0IUTIL 
"RTN","C0IVMR",365,0)
 ..S C0IPOA("UUID2")=$$UUID^C0IUTIL
"RTN","C0IVMR",366,0)
 ..S C0IPOA("CVXCode")=""
"RTN","C0IVMR",367,0)
 ..S C0IPOA("CVXName")=""
"RTN","C0IVMR",368,0)
 ..S C0IPOA("ORIGName")=""
"RTN","C0IVMR",369,0)
 ..S C0IPOA("admDate")=""
"RTN","C0IVMR",370,0)
 ..I $D(G("results","immunizations",I,"immunization","cpt@code")) D 
"RTN","C0IVMR",371,0)
 ...; If there is a CPT code, use that to get the CVX code and the proper CVC code name
"RTN","C0IVMR",372,0)
 ...N CPTIMM,CVXCODE,ADMDATE 
"RTN","C0IVMR",373,0)
 ...S CPTIMM="" S CVXCODE="" S ADMDATE=""
"RTN","C0IVMR",374,0)
 ...S CPTIMM=$G(G("results","immunizations",I,"immunization","cpt@code"))
"RTN","C0IVMR",375,0)
 ...W:'$G(DIQUIET) "CPTIMM from G is ",CPTIMM,!
"RTN","C0IVMR",376,0)
 ...S CVXCODE=CPTMAP(CPTIMM)
"RTN","C0IVMR",377,0)
 ...W:'$G(DIQUIET) "The CVX code for this immunizaton with a CPT code is ",CVXCODE,!
"RTN","C0IVMR",378,0)
 ...I ((CVXCODE'="")!(CVXCODE=999)) D  Q
"RTN","C0IVMR",379,0)
 ....; If you found the CVXCode by the CPT code, add the XML to the array and QUIT  
"RTN","C0IVMR",380,0)
 ....S C0IPOA("CVXCode")=CVXCODE
"RTN","C0IVMR",381,0)
 ....S C0IPOA("CVXName")=CVXMAP(CVXCODE)
"RTN","C0IVMR",382,0)
 ....S C0IPOA("ORIGName")=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0IVMR",383,0)
 ....S ADMDATE=$G(G("results","immunizations",I,"immunization","administered@value"))
"RTN","C0IVMR",384,0)
 ....S C0IPOA("admDate")=$$FMDTOCDA^C0IUTIL(ADMDATE)
"RTN","C0IVMR",385,0)
 ....D GETNMAP^C0IUTIL("WRK","TPAYOUTD^C0IVMR","C0IPOA")
"RTN","C0IVMR",386,0)
 ..I '$D(G("results","immunizations",I,"immunization","cpt@code")) D
"RTN","C0IVMR",387,0)
 ...; if there is no CPT code, try to look it up by the proper CVX code name
"RTN","C0IVMR",388,0)
 ...N IMMNAME,IMMCVX,IMMCPT,CVXCODE,ADMDATE
"RTN","C0IVMR",389,0)
 ...S (IMMNAME,IMMCVX,IMMCPT,CVXCODE,ADMDATE)=""
"RTN","C0IVMR",390,0)
 ...S IMMNAME=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0IVMR",391,0)
 ...W:'$G(DIQUIET) "IMMNAME in the no CPT look up by proper CVX code name is ",IMMNAME,!
"RTN","C0IVMR",392,0)
 ...S IMMCVX=$O(CVXMAP("B",IMMNAME,""))
"RTN","C0IVMR",393,0)
 ...W:'$G(DIQUIET) "IMMCVX for this vaccine with a proper name is ",IMMCVX,!
"RTN","C0IVMR",394,0)
 ...I IMMCVX="" D
"RTN","C0IVMR",395,0)
 ....; If the CVX code is not found by the proper CVX code name, try the lookup in the CPTIMAP section by the
"RTN","C0IVMR",396,0)
 ....; original name which are odd names in the Immunization file.
"RTN","C0IVMR",397,0)
 ....; Once you have the CVX code, get the proper text from the CVX code from the CVX Map
"RTN","C0IVMR",398,0)
 ....; Once a different method of storing the CVX-Immunization map is found, then this section will be replaced
"RTN","C0IVMR",399,0)
 ....; CVXIMAP is specific a VistA instance.
"RTN","C0IVMR",400,0)
 ....N CVXCODE,IMMNAME,IMMCVX,ADMDATE,CVXNAME
"RTN","C0IVMR",401,0)
 ....S (CVXCODE,IMMNAME,IMMCVX,ADMDATE,CVXNAME)=""
"RTN","C0IVMR",402,0)
 ....S IMMNAME=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0IVMR",403,0)
 ....I IMMNAME="" S IMMNAME=$G(G("results","immunizations","immunization","name@value"))
"RTN","C0IVMR",404,0)
 ....I IMMNAME="" D  Q
"RTN","C0IVMR",405,0)
 ....W:'$G(DIQUIET) "The IMMNAME for this immunization without a proper name is ",IMMNAME,!
"RTN","C0IVMR",406,0)
 ....S CVXCODE=$O(CVXIMAP("B",IMMNAME,""))
"RTN","C0IVMR",407,0)
 ....W:'$G(DIQUIET) "The CVX code for this immunization without the proper name is ",CVXCODE,!
"RTN","C0IVMR",408,0)
 ....S CVXNAME=CVXMAP(CVXCODE) 
"RTN","C0IVMR",409,0)
 ....W:'$G(DIQUIET) "The proper name for this immunization is ",CVXNAME,!
"RTN","C0IVMR",410,0)
 ....I CVXCODE="" D  Q
"RTN","C0IVMR",411,0)
 .....; If there is still no CVX code found, record and error and quit
"RTN","C0IVMR",412,0)
 .....S ZTXT=$G(G("results","immunizations",I,"immunization","id@value"))
"RTN","C0IVMR",413,0)
 .....D OUTLOG("ERROR-Missing CVX or Incorrect Name for IEN="_ZTXT)
"RTN","C0IVMR",414,0)
 ....E  D
"RTN","C0IVMR",415,0)
 .....; Else, if you have found a CVX code, then write the XML to the array and QUIT
"RTN","C0IVMR",416,0)
 .....S C0IPOA("CVXCode")=CVXCODE
"RTN","C0IVMR",417,0)
 .....S C0IPOA("CVXName")=CVXNAME
"RTN","C0IVMR",418,0)
 .....S C0IPOA("ORIGName")=$G(G("results","immunizations",I,"immunization","name@value"))
"RTN","C0IVMR",419,0)
 .....S ADMDATE=$G(G("results","immunizations",I,"immunization","administered@value"))
"RTN","C0IVMR",420,0)
 .....S C0IPOA("admDate")=$$FMDTOCDA^C0IUTIL(ADMDATE) ;S ^GPL("DATE",I)=ADMDATE
"RTN","C0IVMR",421,0)
 .....D GETNMAP^C0IUTIL("WRK","TPAYOUTD^C0IVMR","C0IPOA")
"RTN","C0IVMR",422,0)
 Q
"RTN","C0IVMR",423,0)
 ;
"RTN","C0IVMR",424,0)
OUTLOG(ZTXT) ; add text to the log
"RTN","C0IVMR",425,0)
 I '$D(C0LOGLOC) S C0LOGLOC=$NA(^TMP("C0I",$J,"LOG"))
"RTN","C0IVMR",426,0)
 N LN S LN=$O(@C0LOGLOC@(""),-1)+1
"RTN","C0IVMR",427,0)
 S @C0LOGLOC@(LN)=ZTXT
"RTN","C0IVMR",428,0)
 Q
"RTN","C0IVMR",429,0)
 ;
"RTN","C0IVMR",430,0)
TPAYOUTE
"RTN","C0IVMR",431,0)
 ;;;fixed end portion of payload
"RTN","C0IVMR",432,0)
 ;;</substanceAdministrationEvents>
"RTN","C0IVMR",433,0)
 ;;</clinicalStatements>
"RTN","C0IVMR",434,0)
 ;;</patient>
"RTN","C0IVMR",435,0)
 ;;</vmrInput>
"RTN","C0IVMR",436,0)
 ;;</ns4:cdsInput>
"RTN","C0IVMR",437,0)
 Q
"RTN","C0IVMR",438,0)
 ;
"RTN","C0IVMR",439,0)
CPTMAP
"RTN","C0IVMR",440,0)
 S CPTMAP(90281)=86
"RTN","C0IVMR",441,0)
 S CPTMAP(90283)=87
"RTN","C0IVMR",442,0)
 S CPTMAP(90287)=27
"RTN","C0IVMR",443,0)
 S CPTMAP(90291)=29
"RTN","C0IVMR",444,0)
 S CPTMAP(90296)=12
"RTN","C0IVMR",445,0)
 S CPTMAP(90371)=30
"RTN","C0IVMR",446,0)
 S CPTMAP(90375)=34
"RTN","C0IVMR",447,0)
 S CPTMAP(90376)=34
"RTN","C0IVMR",448,0)
 S CPTMAP(90378)=93
"RTN","C0IVMR",449,0)
 S CPTMAP(90379)=71
"RTN","C0IVMR",450,0)
 S CPTMAP(90389)=13
"RTN","C0IVMR",451,0)
 S CPTMAP(90393)=79
"RTN","C0IVMR",452,0)
 S CPTMAP(90396)=36
"RTN","C0IVMR",453,0)
 S CPTMAP(90470)=128
"RTN","C0IVMR",454,0)
 S CPTMAP(90476)=54
"RTN","C0IVMR",455,0)
 S CPTMAP(90477)=55
"RTN","C0IVMR",456,0)
 S CPTMAP(90581)=24
"RTN","C0IVMR",457,0)
 S CPTMAP(90585)=19
"RTN","C0IVMR",458,0)
 S CPTMAP(90632)=52
"RTN","C0IVMR",459,0)
 S CPTMAP(90633)=83
"RTN","C0IVMR",460,0)
 S CPTMAP(90634)=84
"RTN","C0IVMR",461,0)
 S CPTMAP(90636)=104
"RTN","C0IVMR",462,0)
 S CPTMAP(90644)=148
"RTN","C0IVMR",463,0)
 S CPTMAP(90645)=47
"RTN","C0IVMR",464,0)
 S CPTMAP(90646)=46
"RTN","C0IVMR",465,0)
 S CPTMAP(90647)=49
"RTN","C0IVMR",466,0)
 S CPTMAP(90648)=48
"RTN","C0IVMR",467,0)
 S CPTMAP(90649)=62
"RTN","C0IVMR",468,0)
 S CPTMAP(90650)=118
"RTN","C0IVMR",469,0)
 S CPTMAP(90654)=144
"RTN","C0IVMR",470,0)
 S CPTMAP(90655)=140
"RTN","C0IVMR",471,0)
 S CPTMAP(90656)=140
"RTN","C0IVMR",472,0)
 S CPTMAP(90657)=141
"RTN","C0IVMR",473,0)
 S CPTMAP(90658)=141
"RTN","C0IVMR",474,0)
 S CPTMAP(90659)=16
"RTN","C0IVMR",475,0)
 S CPTMAP(90660)=111
"RTN","C0IVMR",476,0)
 S CPTMAP(90661)=153
"RTN","C0IVMR",477,0)
 S CPTMAP(90662)=135
"RTN","C0IVMR",478,0)
 S CPTMAP(90663)=128
"RTN","C0IVMR",479,0)
 S CPTMAP(90664)=125
"RTN","C0IVMR",480,0)
 S CPTMAP(90665)=66
"RTN","C0IVMR",481,0)
 S CPTMAP(90666)=126
"RTN","C0IVMR",482,0)
 S CPTMAP(90668)=127
"RTN","C0IVMR",483,0)
 S CPTMAP(90669)=100
"RTN","C0IVMR",484,0)
 S CPTMAP(90670)=133
"RTN","C0IVMR",485,0)
 S CPTMAP(90672)=149
"RTN","C0IVMR",486,0)
 S CPTMAP(90673)=155
"RTN","C0IVMR",487,0)
 S CPTMAP(90675)=18
"RTN","C0IVMR",488,0)
 S CPTMAP(90676)=40
"RTN","C0IVMR",489,0)
 S CPTMAP(90680)=116
"RTN","C0IVMR",490,0)
 S CPTMAP(90681)=119
"RTN","C0IVMR",491,0)
 S CPTMAP(90685)=150
"RTN","C0IVMR",492,0)
 S CPTMAP(90686)=150
"RTN","C0IVMR",493,0)
 S CPTMAP(90688)=158
"RTN","C0IVMR",494,0)
 S CPTMAP(90690)=25
"RTN","C0IVMR",495,0)
 S CPTMAP(90691)=101
"RTN","C0IVMR",496,0)
 S CPTMAP(90692)=41
"RTN","C0IVMR",497,0)
 S CPTMAP(90693)=53
"RTN","C0IVMR",498,0)
 S CPTMAP(90696)=130
"RTN","C0IVMR",499,0)
 S CPTMAP(90698)=120
"RTN","C0IVMR",500,0)
 S CPTMAP(90700)=20
"RTN","C0IVMR",501,0)
 S CPTMAP(90700)=106
"RTN","C0IVMR",502,0)
 S CPTMAP(90701)=01
"RTN","C0IVMR",503,0)
 S CPTMAP(90702)=28
"RTN","C0IVMR",504,0)
 S CPTMAP(90703)=35
"RTN","C0IVMR",505,0)
 S CPTMAP(90704)=07
"RTN","C0IVMR",506,0)
 S CPTMAP(90705)=05
"RTN","C0IVMR",507,0)
 S CPTMAP(90706)=06
"RTN","C0IVMR",508,0)
 S CPTMAP(90707)=03
"RTN","C0IVMR",509,0)
 S CPTMAP(90708)=04
"RTN","C0IVMR",510,0)
 S CPTMAP(90710)=94
"RTN","C0IVMR",511,0)
 S CPTMAP(90712)=02
"RTN","C0IVMR",512,0)
 S CPTMAP(90713)=10
"RTN","C0IVMR",513,0)
 S CPTMAP(90714)=113
"RTN","C0IVMR",514,0)
 S CPTMAP(90714)=91
"RTN","C0IVMR",515,0)
 S CPTMAP(90715)=115
"RTN","C0IVMR",516,0)
 S CPTMAP(90716)=21
"RTN","C0IVMR",517,0)
 S CPTMAP(90717)=37
"RTN","C0IVMR",518,0)
 S CPTMAP(90718)=09
"RTN","C0IVMR",519,0)
 S CPTMAP(90720)=22
"RTN","C0IVMR",520,0)
 S CPTMAP(90721)=50
"RTN","C0IVMR",521,0)
 S CPTMAP(90723)=110
"RTN","C0IVMR",522,0)
 S CPTMAP(90724)=88
"RTN","C0IVMR",523,0)
 S CPTMAP(90725)=26
"RTN","C0IVMR",524,0)
 S CPTMAP(90726)=90
"RTN","C0IVMR",525,0)
 S CPTMAP(90727)=23
"RTN","C0IVMR",526,0)
 S CPTMAP(90728)=19
"RTN","C0IVMR",527,0)
 S CPTMAP(90730)=85
"RTN","C0IVMR",528,0)
 S CPTMAP(90731)=45
"RTN","C0IVMR",529,0)
 S CPTMAP(90732)=33
"RTN","C0IVMR",530,0)
 S CPTMAP(90733)=32
"RTN","C0IVMR",531,0)
 S CPTMAP(90734)=136
"RTN","C0IVMR",532,0)
 S CPTMAP(90734)=114
"RTN","C0IVMR",533,0)
 S CPTMAP(90735)=39
"RTN","C0IVMR",534,0)
 S CPTMAP(90736)=121
"RTN","C0IVMR",535,0)
 S CPTMAP(90737)=17
"RTN","C0IVMR",536,0)
 S CPTMAP(90738)=134
"RTN","C0IVMR",537,0)
 S CPTMAP(90740)=44
"RTN","C0IVMR",538,0)
 S CPTMAP(90741)=14
"RTN","C0IVMR",539,0)
 S CPTMAP(90743)=43
"RTN","C0IVMR",540,0)
 S CPTMAP(90744)=08
"RTN","C0IVMR",541,0)
 S CPTMAP(90745)=42
"RTN","C0IVMR",542,0)
 S CPTMAP(90746)=43
"RTN","C0IVMR",543,0)
 S CPTMAP(90747)=44
"RTN","C0IVMR",544,0)
 S CPTMAP(90748)=51  
"RTN","C0IVMR",545,0)
 S CPTMAP(90749)=999
"RTN","C0IVMR",546,0)
 Q
"RTN","C0IVMR",547,0)
CVXMAP
"RTN","C0IVMR",548,0)
 S CVXMAP(86)="IG"
"RTN","C0IVMR",549,0)
 S CVXMAP(87)="IGIV"
"RTN","C0IVMR",550,0)
 S CVXMAP(27)="botulinum antitoxin"
"RTN","C0IVMR",551,0)
 S CVXMAP(29)="CMVIG"
"RTN","C0IVMR",552,0)
 S CVXMAP(12)="diphtheria antitoxin"
"RTN","C0IVMR",553,0)
 S CVXMAP(30)="HBIG"
"RTN","C0IVMR",554,0)
 S CVXMAP(34)="RIG"
"RTN","C0IVMR",555,0)
 S CVXMAP(34)="RIG"
"RTN","C0IVMR",556,0)
 S CVXMAP(93)="RSV-MAb"
"RTN","C0IVMR",557,0)
 S CVXMAP(71)="RSV-IGIV"
"RTN","C0IVMR",558,0)
 S CVXMAP(13)="TIG"
"RTN","C0IVMR",559,0)
 S CVXMAP(79)="vaccinia immune globulin"
"RTN","C0IVMR",560,0)
 S CVXMAP(36)="VZIG"
"RTN","C0IVMR",561,0)
 S CVXMAP(128)="Novel Influenza-H1N1-09, all formulations"
"RTN","C0IVMR",562,0)
 S CVXMAP(54)="adenovirus, type 4"
"RTN","C0IVMR",563,0)
 S CVXMAP(55)="adenovirus, type 7"
"RTN","C0IVMR",564,0)
 S CVXMAP(24)="anthrax"
"RTN","C0IVMR",565,0)
 S CVXMAP(19)="BCG"
"RTN","C0IVMR",566,0)
 S CVXMAP(52)="Hep A, adult"
"RTN","C0IVMR",567,0)
 S CVXMAP(83)="Hep A, ped/adol, 2 dose"
"RTN","C0IVMR",568,0)
 S CVXMAP(84)="Hep A, ped/adol, 3 dose"
"RTN","C0IVMR",569,0)
 S CVXMAP(104)="Hep A-Hep B"
"RTN","C0IVMR",570,0)
 S CVXMAP(148)="Meningococcal C/Y-HIB PRP"
"RTN","C0IVMR",571,0)
 S CVXMAP(47)="Hib (HbOC)"
"RTN","C0IVMR",572,0)
 S CVXMAP(46)="Hib (PRP-D)"
"RTN","C0IVMR",573,0)
 S CVXMAP(49)="Hib (PRP-OMP)"
"RTN","C0IVMR",574,0)
 S CVXMAP(48)="Hib (PRP-T)"
"RTN","C0IVMR",575,0)
 S CVXMAP(62)="HPV, quadrivalent"
"RTN","C0IVMR",576,0)
 S CVXMAP(118)="HPV, bivalent"
"RTN","C0IVMR",577,0)
 S CVXMAP(144)="influenza, seasonal, intradermal, preservative free"
"RTN","C0IVMR",578,0)
 S CVXMAP(140)="Influenza, seasonal, injectable, preservative free"
"RTN","C0IVMR",579,0)
 S CVXMAP(140)="Influenza, seasonal, injectable, preservative free"
"RTN","C0IVMR",580,0)
 S CVXMAP(141)="Influenza, seasonal, injectable"
"RTN","C0IVMR",581,0)
 S CVXMAP(141)="Influenza, seasonal, injectable"
"RTN","C0IVMR",582,0)
 S CVXMAP(16)="influenza, whole"
"RTN","C0IVMR",583,0)
 S CVXMAP(111)="influenza, live, intranasal"
"RTN","C0IVMR",584,0)
 S CVXMAP(153)="Influenza, injectable, MDCK, preservative free"
"RTN","C0IVMR",585,0)
 S CVXMAP(135)="Influenza, high dose seasonal"
"RTN","C0IVMR",586,0)
 S CVXMAP(128)="Novel Influenza-H1N1-09, all formulations"
"RTN","C0IVMR",587,0)
 S CVXMAP(125)="Novel Influenza-H1N1-09, nasal"
"RTN","C0IVMR",588,0)
 S CVXMAP(66)="Lyme disease"
"RTN","C0IVMR",589,0)
 S CVXMAP(126)="Novel influenza-H1N1-09, preservative-free"
"RTN","C0IVMR",590,0)
 S CVXMAP(127)="Novel influenza-H1N1-09"
"RTN","C0IVMR",591,0)
 S CVXMAP(100)="pneumococcal conjugate PCV 7"
"RTN","C0IVMR",592,0)
 S CVXMAP(133)="Pneumococcal conjugate PCV 13"
"RTN","C0IVMR",593,0)
 S CVXMAP(149)="influenza, live, intranasal, quadrivalent"
"RTN","C0IVMR",594,0)
 S CVXMAP(155)="influenza, recombinant, injectable, preservative free"
"RTN","C0IVMR",595,0)
 S CVXMAP(18)="rabies, intramuscular injection"
"RTN","C0IVMR",596,0)
 S CVXMAP(40)="rabies, intradermal injection"
"RTN","C0IVMR",597,0)
 S CVXMAP(116)="rotavirus, pentavalent"
"RTN","C0IVMR",598,0)
 S CVXMAP(119)="rotavirus, monovalent"
"RTN","C0IVMR",599,0)
 S CVXMAP(150)="influenza, injectable, quadrivalent, preservative free"
"RTN","C0IVMR",600,0)
 S CVXMAP(150)="influenza, injectable, quadrivalent, preservative free"
"RTN","C0IVMR",601,0)
 S CVXMAP(158)="influenza, injectable, quadrivalent"
"RTN","C0IVMR",602,0)
 S CVXMAP(25)="typhoid, oral"
"RTN","C0IVMR",603,0)
 S CVXMAP(101)="typhoid, ViCPs"
"RTN","C0IVMR",604,0)
 S CVXMAP(41)="typhoid, parenteral"
"RTN","C0IVMR",605,0)
 S CVXMAP(53)="typhoid, parenteral, AKD (U.S. military)"
"RTN","C0IVMR",606,0)
 S CVXMAP(130)="DTaP-IPV"
"RTN","C0IVMR",607,0)
 S CVXMAP(120)="DTaP-Hib-IPV"
"RTN","C0IVMR",608,0)
 S CVXMAP(20)="DTaP"
"RTN","C0IVMR",609,0)
 S CVXMAP(106)="DTaP, 5 pertussis antigens"
"RTN","C0IVMR",610,0)
 S CVXMAP(01)="DTP"
"RTN","C0IVMR",611,0)
 S CVXMAP(28)="DT (pediatric)"
"RTN","C0IVMR",612,0)
 S CVXMAP(35)="tetanus toxoid, adsorbed"
"RTN","C0IVMR",613,0)
 S CVXMAP(07)="mumps"
"RTN","C0IVMR",614,0)
 S CVXMAP(05)="measles"
"RTN","C0IVMR",615,0)
 S CVXMAP(06)="rubella"
"RTN","C0IVMR",616,0)
 S CVXMAP(03)="MMR"
"RTN","C0IVMR",617,0)
 S CVXMAP(04)="M/R"
"RTN","C0IVMR",618,0)
 S CVXMAP(94)="MMRV"
"RTN","C0IVMR",619,0)
 S CVXMAP(02)="OPV"
"RTN","C0IVMR",620,0)
 S CVXMAP(10)="IPV"
"RTN","C0IVMR",621,0)
 S CVXMAP(113)="Td (adult) preservative free"
"RTN","C0IVMR",622,0)
 S CVXMAP(91)="typhoid, unspecified formulation"
"RTN","C0IVMR",623,0)
 S CVXMAP(115)="Tdap"
"RTN","C0IVMR",624,0)
 S CVXMAP(21)="varicella"
"RTN","C0IVMR",625,0)
 S CVXMAP(37)="yellow fever"
"RTN","C0IVMR",626,0)
 S CVXMAP(09)="Td (adult), adsorbed"
"RTN","C0IVMR",627,0)
 S CVXMAP(22)="DTP-Hib"
"RTN","C0IVMR",628,0)
 S CVXMAP(50)="DTaP-Hib"
"RTN","C0IVMR",629,0)
 S CVXMAP(110)="DTaP-Hep B-IPV"
"RTN","C0IVMR",630,0)
 S CVXMAP(88)="influenza, unspecified formulation"
"RTN","C0IVMR",631,0)
 S CVXMAP(26)="cholera"
"RTN","C0IVMR",632,0)
 S CVXMAP(90)="rabies, unspecified formulation"
"RTN","C0IVMR",633,0)
 S CVXMAP(23)="plague"
"RTN","C0IVMR",634,0)
 S CVXMAP(19)="BCG"
"RTN","C0IVMR",635,0)
 S CVXMAP(85)="Hep A, unspecified formulation"
"RTN","C0IVMR",636,0)
 S CVXMAP(45)="Hep B, unspecified formulation"
"RTN","C0IVMR",637,0)
 S CVXMAP(33)="pneumococcal polysaccharide PPV23"
"RTN","C0IVMR",638,0)
 S CVXMAP(32)="meningococcal MPSV4"
"RTN","C0IVMR",639,0)
 S CVXMAP(136)="Meningococcal MCV4O"
"RTN","C0IVMR",640,0)
 S CVXMAP(114)="meningococcal MCV4P"
"RTN","C0IVMR",641,0)
 S CVXMAP(39)="Japanese encephalitis SC"
"RTN","C0IVMR",642,0)
 S CVXMAP(121)="zoster"
"RTN","C0IVMR",643,0)
 S CVXMAP(17)="Hib, unspecified formulation"
"RTN","C0IVMR",644,0)
 S CVXMAP(134)="Japanese Encephalitis IM"
"RTN","C0IVMR",645,0)
 S CVXMAP(44)="Hep B, dialysis"
"RTN","C0IVMR",646,0)
 S CVXMAP(14)="IG, unspecified formulation"
"RTN","C0IVMR",647,0)
 S CVXMAP(43)="Hep B, adult"
"RTN","C0IVMR",648,0)
 S CVXMAP(08)="Hep B, adolescent or pediatric"
"RTN","C0IVMR",649,0)
 S CVXMAP(42)="Hep B, adolescent/high risk infant"
"RTN","C0IVMR",650,0)
 S CVXMAP(43)="Hep B, adult"
"RTN","C0IVMR",651,0)
 S CVXMAP(44)="Hep B, dialysis"
"RTN","C0IVMR",652,0)
 S CVXMAP(51)="Hib-Hep B"
"RTN","C0IVMR",653,0)
 S CVXMAP(999)="unknown"
"RTN","C0IVMR",654,0)
 S CVXMAP("B","IG",86)=""
"RTN","C0IVMR",655,0)
 S CVXMAP("B","IGIV",87)=""
"RTN","C0IVMR",656,0)
 S CVXMAP("B","botulinum antitoxin",27)=""
"RTN","C0IVMR",657,0)
 S CVXMAP("B","CMVIG",29)=""
"RTN","C0IVMR",658,0)
 S CVXMAP("B","diphtheria antitoxin",12)=""
"RTN","C0IVMR",659,0)
 S CVXMAP("B","HBIG",30)=""
"RTN","C0IVMR",660,0)
 S CVXMAP("B","RIG",34)=""
"RTN","C0IVMR",661,0)
 S CVXMAP("B","RIG",34)=""
"RTN","C0IVMR",662,0)
 S CVXMAP("B","RSV-MAb",93)=""
"RTN","C0IVMR",663,0)
 S CVXMAP("B","RSV-IGIV",71)=""
"RTN","C0IVMR",664,0)
 S CVXMAP("B","TIG",13)=""
"RTN","C0IVMR",665,0)
 S CVXMAP("B","vaccinia immune globulin",79)=""
"RTN","C0IVMR",666,0)
 S CVXMAP("B","VZIG",36)=""
"RTN","C0IVMR",667,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, all formulations",128)=""
"RTN","C0IVMR",668,0)
 S CVXMAP("B","adenovirus, type 4",54)=""
"RTN","C0IVMR",669,0)
 S CVXMAP("B","adenovirus, type 7",55)=""
"RTN","C0IVMR",670,0)
 S CVXMAP("B","anthrax",24)=""
"RTN","C0IVMR",671,0)
 S CVXMAP("B","BCG",19)=""
"RTN","C0IVMR",672,0)
 S CVXMAP("B","Hep A, adult",52)=""
"RTN","C0IVMR",673,0)
 S CVXMAP("B","Hep A, ped/adol, 2 dose",83)=""
"RTN","C0IVMR",674,0)
 S CVXMAP("B","Hep A, ped/adol, 3 dose",84)=""
"RTN","C0IVMR",675,0)
 S CVXMAP("B","Hep A-Hep B",104)=""
"RTN","C0IVMR",676,0)
 S CVXMAP("B","Meningococcal C/Y-HIB PRP",148)=""
"RTN","C0IVMR",677,0)
 S CVXMAP("B","Hib (HbOC)",47)=""
"RTN","C0IVMR",678,0)
 S CVXMAP("B","Hib (PRP-D)",46)=""
"RTN","C0IVMR",679,0)
 S CVXMAP("B","Hib (PRP-OMP)",49)=""
"RTN","C0IVMR",680,0)
 S CVXMAP("B","Hib (PRP-T)",48)=""
"RTN","C0IVMR",681,0)
 S CVXMAP("B","HPV, quadrivalent",62)=""
"RTN","C0IVMR",682,0)
 S CVXMAP("B","HPV, bivalent",118)=""
"RTN","C0IVMR",683,0)
 S CVXMAP("B","influenza, seasonal, intradermal, preservative free",144)=""
"RTN","C0IVMR",684,0)
 S CVXMAP("B","Influenza, seasonal, injectable, preservative free",140)=""
"RTN","C0IVMR",685,0)
 S CVXMAP("B","Influenza, seasonal, injectable, preservative free",140)=""
"RTN","C0IVMR",686,0)
 S CVXMAP("B","Influenza, seasonal, injectable",141)=""
"RTN","C0IVMR",687,0)
 S CVXMAP("B","Influenza, seasonal, injectable",141)=""
"RTN","C0IVMR",688,0)
 S CVXMAP("B","influenza, whole",16)=""
"RTN","C0IVMR",689,0)
 S CVXMAP("B","influenza, live, intranasal",111)=""
"RTN","C0IVMR",690,0)
 S CVXMAP("B","Influenza, injectable, MDCK, preservative free",153)=""
"RTN","C0IVMR",691,0)
 S CVXMAP("B","Influenza, high dose seasonal",135)=""
"RTN","C0IVMR",692,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, all formulations",128)=""
"RTN","C0IVMR",693,0)
 S CVXMAP("B","Novel Influenza-H1N1-09, nasal",125)=""
"RTN","C0IVMR",694,0)
 S CVXMAP("B","Lyme disease",66)=""
"RTN","C0IVMR",695,0)
 S CVXMAP("B","Novel influenza-H1N1-09, preservative-free",126)=""
"RTN","C0IVMR",696,0)
 S CVXMAP("B","Novel influenza-H1N1-09",127)=""
"RTN","C0IVMR",697,0)
 S CVXMAP("B","pneumococcal conjugate PCV 7",100)=""
"RTN","C0IVMR",698,0)
 S CVXMAP("B","Pneumococcal conjugate PCV 13",133)=""
"RTN","C0IVMR",699,0)
 S CVXMAP("B","influenza, live, intranasal, quadrivalent",149)=""
"RTN","C0IVMR",700,0)
 S CVXMAP("B","influenza, recombinant, injectable, preservative free",155)=""
"RTN","C0IVMR",701,0)
 S CVXMAP("B","rabies, intramuscular injection",18)=""
"RTN","C0IVMR",702,0)
 S CVXMAP("B","rabies, intradermal injection",40)=""
"RTN","C0IVMR",703,0)
 S CVXMAP("B","rotavirus, pentavalent",116)=""
"RTN","C0IVMR",704,0)
 S CVXMAP("B","rotavirus, monovalent",119)=""
"RTN","C0IVMR",705,0)
 S CVXMAP("B","influenza, injectable, quadrivalent, preservative free",150)=""
"RTN","C0IVMR",706,0)
 S CVXMAP("B","influenza, injectable, quadrivalent, preservative free",150)=""
"RTN","C0IVMR",707,0)
 S CVXMAP("B","influenza, injectable, quadrivalent",158)=""
"RTN","C0IVMR",708,0)
 S CVXMAP("B","typhoid, oral",25)=""
"RTN","C0IVMR",709,0)
 S CVXMAP("B","typhoid, ViCPs",101)=""
"RTN","C0IVMR",710,0)
 S CVXMAP("B","typhoid, parenteral",41)=""
"RTN","C0IVMR",711,0)
 S CVXMAP("B","typhoid, parenteral, AKD (U.S. military)",53)=""
"RTN","C0IVMR",712,0)
 S CVXMAP("B","DTaP-IPV",130)=""
"RTN","C0IVMR",713,0)
 S CVXMAP("B","DTaP-Hib-IPV",120)=""
"RTN","C0IVMR",714,0)
 S CVXMAP("B","DTaP",20)=""
"RTN","C0IVMR",715,0)
 S CVXMAP("B","DTaP, 5 pertussis antigens",106)=""
"RTN","C0IVMR",716,0)
 S CVXMAP("B","DTP",01)=""
"RTN","C0IVMR",717,0)
 S CVXMAP("B","DT (pediatric)",28)=""
"RTN","C0IVMR",718,0)
 S CVXMAP("B","tetanus toxoid, adsorbed",35)=""
"RTN","C0IVMR",719,0)
 S CVXMAP("B","mumps",07)=""
"RTN","C0IVMR",720,0)
 S CVXMAP("B","measles",05)=""
"RTN","C0IVMR",721,0)
 S CVXMAP("B","rubella",06)=""
"RTN","C0IVMR",722,0)
 S CVXMAP("B","MMR",03)=""
"RTN","C0IVMR",723,0)
 S CVXMAP("B","M/R",04)=""
"RTN","C0IVMR",724,0)
 S CVXMAP("B","MMRV",94)=""
"RTN","C0IVMR",725,0)
 S CVXMAP("B","OPV",02)=""
"RTN","C0IVMR",726,0)
 S CVXMAP("B","IPV",10)=""
"RTN","C0IVMR",727,0)
 S CVXMAP("B","Td (adult) preservative free",113)=""
"RTN","C0IVMR",728,0)
 S CVXMAP("B","typhoid, unspecified formulation",91)=""
"RTN","C0IVMR",729,0)
 S CVXMAP("B","Tdap",115)=""
"RTN","C0IVMR",730,0)
 S CVXMAP("B","varicella",21)=""
"RTN","C0IVMR",731,0)
 S CVXMAP("B","yellow fever",37)=""
"RTN","C0IVMR",732,0)
 S CVXMAP("B","Td (adult), adsorbed",09)=""
"RTN","C0IVMR",733,0)
 S CVXMAP("B","DTP-Hib",22)=""
"RTN","C0IVMR",734,0)
 S CVXMAP("B","DTaP-Hib",50)=""
"RTN","C0IVMR",735,0)
 S CVXMAP("B","DTaP-Hep B-IPV",110)=""
"RTN","C0IVMR",736,0)
 S CVXMAP("B","influenza, unspecified formulation",88)=""
"RTN","C0IVMR",737,0)
 S CVXMAP("B","cholera",26)=""
"RTN","C0IVMR",738,0)
 S CVXMAP("B","rabies, unspecified formulation",90)=""
"RTN","C0IVMR",739,0)
 S CVXMAP("B","plague",23)=""
"RTN","C0IVMR",740,0)
 S CVXMAP("B","BCG",19)=""
"RTN","C0IVMR",741,0)
 S CVXMAP("B","Hep A, unspecified formulation",85)=""
"RTN","C0IVMR",742,0)
 S CVXMAP("B","Hep B, unspecified formulation",45)=""
"RTN","C0IVMR",743,0)
 S CVXMAP("B","pneumococcal polysaccharide PPV23",33)=""
"RTN","C0IVMR",744,0)
 S CVXMAP("B","meningococcal MPSV4",32)=""
"RTN","C0IVMR",745,0)
 S CVXMAP("B","Meningococcal MCV4O",136)=""
"RTN","C0IVMR",746,0)
 S CVXMAP("B","meningococcal MCV4P",114)=""
"RTN","C0IVMR",747,0)
 S CVXMAP("B","Japanese encephalitis SC",39)=""
"RTN","C0IVMR",748,0)
 S CVXMAP("B","zoster",121)=""
"RTN","C0IVMR",749,0)
 S CVXMAP("B","Hib, unspecified formulation",17)=""
"RTN","C0IVMR",750,0)
 S CVXMAP("B","Japanese Encephalitis IM",134)=""
"RTN","C0IVMR",751,0)
 S CVXMAP("B","Hep B, dialysis",44)=""
"RTN","C0IVMR",752,0)
 S CVXMAP("B","IG, unspecified formulation",14)=""
"RTN","C0IVMR",753,0)
 S CVXMAP("B","Hep B, adult",43)=""
"RTN","C0IVMR",754,0)
 S CVXMAP("B","Hep B, adolescent or pediatric",08)=""
"RTN","C0IVMR",755,0)
 S CVXMAP("B","Hep B, adolescent/high risk infant",42)=""
"RTN","C0IVMR",756,0)
 S CVXMAP("B","Hep B, adult",43)=""
"RTN","C0IVMR",757,0)
 S CVXMAP("B","Hep B, dialysis",44)=""
"RTN","C0IVMR",758,0)
 S CVXMAP("B","Hib-Hep B",51)=""
"RTN","C0IVMR",759,0)
 S CVXMAP("B","unknown",999)=""
"RTN","C0IVMR",760,0)
 Q
"RTN","C0IVMR",761,0)
 ;
"RTN","C0IVMR",762,0)
CPTIMAP
"RTN","C0IVMR",763,0)
 S CPTIMAP(90724)="INFLUENZA"
"RTN","C0IVMR",764,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-1"
"RTN","C0IVMR",765,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-2"
"RTN","C0IVMR",766,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-3"
"RTN","C0IVMR",767,0)
 S CPTIMAP(90744)="HEPB PED/ADOL-4"
"RTN","C0IVMR",768,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 1"
"RTN","C0IVMR",769,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 2"
"RTN","C0IVMR",770,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 3"
"RTN","C0IVMR",771,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 4"
"RTN","C0IVMR",772,0)
 S CPTIMAP(90701)="DIP.PERT.TET. (DPT) PED 5"
"RTN","C0IVMR",773,0)
 S CPTIMAP(90645)="HIB PED 1"
"RTN","C0IVMR",774,0)
 S CPTIMAP(90645)="HIB PED 2"
"RTN","C0IVMR",775,0)
 S CPTIMAP(90645)="HIB PED 3"
"RTN","C0IVMR",776,0)
 S CPTIMAP(90645)="HIB PED 4"
"RTN","C0IVMR",777,0)
 S CPTIMAP(90707)="MEASLESMUMPSRUBELLA PED #1"
"RTN","C0IVMR",778,0)
 S CPTIMAP(90707)="MEASLESMUMPSRUBELLA PED #2"
"RTN","C0IVMR",779,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #1"
"RTN","C0IVMR",780,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #2"
"RTN","C0IVMR",781,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #3"
"RTN","C0IVMR",782,0)
 S CPTIMAP(90713)="POLIOVIRUS PED #4"
"RTN","C0IVMR",783,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 1"
"RTN","C0IVMR",784,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 2"
"RTN","C0IVMR",785,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 3"
"RTN","C0IVMR",786,0)
 S CPTIMAP(90670)="PNEUMOCOCCAL PED 4"
"RTN","C0IVMR",787,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT)"
"RTN","C0IVMR",788,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 1"
"RTN","C0IVMR",789,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 2"
"RTN","C0IVMR",790,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 3"
"RTN","C0IVMR",791,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 4"
"RTN","C0IVMR",792,0)
 S CPTIMAP(90701)="DIPPERTTET (DPT) PED 5"
"RTN","C0IVMR",793,0)
 S CPTIMAP(90732)="PNEUMOVAX"
"RTN","C0IVMR",794,0)
 S CPTIMAP(90715)="TETANUS DIPTHERIA AND PERTUSSIS"
"RTN","C0IVMR",795,0)
 S CPTIMAP(90634)="HEP B PED/ADOL 3 DOSE"
"RTN","C0IVMR",796,0)
 S CPTIMAP(90633)="HEP A2 PEDS"
"RTN","C0IVMR",797,0)
 S CPTIMAP(90633)="HEP A1 PEDS"
"RTN","C0IVMR",798,0)
 S CPTIMAP(90680)="RV 1 PEDS"
"RTN","C0IVMR",799,0)
 S CPTIMAP(90680)="RV 2 PEDS"
"RTN","C0IVMR",800,0)
 S CPTIMAP(90680)="RV 3 PEDS"
"RTN","C0IVMR",801,0)
 S CPTIMAP(90647)="HiB1"
"RTN","C0IVMR",802,0)
 S CPTIMAP(90647)="HiB2"
"RTN","C0IVMR",803,0)
 S CPTIMAP(90647)="HiB3"
"RTN","C0IVMR",804,0)
 S CPTIMAP(90669)="PCV1 PEDS"
"RTN","C0IVMR",805,0)
 S CPTIMAP(90669)="PCV2 PEDS"
"RTN","C0IVMR",806,0)
 S CPTIMAP(90669)="PCV3 PEDS"
"RTN","C0IVMR",807,0)
 S CPTIMAP(90669)="PCV4 PEDS"
"RTN","C0IVMR",808,0)
 S CPTIMAP(90669)="PCV5 PEDS"
"RTN","C0IVMR",809,0)
 S CPTIMAP(90716)="VZV1 INFANT"
"RTN","C0IVMR",810,0)
 S CPTIMAP(90716)="VZV2 INFANT"
"RTN","C0IVMR",811,0)
 S CPTIMAP(90744)="HEP B1 INFANT"
"RTN","C0IVMR",812,0)
 S CPTIMAP(90744)="HEP B2 INFANT"
"RTN","C0IVMR",813,0)
 S CPTIMAP(90744)="HEP B3 INFANT"
"RTN","C0IVMR",814,0)
 S CPTIMAP(90744)="HEP B4 INFANT"
"RTN","C0IVMR",815,0)
 S CPTIMAP(90707)="MMR1"
"RTN","C0IVMR",816,0)
 S CPTIMAP(90713)="IPV1"
"RTN","C0IVMR",817,0)
 S CPTIMAP(90713)="IPV2"
"RTN","C0IVMR",818,0)
 S CPTIMAP(90713)="IPV3"
"RTN","C0IVMR",819,0)
 S CPTIMAP(90713)="IPV4"
"RTN","C0IVMR",820,0)
 S CPTIMAP(90700)="DTaP1"
"RTN","C0IVMR",821,0)
 S CPTIMAP(90700)="DTaP2"
"RTN","C0IVMR",822,0)
 S CPTIMAP(90700)="DTaP3"
"RTN","C0IVMR",823,0)
 S CPTIMAP(90700)="DTaP4"
"RTN","C0IVMR",824,0)
 S CPTIMAP(90700)="DTaP5"
"RTN","C0IVMR",825,0)
 S CPTIMAP(90634)="HEP A3 PEDS"
"RTN","C0IVMR",826,0)
 S CPTIMAP(90658)="FLU,3 YRS"
"RTN","C0IVMR",827,0)
 S CPTIMAP("B","INFLUENZA",90724)=""
"RTN","C0IVMR",828,0)
 S CPTIMAP("B","HEPB, PED/ADOL-1",90744)=""
"RTN","C0IVMR",829,0)
 S CPTIMAP("B","HEPB PED/ADOL-2",90744)=""
"RTN","C0IVMR",830,0)
 S CPTIMAP("B","HEPB PED/ADOL-3",90744)=""
"RTN","C0IVMR",831,0)
 S CPTIMAP("B","HEPB PED/ADOL-4",90744)=""
"RTN","C0IVMR",832,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 1",90701)=""
"RTN","C0IVMR",833,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 2",90701)=""
"RTN","C0IVMR",834,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 3",90701)=""
"RTN","C0IVMR",835,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 4",90701)=""
"RTN","C0IVMR",836,0)
 S CPTIMAP("B","DIP.,PERT.,TET. (DPT) PED 5",90701)=""
"RTN","C0IVMR",837,0)
 S CPTIMAP("B","HIB PED 1",90645)=""
"RTN","C0IVMR",838,0)
 S CPTIMAP("B","HIB PED 2",90645)=""
"RTN","C0IVMR",839,0)
 S CPTIMAP("B","HIB PED 3",90645)=""
"RTN","C0IVMR",840,0)
 S CPTIMAP("B","HIB PED 4",90645)=""
"RTN","C0IVMR",841,0)
 S CPTIMAP("B","MEASLES,MUMPS,RUBELLA PED #1",90707)=""
"RTN","C0IVMR",842,0)
 S CPTIMAP("B","MEASLES,MUMPS,RUBELLA PED #2",90707)=""
"RTN","C0IVMR",843,0)
 S CPTIMAP("B","POLIOVIRUS PED #1",90713)=""
"RTN","C0IVMR",844,0)
 S CPTIMAP("B","POLIOVIRUS PED #2",90713)=""
"RTN","C0IVMR",845,0)
 S CPTIMAP("B","POLIOVIRUS PED #3",90713)=""
"RTN","C0IVMR",846,0)
 S CPTIMAP("B","POLIOVIRUS PED #4",90713)=""
"RTN","C0IVMR",847,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 1",90670)=""
"RTN","C0IVMR",848,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 2",90670)=""
"RTN","C0IVMR",849,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 3",90670)=""
"RTN","C0IVMR",850,0)
 S CPTIMAP("B","PNEUMOCOCCAL PED 4",90670)=""
"RTN","C0IVMR",851,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT)",90701)=""
"RTN","C0IVMR",852,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 1",90701)=""
"RTN","C0IVMR",853,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 2",90701)=""
"RTN","C0IVMR",854,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 3",90701)=""
"RTN","C0IVMR",855,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 4",90701)=""
"RTN","C0IVMR",856,0)
 S CPTIMAP("B","DIP,PERT,TET (DPT) PED 5",90701)=""
"RTN","C0IVMR",857,0)
 S CPTIMAP("B","PNEUMOVAX",90732)=""
"RTN","C0IVMR",858,0)
 S CPTIMAP("B","TETANUS, DIPTHERIA AND PERTUSSIS",90715)=""
"RTN","C0IVMR",859,0)
 S CPTIMAP("B","HEP B PED/ADOL 3 DOSE",90634)=""
"RTN","C0IVMR",860,0)
 S CPTIMAP("B","HEP A2 PEDS",90633)=""
"RTN","C0IVMR",861,0)
 S CPTIMAP("B","HEP A1 PEDS",90633)=""
"RTN","C0IVMR",862,0)
 S CPTIMAP("B","RV 1 PEDS",90680)=""
"RTN","C0IVMR",863,0)
 S CPTIMAP("B","RV 2 PEDS",90680)=""
"RTN","C0IVMR",864,0)
 S CPTIMAP("B","RV 3 PEDS",90680)=""
"RTN","C0IVMR",865,0)
 S CPTIMAP("B","HiB1",90647)=""
"RTN","C0IVMR",866,0)
 S CPTIMAP("B","HiB2",90647)=""
"RTN","C0IVMR",867,0)
 S CPTIMAP("B","HiB3",90647)=""
"RTN","C0IVMR",868,0)
 S CPTIMAP("B","PCV1 PEDS",90669)=""
"RTN","C0IVMR",869,0)
 S CPTIMAP("B","PCV2 PEDS",90669)=""
"RTN","C0IVMR",870,0)
 S CPTIMAP("B","PCV3 PEDS",90669)=""
"RTN","C0IVMR",871,0)
 S CPTIMAP("B","PCV4 PEDS",90669)=""
"RTN","C0IVMR",872,0)
 S CPTIMAP("B","PCV5 PEDS",90669)=""
"RTN","C0IVMR",873,0)
 S CPTIMAP("B","VZV1 INFANT",90716)=""
"RTN","C0IVMR",874,0)
 S CPTIMAP("B","VZV2 INFANT",90716)=""
"RTN","C0IVMR",875,0)
 S CPTIMAP("B","HEP B1 INFANT",90744)=""
"RTN","C0IVMR",876,0)
 S CPTIMAP("B","HEP B2 INFANT",90744)=""
"RTN","C0IVMR",877,0)
 S CPTIMAP("B","HEP B3 INFANT",90744)=""
"RTN","C0IVMR",878,0)
 S CPTIMAP("B","HEP B4 INFANT",90744)=""
"RTN","C0IVMR",879,0)
 S CPTIMAP("B","MMR1",90707)=""
"RTN","C0IVMR",880,0)
 S CPTIMAP("B","IPV1",90713)=""
"RTN","C0IVMR",881,0)
 S CPTIMAP("B","IPV2",90713)=""
"RTN","C0IVMR",882,0)
 S CPTIMAP("B","IPV3",90713)=""
"RTN","C0IVMR",883,0)
 S CPTIMAP("B","IPV4",90713)=""
"RTN","C0IVMR",884,0)
 S CPTIMAP("B","DTaP1",90700)=""
"RTN","C0IVMR",885,0)
 S CPTIMAP("B","DTaP2",90700)=""
"RTN","C0IVMR",886,0)
 S CPTIMAP("B","DTaP3",90700)=""
"RTN","C0IVMR",887,0)
 S CPTIMAP("B","DTaP4",90700)=""
"RTN","C0IVMR",888,0)
 S CPTIMAP("B","DTaP5",90700)=""
"RTN","C0IVMR",889,0)
 S CPTIMAP("B","HEP A3 PEDS",90634)=""
"RTN","C0IVMR",890,0)
 S CPTIMAP("B","FLU,3 YRS",90658)=""
"RTN","C0IVMR",891,0)
 Q
"RTN","C0IVMR",892,0)
 ;
"RTN","C0IVMR",893,0)
CVXIMAP 
"RTN","C0IVMR",894,0)
 S CVXIMAP(75)="SMALLPOX"
"RTN","C0IVMR",895,0)
 S CVXIMAP(09)="TETANUS DIPTHERIA (TD-ADULT)"
"RTN","C0IVMR",896,0)
 S CVXIMAP(01)="DIP.,PERT.,TET. (DPT)"
"RTN","C0IVMR",897,0)
 S CVXIMAP(35)="TETANUS TOXOID"
"RTN","C0IVMR",898,0)
 S CVXIMAP(91)="TYPHOID"
"RTN","C0IVMR",899,0)
 S CVXIMAP(02)="ORAL POLIOVIRUS"
"RTN","C0IVMR",900,0)
 S CVXIMAP(43)="SWINE FLU BIVAL"
"RTN","C0IVMR",901,0)
 S CVXIMAP(45)="HEPATITIS B"
"RTN","C0IVMR",902,0)
 S CVXIMAP(05)="MEASLES"
"RTN","C0IVMR",903,0)
 S CVXIMAP(88)="INFLUENZA"
"RTN","C0IVMR",904,0)
 S CVXIMAP(26)="CHOLERA"
"RTN","C0IVMR",905,0)
 S CVXIMAP(06)="RUBELLA"
"RTN","C0IVMR",906,0)
 S CVXIMAP(07)="MUMPS"
"RTN","C0IVMR",907,0)
 S CVXIMAP(19)="BCG"
"RTN","C0IVMR",908,0)
 S CVXIMAP(03)="MEASLES,MUMPS,RUBELLA (MMR)"
"RTN","C0IVMR",909,0)
 S CVXIMAP(04)="MEASLES,RUBELLA (MR)"
"RTN","C0IVMR",910,0)
 S CVXIMAP(33)="PNEUMOCOCCAL"
"RTN","C0IVMR",911,0)
 S CVXIMAP(37)="YELLOW FEVER"
"RTN","C0IVMR",912,0)
 S CVXIMAP(131)="TYPHUS"
"RTN","C0IVMR",913,0)
 S CVXIMAP(90)="RABIES"
"RTN","C0IVMR",914,0)
 S CVXIMAP(28)="DIPTHERIA-TETANUS (DT-PEDS)"
"RTN","C0IVMR",915,0)
 S CVXIMAP(17)="INFLUENZA B"
"RTN","C0IVMR",916,0)
 S CVXIMAP(85)="HEPATITIS A"
"RTN","C0IVMR",917,0)
 S CVXIMAP(32)="MENINGOCOCCAL"
"RTN","C0IVMR",918,0)
 S CVXIMAP(39)="ENCEPHALITIS"
"RTN","C0IVMR",919,0)
 S CVXIMAP(21)="CHICKENPOX"
"RTN","C0IVMR",920,0)
 S CVXIMAP(106)="DIP-TET-a/PERT"
"RTN","C0IVMR",921,0)
 S CVXIMAP(38)="RUBELLA, MUMPS"
"RTN","C0IVMR",922,0)
 S CVXIMAP(22)="DTB/HIB"
"RTN","C0IVMR",923,0)
 S CVXIMAP(94)="MEA-MUMPS-RUB-VARCELLA"
"RTN","C0IVMR",924,0)
 S CVXIMAP(23)="PLAGUE"
"RTN","C0IVMR",925,0)
 S CVXIMAP(14)="GAMMA GLOBULIN"
"RTN","C0IVMR",926,0)
 S CVXIMAP(54)="ADENOVIRUS,TYPE 4"
"RTN","C0IVMR",927,0)
 S CVXIMAP(55)="ADENOVIRUS,TYPE 7"
"RTN","C0IVMR",928,0)
 S CVXIMAP(24)="ANTHRAX,SC"
"RTN","C0IVMR",929,0)
 S CVXIMAP(19)="BCG,PERCUT"
"RTN","C0IVMR",930,0)
 S CVXIMAP(26)="CHOLERA, ORAL"
"RTN","C0IVMR",931,0)
 S CVXIMAP(52)="HEPA ADULT"
"RTN","C0IVMR",932,0)
 S CVXIMAP(83)="HEPA,PED/ADOL-2"
"RTN","C0IVMR",933,0)
 S CVXIMAP(84)="HEPA,PED/ADOL-3 DOSE"
"RTN","C0IVMR",934,0)
 S CVXIMAP(104)="HEPA/HEPB ADULT"
"RTN","C0IVMR",935,0)
 S CVXIMAP(47)="HIB,HBOC"
"RTN","C0IVMR",936,0)
 S CVXIMAP(46)="HIB,PRP-D"
"RTN","C0IVMR",937,0)
 S CVXIMAP(49)="HIB,PRP-OMP"
"RTN","C0IVMR",938,0)
 S CVXIMAP(48)="HIB,PRP-T"
"RTN","C0IVMR",939,0)
 S CVXIMAP(141)="FLU,3 YRS"
"RTN","C0IVMR",940,0)
 S CVXIMAP(16)="FLU,WHOLE"
"RTN","C0IVMR",941,0)
 S CVXIMAP(111)="FLU,NASAL"
"RTN","C0IVMR",942,0)
 S CVXIMAP(66)="LYME DISEASE"
"RTN","C0IVMR",943,0)
 S CVXIMAP(100)="PNEUMOCOCCAL,PED"
"RTN","C0IVMR",944,0)
 S CVXIMAP(18)="RABIES,IM"
"RTN","C0IVMR",945,0)
 S CVXIMAP(40)="RABIES,ID"
"RTN","C0IVMR",946,0)
 S CVXIMAP(116)="ROTOVIRUS,ORAL"
"RTN","C0IVMR",947,0)
 S CVXIMAP(25)="TYPHOID,ORAL"
"RTN","C0IVMR",948,0)
 S CVXIMAP(101)="TYPHOID"
"RTN","C0IVMR",949,0)
 S CVXIMAP(41)="TYPHOID,H-P,SC/ID"
"RTN","C0IVMR",950,0)
 S CVXIMAP(53)="TYPHOID,AKD,SC"
"RTN","C0IVMR",951,0)
 S CVXIMAP(44)="HEPB, ILL PAT"
"RTN","C0IVMR",952,0)
 S CVXIMAP(51)="HEPB/HIB"
"RTN","C0IVMR",953,0)
 S CVXIMAP(08)="HEPB, PED/ADOL-1"
"RTN","C0IVMR",954,0)
 S CVXIMAP(08)="HEPB PED/ADOL-2"
"RTN","C0IVMR",955,0)
 S CVXIMAP(08)="HEPB PED/ADOL-3"
"RTN","C0IVMR",956,0)
 S CVXIMAP(08)="HEPB PED/ADOL-4"
"RTN","C0IVMR",957,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 1"
"RTN","C0IVMR",958,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 2"
"RTN","C0IVMR",959,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 3"
"RTN","C0IVMR",960,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 4"
"RTN","C0IVMR",961,0)
 S CVXIMAP(20)="DIP.,PERT.,TET. (DPT) PED 5"
"RTN","C0IVMR",962,0)
 S CVXIMAP(47)="HIB PED 1"
"RTN","C0IVMR",963,0)
 S CVXIMAP(47)="HIB PED 2"
"RTN","C0IVMR",964,0)
 S CVXIMAP(47)="HIB PED 3"
"RTN","C0IVMR",965,0)
 S CVXIMAP(47)="HIB PED 4"
"RTN","C0IVMR",966,0)
 S CVXIMAP(03)="MEASLES,MUMPS,RUBELLA PED #1"
"RTN","C0IVMR",967,0)
 S CVXIMAP(03)="MEASLES,MUMPS,RUBELLA PED #2"
"RTN","C0IVMR",968,0)
 S CVXIMAP(10)="POLIOVIRUS PED #1"
"RTN","C0IVMR",969,0)
 S CVXIMAP(10)="POLIOVIRUS PED #2"
"RTN","C0IVMR",970,0)
 S CVXIMAP(10)="POLIOVIRUS PED #3"
"RTN","C0IVMR",971,0)
 S CVXIMAP(10)="POLIOVIRUS PED #4"
"RTN","C0IVMR",972,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 1"
"RTN","C0IVMR",973,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 2"
"RTN","C0IVMR",974,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 3"
"RTN","C0IVMR",975,0)
 S CVXIMAP(100)="PNEUMOCOCCAL PED 4"
"RTN","C0IVMR",976,0)
 S CVXIMAP(01)="DIP,PERT,TET (DPT)"
"RTN","C0IVMR",977,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 1"
"RTN","C0IVMR",978,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 2"
"RTN","C0IVMR",979,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 3"
"RTN","C0IVMR",980,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 4"
"RTN","C0IVMR",981,0)
 S CVXIMAP(106)="DIP,PERT,TET (DPT) PED 5"
"RTN","C0IVMR",982,0)
 S CVXIMAP(33)="PNEUMOVAX"
"RTN","C0IVMR",983,0)
 S CVXIMAP(115)="TETANUS, DIPTHERIA AND PERTUSSIS"
"RTN","C0IVMR",984,0)
 S CVXIMAP(08)="HEP B PED/ADOL 3 DOSE"
"RTN","C0IVMR",985,0)
 S CVXIMAP(106)="DTaP1"
"RTN","C0IVMR",986,0)
 S CVXIMAP(106)="DTaP2"
"RTN","C0IVMR",987,0)
 S CVXIMAP(106)="DTaP3"
"RTN","C0IVMR",988,0)
 S CVXIMAP(106)="DTaP4"
"RTN","C0IVMR",989,0)
 S CVXIMAP(106)="DTaP5"
"RTN","C0IVMR",990,0)
 S CVXIMAP(83)="HEP A1 PEDS"
"RTN","C0IVMR",991,0)
 S CVXIMAP(83)="HEP A2 PEDS"
"RTN","C0IVMR",992,0)
 S CVXIMAP(84)="HEP A3 PEDS"
"RTN","C0IVMR",993,0)
 S CVXIMAP(42)="HEP B1 INFANT"
"RTN","C0IVMR",994,0)
 S CVXIMAP(42)="HEP B2 INFANT"
"RTN","C0IVMR",995,0)
 S CVXIMAP(42)="HEP B3 INFANT"
"RTN","C0IVMR",996,0)
 S CVXIMAP(42)="HEP B4 INFANT"
"RTN","C0IVMR",997,0)
 S CVXIMAP(49)="HiB1"
"RTN","C0IVMR",998,0)
 S CVXIMAP(49)="HiB2"
"RTN","C0IVMR",999,0)
 S CVXIMAP(49)="HiB3"
"RTN","C0IVMR",1000,0)
 S CVXIMAP(10)="IPV1"
"RTN","C0IVMR",1001,0)
 S CVXIMAP(10)="IPV2"
"RTN","C0IVMR",1002,0)
 S CVXIMAP(10)="IPV3"
"RTN","C0IVMR",1003,0)
 S CVXIMAP(10)="IPV4"
"RTN","C0IVMR",1004,0)
 S CVXIMAP(03)="MMR1"
"RTN","C0IVMR",1005,0)
 S CVXIMAP(133)="PCV1 PEDS"
"RTN","C0IVMR",1006,0)
 S CVXIMAP(133)="PCV2 PEDS"
"RTN","C0IVMR",1007,0)
 S CVXIMAP(133)="PCV3 PEDS"
"RTN","C0IVMR",1008,0)
 S CVXIMAP(133)="PCV4 PEDS"
"RTN","C0IVMR",1009,0)
 S CVXIMAP(133)="PCV5 PEDS"
"RTN","C0IVMR",1010,0)
 S CVXIMAP(116)="RV 1 PEDS"
"RTN","C0IVMR",1011,0)
 S CVXIMAP(116)="RV 2 PEDS"
"RTN","C0IVMR",1012,0)
 S CVXIMAP(116)="RV 3 PEDS"
"RTN","C0IVMR",1013,0)
 S CVXIMAP(116)="RV 4 PEDS"
"RTN","C0IVMR",1014,0)
 S CVXIMAP(21)="VZV1 INFANT"
"RTN","C0IVMR",1015,0)
 S CVXIMAP(21)="VZV2 INFANT"
"RTN","C0IVMR",1016,0)
 S CVXIMAP(141)="FLU,3 YRS"
"RTN","C0IVMR",1017,0)
 S CVXIMAP("B","SMALLPOX",75)=""
"RTN","C0IVMR",1018,0)
 S CVXIMAP("B","TETANUS DIPTHERIA (TD-ADULT)",09)=""
"RTN","C0IVMR",1019,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT)",01)=""
"RTN","C0IVMR",1020,0)
 S CVXIMAP("B","TETANUS TOXOID",35)=""
"RTN","C0IVMR",1021,0)
 S CVXIMAP("B","TYPHOID",91)=""
"RTN","C0IVMR",1022,0)
 S CVXIMAP("B","ORAL POLIOVIRUS",02)=""
"RTN","C0IVMR",1023,0)
 S CVXIMAP("B","SWINE FLU BIVAL",43)=""
"RTN","C0IVMR",1024,0)
 S CVXIMAP("B","HEPATITIS B",45)=""
"RTN","C0IVMR",1025,0)
 S CVXIMAP("B","MEASLES",05)=""
"RTN","C0IVMR",1026,0)
 S CVXIMAP("B","INFLUENZA",88)=""
"RTN","C0IVMR",1027,0)
 S CVXIMAP("B","CHOLERA",26)=""
"RTN","C0IVMR",1028,0)
 S CVXIMAP("B","RUBELLA",06)=""
"RTN","C0IVMR",1029,0)
 S CVXIMAP("B","MUMPS",07)=""
"RTN","C0IVMR",1030,0)
 S CVXIMAP("B","BCG",19)=""
"RTN","C0IVMR",1031,0)
 S CVXIMAP("B","MEASLES,MUMPS,RUBELLA (MMR)",03)=""
"RTN","C0IVMR",1032,0)
 S CVXIMAP("B","MEASLES,RUBELLA (MR)",04)=""
"RTN","C0IVMR",1033,0)
 S CVXIMAP("B","PNEUMOCOCCAL",33)=""
"RTN","C0IVMR",1034,0)
 S CVXIMAP("B","YELLOW FEVER",37)=""
"RTN","C0IVMR",1035,0)
 S CVXIMAP("B","TYPHUS",131)=""
"RTN","C0IVMR",1036,0)
 S CVXIMAP("B","RABIES",90)=""
"RTN","C0IVMR",1037,0)
 S CVXIMAP("B","DIPTHERIA-TETANUS (DT-PEDS)",28)=""
"RTN","C0IVMR",1038,0)
 S CVXIMAP("B","INFLUENZA B",17)=""
"RTN","C0IVMR",1039,0)
 S CVXIMAP("B","HEPATITIS A",85)=""
"RTN","C0IVMR",1040,0)
 S CVXIMAP("B","MENINGOCOCCAL",32)=""
"RTN","C0IVMR",1041,0)
 S CVXIMAP("B","ENCEPHALITIS",39)=""
"RTN","C0IVMR",1042,0)
 S CVXIMAP("B","CHICKENPOX",21)=""
"RTN","C0IVMR",1043,0)
 S CVXIMAP("B","DIP-TET-a/PERT",106)=""
"RTN","C0IVMR",1044,0)
 S CVXIMAP("B","RUBELLA, MUMPS",38)=""
"RTN","C0IVMR",1045,0)
 S CVXIMAP("B","DTB/HIB",22)=""
"RTN","C0IVMR",1046,0)
 S CVXIMAP("B","MEA-MUMPS-RUB-VARCELLA",94)=""
"RTN","C0IVMR",1047,0)
 S CVXIMAP("B","PLAGUE",23)=""
"RTN","C0IVMR",1048,0)
 S CVXIMAP("B","GAMMA GLOBULIN",14)=""
"RTN","C0IVMR",1049,0)
 S CVXIMAP("B","ADENOVIRUS,TYPE 4",54)=""
"RTN","C0IVMR",1050,0)
 S CVXIMAP("B","ADENOVIRUS,TYPE 7",55)=""
"RTN","C0IVMR",1051,0)
 S CVXIMAP("B","ANTHRAX,SC",24)=""
"RTN","C0IVMR",1052,0)
 S CVXIMAP("B","BCG,PERCUT",19)=""
"RTN","C0IVMR",1053,0)
 S CVXIMAP("B","CHOLERA, ORAL",26)=""
"RTN","C0IVMR",1054,0)
 S CVXIMAP("B","HEPA ADULT",52)=""
"RTN","C0IVMR",1055,0)
 S CVXIMAP("B","HEPA,PED/ADOL-2",83)=""
"RTN","C0IVMR",1056,0)
 S CVXIMAP("B","HEPA,PED/ADOL-3 DOSE",84)=""
"RTN","C0IVMR",1057,0)
 S CVXIMAP("B","HEPA/HEPB ADULT",104)=""
"RTN","C0IVMR",1058,0)
 S CVXIMAP("B","HIB,HBOC",47)=""
"RTN","C0IVMR",1059,0)
 S CVXIMAP("B","HIB,PRP-D",46)=""
"RTN","C0IVMR",1060,0)
 S CVXIMAP("B","HIB,PRP-OMP",49)=""
"RTN","C0IVMR",1061,0)
 S CVXIMAP("B","HIB,PRP-T",48)=""
"RTN","C0IVMR",1062,0)
 S CVXIMAP("B","FLU,3 YRS",141)=""
"RTN","C0IVMR",1063,0)
 S CVXIMAP("B","FLU,WHOLE",16)=""
"RTN","C0IVMR",1064,0)
 S CVXIMAP("B","FLU,NASAL",111)=""
"RTN","C0IVMR",1065,0)
 S CVXIMAP("B","LYME DISEASE",66)=""
"RTN","C0IVMR",1066,0)
 S CVXIMAP("B","PNEUMOCOCCAL,PED",100)=""
"RTN","C0IVMR",1067,0)
 S CVXIMAP("B","RABIES,IM",18)=""
"RTN","C0IVMR",1068,0)
 S CVXIMAP("B","RABIES,ID",40)=""
"RTN","C0IVMR",1069,0)
 S CVXIMAP("B","ROTOVIRUS,ORAL",116)=""
"RTN","C0IVMR",1070,0)
 S CVXIMAP("B","TYPHOID,ORAL",25)=""
"RTN","C0IVMR",1071,0)
 S CVXIMAP("B","TYPHOID",101)=""
"RTN","C0IVMR",1072,0)
 S CVXIMAP("B","TYPHOID,H-P,SC/ID",41)=""
"RTN","C0IVMR",1073,0)
 S CVXIMAP("B","TYPHOID,AKD,SC",53)=""
"RTN","C0IVMR",1074,0)
 S CVXIMAP("B","HEPB, ILL PAT",44)=""
"RTN","C0IVMR",1075,0)
 S CVXIMAP("B","HEPB/HIB",51)=""
"RTN","C0IVMR",1076,0)
 S CVXIMAP("B","HEPB, PED/ADOL-1",08)=""
"RTN","C0IVMR",1077,0)
 S CVXIMAP("B","HEPB PED/ADOL-2",08)=""
"RTN","C0IVMR",1078,0)
 S CVXIMAP("B","HEPB PED/ADOL-3",08)=""
"RTN","C0IVMR",1079,0)
 S CVXIMAP("B","HEPB PED/ADOL-4",08)=""
"RTN","C0IVMR",1080,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 1",20)=""
"RTN","C0IVMR",1081,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 2",20)=""
"RTN","C0IVMR",1082,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 3",20)=""
"RTN","C0IVMR",1083,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 4",20)=""
"RTN","C0IVMR",1084,0)
 S CVXIMAP("B","DIP.,PERT.,TET. (DPT) PED 5",20)=""
"RTN","C0IVMR",1085,0)
 S CVXIMAP("B","HIB PED 1",47)=""
"RTN","C0IVMR",1086,0)
 S CVXIMAP("B","HIB PED 2",47)=""
"RTN","C0IVMR",1087,0)
 S CVXIMAP("B","HIB PED 3",47)=""
"RTN","C0IVMR",1088,0)
 S CVXIMAP("B","HIB PED 4",47)=""
"RTN","C0IVMR",1089,0)
 S CVXIMAP("B","MEASLES,MUMPS,RUBELLA PED #1",03)=""
"RTN","C0IVMR",1090,0)
 S CVXIMAP("B","MEASLES,MUMPS,RUBELLA PED #2",03)=""
"RTN","C0IVMR",1091,0)
 S CVXIMAP("B","POLIOVIRUS PED #1",10)=""
"RTN","C0IVMR",1092,0)
 S CVXIMAP("B","POLIOVIRUS PED #2",10)=""
"RTN","C0IVMR",1093,0)
 S CVXIMAP("B","POLIOVIRUS PED #3",10)=""
"RTN","C0IVMR",1094,0)
 S CVXIMAP("B","POLIOVIRUS PED #4",10)=""
"RTN","C0IVMR",1095,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 1",100)=""
"RTN","C0IVMR",1096,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 2",100)=""
"RTN","C0IVMR",1097,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 3",100)=""
"RTN","C0IVMR",1098,0)
 S CVXIMAP("B","PNEUMOCOCCAL PED 4",100)=""
"RTN","C0IVMR",1099,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT)",01)=""
"RTN","C0IVMR",1100,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 1",106)=""
"RTN","C0IVMR",1101,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 2",106)=""
"RTN","C0IVMR",1102,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 3",106)=""
"RTN","C0IVMR",1103,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 4",106)=""
"RTN","C0IVMR",1104,0)
 S CVXIMAP("B","DIP,PERT,TET (DPT) PED 5",106)=""
"RTN","C0IVMR",1105,0)
 S CVXIMAP("B","PNEUMOVAX",33)=""
"RTN","C0IVMR",1106,0)
 S CVXIMAP("B","TETANUS, DIPTHERIA AND PERTUSSIS",115)=""
"RTN","C0IVMR",1107,0)
 S CVXIMAP("B","HEP B PED/ADOL 3 DOSE",08)=""
"RTN","C0IVMR",1108,0)
 S CVXIMAP("B","DTaP1",106)=""
"RTN","C0IVMR",1109,0)
 S CVXIMAP("B","DTaP2",106)=""
"RTN","C0IVMR",1110,0)
 S CVXIMAP("B","DTaP3",106)=""
"RTN","C0IVMR",1111,0)
 S CVXIMAP("B","DTaP4",106)=""
"RTN","C0IVMR",1112,0)
 S CVXIMAP("B","DTaP5",106)=""
"RTN","C0IVMR",1113,0)
 S CVXIMAP("B","HEP A1 PEDS",83)=""
"RTN","C0IVMR",1114,0)
 S CVXIMAP("B","HEP A2 PEDS",83)=""
"RTN","C0IVMR",1115,0)
 S CVXIMAP("B","HEP A3 PEDS",84)=""
"RTN","C0IVMR",1116,0)
 S CVXIMAP("B","HEP B1 INFANT",42)=""
"RTN","C0IVMR",1117,0)
 S CVXIMAP("B","HEP B2 INFANT",42)=""
"RTN","C0IVMR",1118,0)
 S CVXIMAP("B","HEP B3 INFANT",42)=""
"RTN","C0IVMR",1119,0)
 S CVXIMAP("B","HEP B4 INFANT",42)=""
"RTN","C0IVMR",1120,0)
 S CVXIMAP("B","HiB1",49)=""
"RTN","C0IVMR",1121,0)
 S CVXIMAP("B","HiB2",49)=""
"RTN","C0IVMR",1122,0)
 S CVXIMAP("B","HiB3",49)=""
"RTN","C0IVMR",1123,0)
 S CVXIMAP("B","IPV1",10)=""
"RTN","C0IVMR",1124,0)
 S CVXIMAP("B","IPV2",10)=""
"RTN","C0IVMR",1125,0)
 S CVXIMAP("B","IPV3",10)=""
"RTN","C0IVMR",1126,0)
 S CVXIMAP("B","IPV4",10)=""
"RTN","C0IVMR",1127,0)
 S CVXIMAP("B","MMR1",03)=""
"RTN","C0IVMR",1128,0)
 S CVXIMAP("B","PCV1 PEDS",133)=""
"RTN","C0IVMR",1129,0)
 S CVXIMAP("B","PCV2 PEDS",133)=""
"RTN","C0IVMR",1130,0)
 S CVXIMAP("B","PCV3 PEDS",133)=""
"RTN","C0IVMR",1131,0)
 S CVXIMAP("B","PCV4 PEDS",133)=""
"RTN","C0IVMR",1132,0)
 S CVXIMAP("B","PCV5 PEDS",133)=""
"RTN","C0IVMR",1133,0)
 S CVXIMAP("B","RV 1 PEDS",116)=""
"RTN","C0IVMR",1134,0)
 S CVXIMAP("B","RV 2 PEDS",116)=""
"RTN","C0IVMR",1135,0)
 S CVXIMAP("B","RV 3 PEDS",116)=""
"RTN","C0IVMR",1136,0)
 S CVXIMAP("B","RV 4 PEDS",116)=""
"RTN","C0IVMR",1137,0)
 S CVXIMAP("B","VZV1 INFANT",21)=""
"RTN","C0IVMR",1138,0)
 S CVXIMAP("B","VZV2 INFANT",21)=""
"RTN","C0IVMR",1139,0)
 S CVXIMAP("B","FLU,3 YRS",141)=""
"RTN","C0IVMR",1140,0)
 Q
"RTN","C0IVMR",1141,0)
 ;
"RTN","C0IVMR",1142,0)
ALLMAP ; 
"RTN","C0IVMR",1143,0)
 ; create a single map out the above maps
"RTN","C0IVMR",1144,0)
 N CVX,MAP
"RTN","C0IVMR",1145,0)
 S CVX=""
"RTN","C0IVMR",1146,0)
 D CPTMAP
"RTN","C0IVMR",1147,0)
 D CVXMAP
"RTN","C0IVMR",1148,0)
 D CPTIMAP
"RTN","C0IVMR",1149,0)
 D CVXIMAP
"RTN","C0IVMR",1150,0)
 S MAP=$NA(^C0CodeMap("immunizations"))
"RTN","C0IVMR",1151,0)
 K @MAP
"RTN","C0IVMR",1152,0)
 F  S CVX=$O(CVXMAP(CVX)) Q:+CVX=0  D  ;
"RTN","C0IVMR",1153,0)
 . S @MAP@(CVX,"preferredName")=CVXMAP(CVX)
"RTN","C0IVMR",1154,0)
 . S @MAP@(CVX,"CVXcode")=CVX
"RTN","C0IVMR",1155,0)
 . S @MAP@("B",CVXMAP(CVX),CVX)=""
"RTN","C0IVMR",1156,0)
 . D:$G(CVXIMAP(CVX))'="" 
"RTN","C0IVMR",1157,0)
 . . S @MAP@(CVX,"altName",1)=CVXIMAP(CVX)
"RTN","C0IVMR",1158,0)
 . . S @MAP@("B",CVXIMAP(CVX),CVX)=""
"RTN","C0IVMR",1159,0)
 N CPT S CPT=""
"RTN","C0IVMR",1160,0)
 F  S CPT=$O(CPTMAP(CPT)) Q:+CPT=0  D  ;
"RTN","C0IVMR",1161,0)
 . S CVX=CPTMAP(CPT)
"RTN","C0IVMR",1162,0)
 . S @MAP@(CVX,"CPT")=CPT
"RTN","C0IVMR",1163,0)
 . S @MAP@("CPT",CPT,CVX)=""
"RTN","C0IVMR",1164,0)
 ; now do all the extra names in the B index of CVXIMAP
"RTN","C0IVMR",1165,0)
 N ZJ S ZJ=""
"RTN","C0IVMR",1166,0)
 F  S ZJ=$O(CVXIMAP("B",ZJ)) Q:ZJ=""  D  ;
"RTN","C0IVMR",1167,0)
 . S CVX=""
"RTN","C0IVMR",1168,0)
 . F  S CVX=$O(CVXIMAP("B",ZJ,CVX)) Q:CVX=""  D  ;
"RTN","C0IVMR",1169,0)
 . . I $D(@MAP@("B",ZJ)) Q  ; already in the map
"RTN","C0IVMR",1170,0)
 . . S @MAP@(CVX,"altName",$O(@MAP@(CVX,"altName",""),-1)+1)=ZJ
"RTN","C0IVMR",1171,0)
 . . S @MAP@("B",ZJ,CVX)=""
"RTN","C0IVMR",1172,0)
 M G=@MAP
"RTN","C0IVMR",1173,0)
 ZWR G
"RTN","C0IVMR",1174,0)
 Q
"RTN","C0IVMR",1175,0)
 ;
"VER")
8.0^22.0
**END**
**END**
